<html><body>
<br><b>Harvesting...</b>
<pre>
</pre><hr><b>File format conversions...</b>
<pre>
Unzipping
Archive:  WoRMS_Bryozoa.zip
  inflating: AcceptedSpecies.txt     
  inflating: AcceptedInfraSpecificTaxa.txt  
  inflating: Synonyms.txt            
  inflating: CommonNames.txt         
  inflating: Distribution.txt        
  inflating: References.txt          
  inflating: NameReferencesLinks.txt  
  inflating: SourceDatabase.txt      
Skipping format conversion
</pre><hr><b>Creating buffer database, performing structural transformations...</b>
<pre>
<pre>
Initiating buffer creation - this may take a while depending on size of the dataset...

Creating buffer database Buffer_Bryozoa in schema as provided by Bryozoa
--------------
DROP DATABASE IF EXISTS Buffer_Bryozoa
--------------

--------------
CREATE DATABASE IF NOT EXISTS Buffer_Bryozoa
--------------

--------------
CREATE TABLE `AcceptedInfraSpecificTaxa` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`ParentSpeciesID` varchar(50) default NULL,
`InfraSpeciesEpithet` varchar(50) default NULL,
`InfraSpecificAuthorString` varchar(50) default NULL,
`InfraSpecificMarker` varchar(10) default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`InfraSpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI`  varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `AcceptedSpecies` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`Kingdom` varchar(50) default NULL,
`Phylum` varchar(50) default NULL,
`Class` varchar(50) default NULL,
`Order` varchar(50) default NULL,
`Superfamily` varchar(50) default NULL,
`Family` varchar(50) default NULL,
`Genus` varchar(50) default NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) default NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`SpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `CommonNames` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`CommonName` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Transliteration` varchar(255) default NULL,
`Language` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Country`  varchar(255) default NULL,
`Area`  varchar(255) default NULL,
`ReferenceID` varchar(50) default NULL,
PRIMARY KEY (`record_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `Distribution` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Distribution` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`StandardInUse` varchar(50) default NULL,
`DistributionStatus` varchar(50) default NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `References` (
`ReferenceID` varchar(50) PRIMARY KEY,
`Authors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Year` varchar(255) default NULL,
`Title` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Details` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `NameReferencesLinks` (
`ID` integer(10) PRIMARY KEY,
`ReferenceType` varchar(50) default NULL,
`ReferenceID` varchar(50) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `SourceDatabase` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`DatabaseFullName` varchar(255) NOT NULL,
`DatabaseShortName` varchar(50) NOT NULL,
`DatabaseVersion` varchar(50) NOT NULL,
`ReleaseDate` varchar(50) NOT NULL,
`AuthorsEditors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`TaxonomicCoverage` varchar(255) NOT NULL,
`GroupNameInEnglish` varchar(255) NOT NULL,
`Abstract` text  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Organisation` varchar(255) NOT NULL,
`HomeURL` varchar(255) default NULL,
`Coverage` varchar(50) default NULL,
`Completeness` integer(3) default NULL,
`Confidence` integer(1) default NULL,
`LogoFileName`  varchar(255) default NULL,
`ContactPerson` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `Synonyms` (
`ID` integer(10) PRIMARY KEY,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Genus` varchar(50) NOT NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) NOT NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`InfraSpecies` varchar(50) default NULL,
`InfraSpecificMarker` varchar(50) default NULL,
`InfraSpecificAuthorString`  varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`GSDNameGUI` varchar(255) default NULL 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedInfraSpecificTaxa.txt' INTO TABLE `AcceptedInfraSpecificTaxa` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES 
(`AcceptedTaxonID`, `ParentSpeciesID`, `InfraSpeciesEpithet`, `InfraSpecificAuthorString`,  `InfraSpecificMarker`, `GSDNameStatus`,  `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `InfraSpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedSpecies.txt' INTO TABLE `AcceptedSpecies` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Kingdom`, `Phylum`, `Class`, `Order`, `Superfamily`, `Family`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `SpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'CommonNames.txt' INTO TABLE `CommonNames` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `CommonName`, `Transliteration`, `Country`, `Area`, `Language`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Distribution.txt' INTO TABLE `Distribution` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Distribution`, `StandardInUse`, `DistributionStatus`)
--------------

--------------
LOAD DATA LOCAL INFILE 'NameReferencesLinks.txt' INTO TABLE NameReferencesLinks CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `ReferenceType`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'References.txt' INTO TABLE `References` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ReferenceID`, `Authors`, `Year`, `Title`, `Details`)
--------------

--------------
LOAD DATA LOCAL INFILE 'SourceDatabase.txt' INTO TABLE `SourceDatabase` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`DatabaseFullName`, `DatabaseShortName`, `DatabaseVersion`, `ReleaseDate`, `AuthorsEditors`, `TaxonomicCoverage`, `GroupNameInEnglish`, `Abstract`, `Organisation`, `HomeURL`, `Coverage`, `Completeness`, `Confidence`, `LogoFileName`, `ContactPerson`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Synonyms.txt' INTO TABLE `Synonyms` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `AcceptedTaxonID`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `InfraSpecies`, `InfraSpecificMarker`, `InfraSpecificAuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `GSDNameGUI`)
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



Initial database created. Creating database Assembly_Bryozoa in assembly schema
--------------
DROP DATABASE IF EXISTS Assembly_Bryozoa
--------------

--------------
CREATE DATABASE IF NOT EXISTS Assembly_Bryozoa
--------------

--------------
DROP TABLE IF EXISTS `databases`
--------------

--------------
CREATE TABLE  `databases` (
  `database_name_displayed` varchar(125) DEFAULT NULL,
  `record_id` int(10) NOT NULL AUTO_INCREMENT,
  `database_name` varchar(150) DEFAULT NULL,
  `database_full_name` varchar(100) NOT NULL DEFAULT '',
  `web_site` longtext,
  `organization` longtext,
  `contact_person` varchar(255) DEFAULT NULL,
  `taxa` varchar(255) DEFAULT NULL,
  `taxonomic_coverage` longtext,
  `abstract` longtext,
  `version` varchar(255) DEFAULT NULL,
  `release_date` date DEFAULT '0000-00-00',
  `SpeciesCount` int(11) DEFAULT 0,
  `SpeciesEst` int(11) DEFAULT 0,
  `authors_editors` longtext,
  `accepted_species_names` int(10) DEFAULT 0,
  `accepted_infraspecies_names` int(10) DEFAULT 0,
  `species_synonyms` int(10) DEFAULT 0,
  `infraspecies_synonyms` int(10) DEFAULT 0,
  `common_names` int(10) DEFAULT 0,
  `total_names` int(10) DEFAULT 0,
  `is_new` tinyint(1) NOT NULL DEFAULT 0,
  `coverage` varchar(45) DEFAULT NULL,
  `completeness` int(3) unsigned DEFAULT 0,
  `confidence` 	tinyint(1) unsigned DEFAULT 0,
  PRIMARY KEY (`record_id`),
  KEY `database_name` (`database_name`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `families`
--------------

--------------
CREATE TABLE  `families` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `hierarchy_code` varchar(250) NOT NULL,
  `kingdom` varchar(50) NOT NULL DEFAULT 'Not Assigned',
  `phylum` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `class` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `order` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `family` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `superfamily` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  `family_code` varchar(50) NOT NULL,
  `is_accepted_name` int(1) unsigned,
  PRIMARY KEY (`record_id`),
  KEY (`family_code`),
  KEY `kingdom` (`kingdom`),
  KEY `phylum` (`phylum`),
  KEY `class` (`class`),
  KEY `order` (`order`),
  KEY `family` (`family`),
  KEY `superfamily` (`superfamily`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `sp2000_statuses`
--------------

--------------
CREATE TABLE  `sp2000_statuses` (
  `record_id` int(1) NOT NULL AUTO_INCREMENT,
  `sp2000_status` varchar(50) NOT NULL DEFAULT '',
  PRIMARY KEY (`record_id`)
) ENGINE=MyISAM
--------------

--------------
DROP TABLE IF EXISTS `scientific_names`
--------------

--------------
CREATE TABLE  `scientific_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `web_site` longtext,
  `genus` varchar(50) DEFAULT NULL,
  `subgenus` varchar(50) DEFAULT NULL,
  `species` varchar(60) DEFAULT NULL,
  `infraspecies_parent_name_code` varchar(42) DEFAULT NULL,
  `infraspecies` varchar(50) DEFAULT NULL,
  `infraspecies_marker` varchar(50) DEFAULT NULL,
  `author` varchar(100) DEFAULT NULL,
  `accepted_name_code` varchar(42) DEFAULT NULL,
  `comment` longtext,
  `scrutiny_date` text,
  `sp2000_status_id` int(1) DEFAULT NULL,
  `database_id` int(10) DEFAULT NULL,
  `specialist_id` int(10) DEFAULT NULL,
  `family_id` int(10) DEFAULT NULL,
  `specialist_code` varchar(50) DEFAULT NULL,
  `family_code` varchar(50) DEFAULT NULL,
  `is_accepted_name` int(1) DEFAULT NULL,
  `GSDTaxonGUID` longtext,
  `GSDNameGUID` longtext,
  `is_extinct` smallint(1) NOT NULL DEFAULT '0',
  `has_preholocene` smallint(1) NOT NULL DEFAULT '0',
  `has_modern` smallint(1) NOT NULL DEFAULT '1',
  PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `specialist_code` (`specialist_code`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `common_names`
--------------

--------------
CREATE TABLE  `common_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `common_name` varchar(700) NOT NULL,
  `transliteration` varchar(700),
  `language` varchar(25) NOT NULL,
  `country` varchar(44) NOT NULL DEFAULT '',
  `area` varchar(50) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `database_id` int(10) NOT NULL,
  `is_infraspecies` int(1) NOT NULL DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `common_name` (`common_name`),
  KEY `reference_code` (`reference_code`),
  KEY `name_code` (`name_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `distribution`
--------------

--------------
CREATE TABLE  `distribution` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `distribution` longtext,
  `StandardInUse` varchar(255) DEFAULT NULL,
  
   `DistributionStatus` varchar(255),
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `lifezone`
--------------

--------------
CREATE TABLE  `lifezone` (
  `record_id` int(11) NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42),
  `lifezone` varchar(255),
  `database_id` int(10),
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `scientific_name_references`
--------------

--------------
CREATE TABLE  `scientific_name_references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `reference_type` varchar(10) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`,`reference_id`,`reference_type`),
  KEY `reference_code` (`reference_code`),
  KEY `name_code_2` (`name_code`,`reference_type`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `references`
--------------

--------------
CREATE TABLE  `references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `author` varchar(200) DEFAULT NULL,
  `year` varchar(50) DEFAULT NULL,
  `title` longtext,
  `source` longtext,
  `database_id` int(10) NOT NULL,
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `reference_code` (`reference_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `specialists`
--------------

--------------
CREATE TABLE  `specialists` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `specialist_name` varchar(255) NOT NULL DEFAULT '',
  `specialist_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `specialist_code` (`specialist_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
INSERT INTO `sp2000_statuses` 
VALUES (1,'accepted name'),
(2,'ambiguous synonym'),
(3,'misapplied name'),
(4,'provisionally accepted name'),
(5,'synonym')
--------------

--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Creation of the assembly database completed.

Starting structural transformations (ACEF3 to ACI)
--------------
SET @dbid = 81
--------------

--------------
SET @dbabbr = 'W-Bry-'
--------------

--------------
SET @dbtouse = 'Buffer_Bryozoa'
--------------

--------------
UPDATE `databases` SET `taxonomic_coverage`="Animalia - Bryozoa", `is_new` = 2, `taxa`="Bryozoans, moss animals", `coverage`="Global", `completeness` = 100, `confidence` = 5
--------------

--------------
SET foreign_key_checks = 0
--------------

--------------
TRUNCATE TABLE `databases`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `databases`
 SELECT
 CONCAT(`DatabaseShortName`, ': ', `DatabaseFullName`)  AS `database_name_displayed`,
 @dbid AS `record_id`,
 `DatabaseShortName` AS `database_name`,
 `DatabaseFullName` AS `database_full_name`,
  `HomeURL` AS `web_site`,
  `Organisation` AS `organization`,
  `ContactPerson` AS `contact_person`,
  `GroupNameInEnglish` AS `taxa`,
  `TaxonomicCoverage` AS `taxonomic_coverage`,
  `Abstract` AS `abstract`,
  `DatabaseVersion` AS `version`,
  `ReleaseDate` AS `release_date`,
  `Coverage` AS `SpeciesCount`,
  `Completeness` AS `SpeciesEst`,
  `AuthorsEditors` AS `authors_editors`,
  NULL AS `accepted_species_names`,
  NULL AS `accepted_infraspecies_names`,
  NULL AS `species_synonyms`,
  NULL AS `infraspecies_synonyms`,
  NULL AS `common_names`,
  NULL AS `total_names`,
  NULL AS `is_new`,
  NULL AS `coverage`,
  NULL AS `completeness`,
  NULL AS `confidence`
  FROM ",
@dbtouse,
".`SourceDatabase`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `distribution`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `distribution`
 SELECT
 NULL AS `record_id`,
 CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
 `Distribution` AS `distribution`,
 `StandardInUse` AS `StandardInUse`,
 `DistributionStatus` AS `DistributionStatus`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`Distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `families`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `families`
SELECT DISTINCT
NULL AS `record_id`,
NULL AS `hierarchy_code`,
`Kingdom` AS `kingdom`,
`Phylum` AS `phylum`,
`Class` AS `class`,
`Order` AS `order`,
`Family` AS `family`,
`Superfamily` AS `superfamily`,
@dbid AS `database_id`,
NULL AS `family_code`,
NULL AS `is_accepted_name`
FROM ",
@dbtouse,
".`AcceptedSpecies`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `families` SET `family_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `specialists`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `specialists`
SELECT DISTINCT
NULL  AS `record_id`,
`LTSSpecialist` AS `specialist_name`,
NULL AS `specialist_code`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LTSSpecialist` IS NOT NULL OR
`LTSSpecialist` != ''")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `specialists` SET `specialist_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `scientific_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`SpeciesURL` AS `web_site`,
`Genus` AS `genus`,
`SubGenusName` AS `subgenus`,
`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
NULL  AS `infraspecies`,
NULL  AS `infraspecies_marker`,
`AuthorString` AS `author`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `accepted_name_code`,
`AdditionalData` AS `comment`,
`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
`specialists`.`record_id` AS `specialist_id`,
`families`.`record_id` AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
`families`.`family_code` AS `family_code`,
1 AS `is_accepted_name`,
`GSDTaxonGUI` AS `GSDTaxonGUI`,
`GSDNameGUI` AS `GSDNameGUI`,
`IsFossil` AS `is_extinct`,
`IsFossil` AS `has_preholocene`,
if (`IsFossil` = 0, 1, 0) AS `has_modern`
FROM ",
@dbtouse,
".`AcceptedSpecies` AcceptedSpecies
LEFT OUTER JOIN `families` ON
(`AcceptedSpecies`.`Kingdom` = `families`.`kingdom` AND
`AcceptedSpecies`.`Phylum` = `families`.`phylum` AND
`AcceptedSpecies`.`Class` = `families`.`class` AND
`AcceptedSpecies`.`Order` = `families`.`order` AND
`AcceptedSpecies`.`Superfamily` = `families`.`superfamily` AND
`AcceptedSpecies`.`Family` = `families`.`family`)
LEFT OUTER JOIN `specialists` ON
`AcceptedSpecies`.`LTSSpecialist` = `specialists`.`specialist_name`
LEFT OUTER JOIN `sp2000_statuses` ON
`AcceptedSpecies`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `lifezone`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `lifezone`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`LifeZone` AS `lifezone`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LifeZone` IN('marine','freshwater','Marine','Freshwater')")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `name_code`,
NULL AS `web_site`,
`sn`.`genus` AS `genus`,
NULL AS `subgenus`,
`sn`.`species` AS `species`,
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) AS `infraspecies_parent_name_code`,
`AIT`.`InfraSpeciesEpithet` AS `infraspecies`,
`AIT`.`InfraSpecificMarker` AS `infraspecies_marker`,
`AIT`.`InfraSpecificAuthorString` AS `author`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `accepted_name_code`,
`AIT`.`AdditionalData` AS `comment`,
`AIT`.`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
sn.family_code AS `family_code`,
1 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`AIT`.`GSDNameGUI` AS `GSDNameGUI`,
0 AS `is_extinct`,
0 AS `has_preholocene`,
1 AS `has_modern`
FROM ",
@dbtouse,
".`AcceptedInfraSpecificTaxa` AIT
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`AIT`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`
LEFT OUTER JOIN `specialists` ON
`AIT`.`LTSSpecialist` = `specialists`.`specialist_name`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`Synonyms`.`ID`) AS `name_code`,
NULL AS `web_site`,
`Synonyms`.`Genus` AS `genus`,
`Synonyms`.`SubGenusName` AS `subgenus`,
`Synonyms`.`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
`Synonyms`.`InfraSpecies` AS `infraspecies`,
`Synonyms`.`InfraSpecificMarker` AS `infraspecies_marker`,
`Synonyms`.`AuthorString` AS `author`,
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) AS `accepted_name_code`,
NULL AS `comment`,
NULL AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
sn.`specialist_code` AS `specialist_code`,
sn.`family_code` AS `family_code`,
0 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`Synonyms`.`GSDNameGUI` AS `GSDNameGUI` ,
0 AS `is_extinct`,
0 AS `has_preholocene`,
1 AS `has_modern`
FROM ",
@dbtouse,
".`Synonyms` Synonyms
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`Synonyms`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `common_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `common_names`
SELECT
NULL,
CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
CONVERT(`CommonName` USING utf8) AS `common_name`,
`Transliteration` AS `transliteration`,
`Language` AS `language`,
`Country` AS `country`,
`Area` AS `area`,
 NULL AS `reference_ID`,
@dbid AS `database_ID`,
 NULL AS `is_infraspecies`,
 `ReferenceID` AS `reference_code`
 FROM ",
@dbtouse,
".`CommonNames`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `references`
SELECT
NULL AS `record_id`,
`Authors` AS `author`,
`Year` AS `year`,
NULL AS `title`,
`Title` AS `source`,
@dbid AS `database_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`
 FROM ",
@dbtouse,
".`References`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `scientific_name_references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_name_references`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr, `ID`) AS `name_code`,
`ReferenceType` AS `reference_type`,
NULL AS `reference_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`NameReferencesLinks`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET foreign_key_checks = 1
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Data Loaded.
</pre>
</pre><hr><b>Backing up...</b>
<pre>
Creating directory  23_08_06_05Oct2015
Backing up files
</pre><hr><b>Executing local editorial checks</b>
<pre>
<pre>
Integrity and editorial checks - this may take a while depending on size of the dataset...

Starting local editorial transformations
--------------
DELETE FROM `common_names` WHERE `common_name` IS NULL OR `common_name` = ""
--------------

--------------
DELETE FROM `distribution` WHERE `distribution` IS NULL OR `distribution` = ""
--------------

--------------
DELETE FROM `references` WHERE (`title` IS NULL OR `title` = "") AND (`author` IS NULL OR `author` = "")
--------------

--------------
DELETE FROM `specialists` WHERE `specialist_name` IS NULL OR `specialist_name` = ""
--------------

--------------
DELETE FROM `scientific_names` WHERE (`species` IS NULL OR `species` LIKE "%sp.%" OR `species` LIKE "%spp.%") AND `infraspecies` IS NULL
--------------

--------------
DELETE FROM `scientific_names` WHERE `genus` IS NULL OR `genus` = "" OR genus like "% %" OR `genus` LIKE '%sp.%' OR `genus` LIKE "%spp.%"
--------------

--------------
UPDATE `scientific_names` SET `family_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `specialist_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "forma" WHERE `infraspecies_marker` LIKE "f.%"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "var." WHERE `infraspecies_marker` LIKE "Variety"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "subsp." WHERE `infraspecies_marker` LIKE "Subspecies"
--------------

--------------
UPDATE `scientific_names` SET `sp2000_status_id` = 5 WHERE `sp2000_status_id` IS NULL AND `is_accepted_name` = 0
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE `family` LIKE "% %"
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE `order` LIKE "% %"
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE `class` LIKE "% %"
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE `phylum` LIKE "% %"
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE `kingdom` LIKE "% %"
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE (`family` IS NULL OR `family` = '')
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE (`order` IS NULL OR `order` = '')
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE (`class` IS NULL OR `class` = '')
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE (`phylum` IS NULL OR `phylum` = '')
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE (`kingdom` IS NULL OR `kingdom` = '')
--------------

--------------
UPDATE `families` SET `hierarchy_code` = CONCAT(`kingdom`,'-',`phylum`,'-',`class`,'-',`order`,'-',`family`)
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "subsequent type designation%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "Nom%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "taxonomy source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "additional source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "original description%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "source of synonymy%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "basis of record%"
--------------

--------------
UPDATE `databases` SET database_name_displayed = REPLACE(database_name_displayed,'_',' ')
--------------

--------------
UPDATE `databases` SET database_name = REPLACE(database_name,'_',' ')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ',', '')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ';', ',')
--------------

--------------
SELECT "Misspelt infraspecies (no subgenus): ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND 
(`subgenus` IS NULL OR `subgenus` = '') AND 
`infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%')
--------------

--------------
SELECT "Misspelt infraspecies (with subgenus): ", `name_code`, `genus`, `subgenus`, `species`, `infraspecies` FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND 
`subgenus` != '' AND 
(`infraspecies` NOT LIKE CONCAT(`genus`, ' (', `subgenus`, ') ', `species`, '%') OR `infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%'))
--------------

--------------
DELETE FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND 
(`subgenus` IS NULL OR `subgenus` = '') AND 
`infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%')
--------------

--------------
DELETE FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND 
`subgenus` != '' AND 
(`infraspecies` NOT LIKE CONCAT(`genus`, ' (', `subgenus`, ') ', `species`, '%') OR `infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%'))
--------------

--------------
SELECT "Incorrect infraspecies: ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %'  AND 
`infraspecies` NOT LIKE 'f.%' AND 
`infraspecies` NOT LIKE 'var.%' AND
`infraspecies` NOT LIKE 'subsp.%'
--------------

Incorrect infraspecies: 	name_code	genus	species	infraspecies
Incorrect infraspecies: 	W-Bry-467099	Puellina	biavicularia	Cribrilaria biavicularia septemspinosa
Incorrect infraspecies: 	W-Bry-467109	Puellina	innominata	Cribrilaria innominata vicariata
--------------
DELETE FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %'  AND 
`infraspecies` NOT LIKE 'f.%' AND 
`infraspecies` NOT LIKE 'var.%' AND
`infraspecies` NOT LIKE 'subsp.%'
--------------

--------------
SELECT "Infraspecies starting with marker: ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND 
(`infraspecies` LIKE 'f.%' OR 
`infraspecies` LIKE 'var.%' OR
`infraspecies` LIKE 'subsp.%')
--------------

Infraspecies starting with marker: 	name_code	genus	species	infraspecies
Infraspecies starting with marker: 	W-Bry-181494	Dendrobeania	pseudomurrayana	f. tenuis
Infraspecies starting with marker: 	W-Bry-111791	Crisia	denticulata	var. arctica
Infraspecies starting with marker: 	W-Bry-174164	Nevianipora	milneana	var. canui
Infraspecies starting with marker: 	W-Bry-396729	Membranipora	tehuelca	var. intertuberculata
--------------
UPDATE `scientific_names` SET `infraspecies` = SUBSTRING_INDEX(`infraspecies`, ' ', -1)
WHERE `infraspecies` LIKE '% %' AND 
(`infraspecies` LIKE 'f.%' OR 
`infraspecies` LIKE 'var.%' OR
`infraspecies` LIKE 'subsp.%')
--------------

--------------
SELECT "Infraspecies mismatch (infraspecies_parent_name_code set but infraspecies empty): ", `name_code`, `infraspecies_parent_name_code` FROM `scientific_names` 
WHERE CHAR_LENGTH(`infraspecies_parent_name_code`) > 1 AND 
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
SELECT "Infraspecies mismatch (infraspecies_marker set but infraspecies empty): ", `name_code`, `infraspecies_marker` FROM `scientific_names` 
WHERE CHAR_LENGTH(`infraspecies_marker`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
DELETE FROM `scientific_names` 
WHERE CHAR_LENGTH(`infraspecies_parent_name_code`) > 1 AND 
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
DELETE FROM `scientific_names` 
WHERE CHAR_LENGTH(`infraspecies_marker`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
UPDATE `scientific_names` SET `species` = LOWER(`species`)
--------------

--------------
SELECT "Empty species name: ", `name_code`, `genus`, `infraspecies` FROM `scientific_names` 
WHERE `species` = '' OR `species` IS NULL
--------------

--------------
DELETE FROM `scientific_names` 
WHERE `species` = '' OR `species` IS NULL
--------------

--------------
SELECT "Empty reference: ", `author`, `year`, `reference_code` FROM `references` 
WHERE (`title` = '' OR `title` IS NULL) AND
(`source` = '' OR `source` IS NULL)
--------------

--------------
DELETE FROM `references` 
WHERE (`title` = '' OR `title` IS NULL) AND
(`source` = '' OR `source` IS NULL)
--------------

--------------
UPDATE `scientific_names` SET `scrutiny_date` = DATE_FORMAT(`scrutiny_date`, '%d-%b-%Y')
WHERE `scrutiny_date` LIKE '%:%' AND
(`scrutiny_date` != '' OR `scrutiny_date` IS NOT NULL)
--------------

--------------
SELECT "Set is_infraspecies flag: ", t1.`name_code`, t1.`common_name`, t2.`genus`, t2.`species`, t2.`infraspecies` 
FROM `common_names` AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.`name_code` = t2.`name_code` 
WHERE (t2.`infraspecies` != '' OR t2.`infraspecies` IS NOT NULL) AND
t1.`is_infraspecies` = 0
--------------

--------------
UPDATE `common_names` AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.`name_code` = t2.`name_code` 
SET t1.`is_infraspecies` = 1
WHERE (t2.`infraspecies` != '' OR t2.`infraspecies` IS NOT NULL) AND
t1.`is_infraspecies` = 0
--------------

--------------
UPDATE `scientific_names` SET `author` = TRIM(`author`)
--------------

--------------
UPDATE `references`  SET `author` = TRIM(`author`)
--------------

--------------
SELECT "Duplicate accepted names:", sn.name_code, sn.sp2000_status_id, dups.genus, dups.subgenus, dups.species, dups.infraspecies_marker, dups.infraspecies, dups.author 
FROM 
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt 
	FROM scientific_names 
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups 
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author 
WHERE sn.sp2000_status_id = 1
--------------

--------------
SELECT "Accepted name to be retained", MAX(name_code), genus, subgenus, species, infraspecies_marker, infraspecies, author 
FROM
	(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, dups.species AS species, 
		dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author 
	FROM 
		(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt 
		FROM scientific_names 
		GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups 
	LEFT JOIN scientific_names sn
	ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2 
GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author
--------------

--------------
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, 
	dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author 
FROM 
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt 
	FROM scientific_names 
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups 
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author 
WHERE sn.sp2000_status_id = 1 AND sn.name_code NOT IN 
	(SELECT dups3.namecodes_to_keep FROM
		(SELECT MAX(name_code) AS namecodes_to_keep, genus, subgenus, species, infraspecies_marker, infraspecies, author 
		FROM
			(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, 
				dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author 
			FROM 	
				(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
				FROM scientific_names
				GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
		LEFT JOIN scientific_names sn
		ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2 
GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
SELECT 'Common name without parent accepted name', t1.record_id, t1.common_name, t1.name_code FROM common_names AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
CREATE TEMPORARY TABLE scientific_names_tmp 
(PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `specialist_code` (`specialist_code`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`))
SELECT * FROM scientific_names
--------------

--------------
SELECT 'Missing parent accepted name for synonym', record_id, name_code, genus, subgenus, species, infraspecies, accepted_name_code FROM scientific_names
WHERE is_accepted_name != 1 AND family_code IS NULL
--------------

Missing parent accepted name for synonym	record_id	name_code	genus	subgenus	species	infraspecies	accepted_name_code
Missing parent accepted name for synonym	6239	W-Bry-852853	Adeonellopsis		subsulcata		W-Bry-110816
--------------
SELECT 'Missing parent accepted name for infraspecies', record_id, name_code, genus, subgenus, species, infraspecies, infraspecies_parent_name_code 
FROM scientific_names 
WHERE LENGTH(infraspecies) > 1 AND family_code IS NULL
--------------

--------------
SELECT 'Lifezone without parent accepted name', t1.record_id, t1.name_code, t1.lifezone FROM lifezone AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
SELECT 'Distribution without parent accepted name', t1.record_id, t1.name_code, t1.distribution FROM distribution AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
SELECT 'Accepted name without parent family', t1.record_id, t1.name_code, t1.genus, t1.subgenus, t1.species, t1.infraspecies, t1.family_code 
FROM scientific_names AS t1
LEFT JOIN families AS t2 ON t1.family_code = t2.family_code
WHERE t2.family_code IS NULL
--------------

Accepted name without parent family	record_id	name_code	genus	subgenus	species	infraspecies	family_code
Accepted name without parent family	6239	W-Bry-852853	Adeonellopsis		subsulcata		NULL
--------------
SELECT 'Reference link to non-existing accepted name', t1.record_id, t1.reference_code, t1.name_code 
FROM scientific_name_references AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

Reference link to non-existing accepted name	record_id	reference_code	name_code
Reference link to non-existing accepted name	276	W-Bry-1224	W-Bry-153821
Reference link to non-existing accepted name	359	W-Bry-164387	W-Bry-469457
Reference link to non-existing accepted name	517	W-Bry-141272	W-Bry-111239
Reference link to non-existing accepted name	518	W-Bry-1369	W-Bry-111245
Reference link to non-existing accepted name	557	W-Bry-192633	W-Bry-156389
Reference link to non-existing accepted name	726	W-Bry-192311	W-Bry-251776
Reference link to non-existing accepted name	1108	W-Bry-7008	W-Bry-111155
Reference link to non-existing accepted name	1417	W-Bry-64	W-Bry-153836
Reference link to non-existing accepted name	1418	W-Bry-1309	W-Bry-153845
Reference link to non-existing accepted name	1419	W-Bry-2930	W-Bry-156129
Reference link to non-existing accepted name	1420	W-Bry-2930	W-Bry-159837
Reference link to non-existing accepted name	1654	W-Bry-200497	W-Bry-472639
Reference link to non-existing accepted name	2458	W-Bry-141272	W-Bry-422322
--------------
SELECT 'Reference link to non-existing reference', t1.record_id, t1.reference_code, t1.name_code 
FROM scientific_name_references AS t1
LEFT JOIN `references` AS t2 ON t1.reference_code = t2.reference_code
WHERE t2.reference_code IS NULL
--------------

Reference link to non-existing reference	record_id	reference_code	name_code
Reference link to non-existing reference	1	W-Bry-163039	W-Bry-111055
Reference link to non-existing reference	3	W-Bry-147411	W-Bry-111355
Reference link to non-existing reference	5	W-Bry-147411	W-Bry-111673
Reference link to non-existing reference	6	W-Bry-10085	W-Bry-111597
Reference link to non-existing reference	10	W-Bry-163039	W-Bry-111435
Reference link to non-existing reference	11	W-Bry-10085	W-Bry-111586
Reference link to non-existing reference	13	W-Bry-147411	W-Bry-111353
Reference link to non-existing reference	14	W-Bry-147411	W-Bry-111411
Reference link to non-existing reference	15	W-Bry-163043	W-Bry-111453
Reference link to non-existing reference	26	W-Bry-147411	W-Bry-111621
Reference link to non-existing reference	28	W-Bry-1071	W-Bry-111158
Reference link to non-existing reference	29	W-Bry-1071	W-Bry-111162
Reference link to non-existing reference	32	W-Bry-147412	W-Bry-111361
Reference link to non-existing reference	33	W-Bry-163039	W-Bry-111082
Reference link to non-existing reference	38	W-Bry-147411	W-Bry-111667
Reference link to non-existing reference	42	W-Bry-147411	W-Bry-111293
Reference link to non-existing reference	45	W-Bry-147411	W-Bry-472353
Reference link to non-existing reference	47	W-Bry-147411	W-Bry-111601
Reference link to non-existing reference	49	W-Bry-1369	W-Bry-111067
Reference link to non-existing reference	50	W-Bry-1369	W-Bry-111084
Reference link to non-existing reference	52	W-Bry-1369	W-Bry-111101
Reference link to non-existing reference	53	W-Bry-1369	W-Bry-111118
Reference link to non-existing reference	55	W-Bry-1369	W-Bry-111135
Reference link to non-existing reference	56	W-Bry-42	W-Bry-111152
Reference link to non-existing reference	57	W-Bry-42	W-Bry-111169
Reference link to non-existing reference	61	W-Bry-1369	W-Bry-111199
Reference link to non-existing reference	62	W-Bry-1369	W-Bry-111203
Reference link to non-existing reference	64	W-Bry-1369	W-Bry-111216
Reference link to non-existing reference	69	W-Bry-1369	W-Bry-111233
Reference link to non-existing reference	74	W-Bry-1369	W-Bry-111267
Reference link to non-existing reference	75	W-Bry-1225	W-Bry-111283
Reference link to non-existing reference	76	W-Bry-1369	W-Bry-111284
Reference link to non-existing reference	77	W-Bry-1369	W-Bry-111301
Reference link to non-existing reference	79	W-Bry-1369	W-Bry-111318
Reference link to non-existing reference	82	W-Bry-1369	W-Bry-111335
Reference link to non-existing reference	84	W-Bry-1369	W-Bry-111352
Reference link to non-existing reference	87	W-Bry-42	W-Bry-111369
Reference link to non-existing reference	89	W-Bry-42	W-Bry-111386
Reference link to non-existing reference	94	W-Bry-1369	W-Bry-111403
Reference link to non-existing reference	96	W-Bry-1369	W-Bry-111420
Reference link to non-existing reference	99	W-Bry-1369	W-Bry-111433
Reference link to non-existing reference	100	W-Bry-1369	W-Bry-111437
Reference link to non-existing reference	101	W-Bry-1369	W-Bry-111450
Reference link to non-existing reference	102	W-Bry-1369	W-Bry-111467
Reference link to non-existing reference	103	W-Bry-42	W-Bry-111484
Reference link to non-existing reference	104	W-Bry-1369	W-Bry-111501
Reference link to non-existing reference	106	W-Bry-1369	W-Bry-111518
Reference link to non-existing reference	108	W-Bry-1369	W-Bry-111535
Reference link to non-existing reference	110	W-Bry-1369	W-Bry-111552
Reference link to non-existing reference	111	W-Bry-1369	W-Bry-111569
Reference link to non-existing reference	114	W-Bry-42	W-Bry-111620
Reference link to non-existing reference	116	W-Bry-1369	W-Bry-111637
Reference link to non-existing reference	117	W-Bry-42	W-Bry-111654
Reference link to non-existing reference	119	W-Bry-1369	W-Bry-111671
Reference link to non-existing reference	120	W-Bry-1369	W-Bry-111684
Reference link to non-existing reference	123	W-Bry-1369	W-Bry-111701
Reference link to non-existing reference	125	W-Bry-1369	W-Bry-111718
Reference link to non-existing reference	127	W-Bry-1369	W-Bry-111735
Reference link to non-existing reference	129	W-Bry-42	W-Bry-111752
Reference link to non-existing reference	131	W-Bry-1369	W-Bry-111769
Reference link to non-existing reference	132	W-Bry-1369	W-Bry-111786
Reference link to non-existing reference	133	W-Bry-6998	W-Bry-146734
Reference link to non-existing reference	146	W-Bry-1225	W-Bry-173251
Reference link to non-existing reference	147	W-Bry-1225	W-Bry-173319
Reference link to non-existing reference	148	W-Bry-1225	W-Bry-173353
Reference link to non-existing reference	149	W-Bry-1225	W-Bry-173370
Reference link to non-existing reference	150	W-Bry-1225	W-Bry-173387
Reference link to non-existing reference	153	W-Bry-1225	W-Bry-173485
Reference link to non-existing reference	156	W-Bry-1225	W-Bry-173736
Reference link to non-existing reference	157	W-Bry-1225	W-Bry-173787
Reference link to non-existing reference	158	W-Bry-1225	W-Bry-173804
Reference link to non-existing reference	162	W-Bry-1225	W-Bry-174221
Reference link to non-existing reference	165	W-Bry-1225	W-Bry-174289
Reference link to non-existing reference	167	W-Bry-1225	W-Bry-174323
Reference link to non-existing reference	169	W-Bry-1225	W-Bry-174336
Reference link to non-existing reference	172	W-Bry-6831	W-Bry-183299
Reference link to non-existing reference	175	W-Bry-1225	W-Bry-216001
Reference link to non-existing reference	196	W-Bry-1225	W-Bry-395425
Reference link to non-existing reference	200	W-Bry-1225	W-Bry-395995
Reference link to non-existing reference	206	W-Bry-1225	W-Bry-408261
Reference link to non-existing reference	209	W-Bry-1225	W-Bry-422250
Reference link to non-existing reference	212	W-Bry-1369	W-Bry-111069
Reference link to non-existing reference	213	W-Bry-1369	W-Bry-111086
Reference link to non-existing reference	214	W-Bry-42	W-Bry-111099
Reference link to non-existing reference	215	W-Bry-1369	W-Bry-111116
Reference link to non-existing reference	216	W-Bry-42	W-Bry-111133
Reference link to non-existing reference	217	W-Bry-1369	W-Bry-111150
Reference link to non-existing reference	218	W-Bry-1369	W-Bry-111167
Reference link to non-existing reference	220	W-Bry-1369	W-Bry-111184
Reference link to non-existing reference	222	W-Bry-42	W-Bry-111201
Reference link to non-existing reference	223	W-Bry-1369	W-Bry-111218
Reference link to non-existing reference	224	W-Bry-1369	W-Bry-111235
Reference link to non-existing reference	231	W-Bry-1369	W-Bry-111286
Reference link to non-existing reference	232	W-Bry-1369	W-Bry-111303
Reference link to non-existing reference	234	W-Bry-1369	W-Bry-111316
Reference link to non-existing reference	235	W-Bry-1369	W-Bry-111320
Reference link to non-existing reference	236	W-Bry-1369	W-Bry-111333
Reference link to non-existing reference	237	W-Bry-1369	W-Bry-111350
Reference link to non-existing reference	239	W-Bry-1369	W-Bry-111384
Reference link to non-existing reference	242	W-Bry-1369	W-Bry-111401
Reference link to non-existing reference	243	W-Bry-1369	W-Bry-111418
Reference link to non-existing reference	245	W-Bry-1369	W-Bry-111452
Reference link to non-existing reference	246	W-Bry-1369	W-Bry-111469
Reference link to non-existing reference	248	W-Bry-1369	W-Bry-111486
Reference link to non-existing reference	251	W-Bry-1369	W-Bry-111503
Reference link to non-existing reference	253	W-Bry-1369	W-Bry-111520
Reference link to non-existing reference	255	W-Bry-1369	W-Bry-111537
Reference link to non-existing reference	256	W-Bry-1369	W-Bry-111550
Reference link to non-existing reference	258	W-Bry-1369	W-Bry-111567
Reference link to non-existing reference	259	W-Bry-42	W-Bry-111584
Reference link to non-existing reference	262	W-Bry-1369	W-Bry-111618
Reference link to non-existing reference	263	W-Bry-1369	W-Bry-111686
Reference link to non-existing reference	265	W-Bry-1369	W-Bry-111703
Reference link to non-existing reference	267	W-Bry-1369	W-Bry-111720
Reference link to non-existing reference	269	W-Bry-1369	W-Bry-111737
Reference link to non-existing reference	272	W-Bry-1369	W-Bry-111771
Reference link to non-existing reference	273	W-Bry-1369	W-Bry-111784
Reference link to non-existing reference	274	W-Bry-1369	W-Bry-111788
Reference link to non-existing reference	275	W-Bry-42	W-Bry-153717
Reference link to non-existing reference	282	W-Bry-1225	W-Bry-173117
Reference link to non-existing reference	284	W-Bry-1225	W-Bry-173134
Reference link to non-existing reference	287	W-Bry-1225	W-Bry-173351
Reference link to non-existing reference	289	W-Bry-1225	W-Bry-173504
Reference link to non-existing reference	290	W-Bry-1225	W-Bry-173551
Reference link to non-existing reference	291	W-Bry-1225	W-Bry-173619
Reference link to non-existing reference	294	W-Bry-1225	W-Bry-173670
Reference link to non-existing reference	295	W-Bry-1225	W-Bry-173734
Reference link to non-existing reference	296	W-Bry-1225	W-Bry-173802
Reference link to non-existing reference	303	W-Bry-1225	W-Bry-174287
Reference link to non-existing reference	305	W-Bry-1225	W-Bry-174321
Reference link to non-existing reference	307	W-Bry-1225	W-Bry-174338
Reference link to non-existing reference	309	W-Bry-1225	W-Bry-216003
Reference link to non-existing reference	311	W-Bry-1225	W-Bry-220632
Reference link to non-existing reference	321	W-Bry-43140	W-Bry-247974
Reference link to non-existing reference	322	W-Bry-1225	W-Bry-254422
Reference link to non-existing reference	328	W-Bry-1225	W-Bry-395061
Reference link to non-existing reference	331	W-Bry-1225	W-Bry-395997
Reference link to non-existing reference	344	W-Bry-1225	W-Bry-428519
Reference link to non-existing reference	363	W-Bry-1369	W-Bry-111076
Reference link to non-existing reference	364	W-Bry-1369	W-Bry-111077
Reference link to non-existing reference	367	W-Bry-1369	W-Bry-111126
Reference link to non-existing reference	368	W-Bry-1369	W-Bry-111127
Reference link to non-existing reference	370	W-Bry-42	W-Bry-111141
Reference link to non-existing reference	371	W-Bry-1369	W-Bry-111176
Reference link to non-existing reference	372	W-Bry-1369	W-Bry-111177
Reference link to non-existing reference	374	W-Bry-1369	W-Bry-111191
Reference link to non-existing reference	375	W-Bry-1369	W-Bry-111226
Reference link to non-existing reference	376	W-Bry-1369	W-Bry-111227
Reference link to non-existing reference	377	W-Bry-1369	W-Bry-111241
Reference link to non-existing reference	378	W-Bry-1369	W-Bry-111277
Reference link to non-existing reference	380	W-Bry-1369	W-Bry-111291
Reference link to non-existing reference	382	W-Bry-1369	W-Bry-111326
Reference link to non-existing reference	383	W-Bry-1369	W-Bry-111327
Reference link to non-existing reference	385	W-Bry-1369	W-Bry-111376
Reference link to non-existing reference	386	W-Bry-42	W-Bry-111377
Reference link to non-existing reference	387	W-Bry-1369	W-Bry-111426
Reference link to non-existing reference	388	W-Bry-1369	W-Bry-111427
Reference link to non-existing reference	389	W-Bry-1369	W-Bry-111462
Reference link to non-existing reference	390	W-Bry-1369	W-Bry-111476
Reference link to non-existing reference	391	W-Bry-1369	W-Bry-111477
Reference link to non-existing reference	392	W-Bry-1369	W-Bry-111526
Reference link to non-existing reference	393	W-Bry-1369	W-Bry-111527
Reference link to non-existing reference	395	W-Bry-1369	W-Bry-111562
Reference link to non-existing reference	397	W-Bry-1369	W-Bry-111576
Reference link to non-existing reference	398	W-Bry-42	W-Bry-111577
Reference link to non-existing reference	401	W-Bry-1369	W-Bry-111612
Reference link to non-existing reference	403	W-Bry-1369	W-Bry-111626
Reference link to non-existing reference	404	W-Bry-1369	W-Bry-111627
Reference link to non-existing reference	406	W-Bry-1369	W-Bry-111662
Reference link to non-existing reference	409	W-Bry-1369	W-Bry-111677
Reference link to non-existing reference	410	W-Bry-1369	W-Bry-111726
Reference link to non-existing reference	411	W-Bry-1369	W-Bry-111727
Reference link to non-existing reference	412	W-Bry-1369	W-Bry-111762
Reference link to non-existing reference	413	W-Bry-1369	W-Bry-111763
Reference link to non-existing reference	415	W-Bry-1369	W-Bry-111777
Reference link to non-existing reference	417	W-Bry-1592	W-Bry-146801
Reference link to non-existing reference	418	W-Bry-42	W-Bry-153724
Reference link to non-existing reference	419	W-Bry-1225	W-Bry-153755
Reference link to non-existing reference	420	W-Bry-1225	W-Bry-156362
Reference link to non-existing reference	425	W-Bry-1225	W-Bry-173024
Reference link to non-existing reference	426	W-Bry-1225	W-Bry-173074
Reference link to non-existing reference	428	W-Bry-1225	W-Bry-173260
Reference link to non-existing reference	431	W-Bry-1225	W-Bry-173411
Reference link to non-existing reference	432	W-Bry-1225	W-Bry-173560
Reference link to non-existing reference	433	W-Bry-1225	W-Bry-173661
Reference link to non-existing reference	440	W-Bry-1225	W-Bry-174311
Reference link to non-existing reference	448	W-Bry-1225	W-Bry-183320
Reference link to non-existing reference	461	W-Bry-1225	W-Bry-249669
Reference link to non-existing reference	462	W-Bry-1225	W-Bry-367625
Reference link to non-existing reference	484	W-Bry-1225	W-Bry-422326
Reference link to non-existing reference	503	W-Bry-1369	W-Bry-111081
Reference link to non-existing reference	505	W-Bry-1369	W-Bry-111138
Reference link to non-existing reference	506	W-Bry-42	W-Bry-111145
Reference link to non-existing reference	508	W-Bry-1369	W-Bry-111172
Reference link to non-existing reference	510	W-Bry-1369	W-Bry-111179
Reference link to non-existing reference	511	W-Bry-1369	W-Bry-111181
Reference link to non-existing reference	516	W-Bry-1369	W-Bry-111238
Reference link to non-existing reference	518	W-Bry-1369	W-Bry-111245
Reference link to non-existing reference	521	W-Bry-1369	W-Bry-111272
Reference link to non-existing reference	522	W-Bry-42	W-Bry-111281
Reference link to non-existing reference	523	W-Bry-1369	W-Bry-111315
Reference link to non-existing reference	524	W-Bry-1369	W-Bry-111338
Reference link to non-existing reference	527	W-Bry-1369	W-Bry-111372
Reference link to non-existing reference	528	W-Bry-1369	W-Bry-111379
Reference link to non-existing reference	529	W-Bry-1369	W-Bry-111381
Reference link to non-existing reference	530	W-Bry-1369	W-Bry-111415
Reference link to non-existing reference	531	W-Bry-1369	W-Bry-111438
Reference link to non-existing reference	532	W-Bry-1369	W-Bry-111474
Reference link to non-existing reference	534	W-Bry-1369	W-Bry-111479
Reference link to non-existing reference	535	W-Bry-1369	W-Bry-111481
Reference link to non-existing reference	536	W-Bry-1369	W-Bry-111508
Reference link to non-existing reference	537	W-Bry-1369	W-Bry-111515
Reference link to non-existing reference	539	W-Bry-1369	W-Bry-111572
Reference link to non-existing reference	540	W-Bry-1369	W-Bry-111574
Reference link to non-existing reference	541	W-Bry-1369	W-Bry-111581
Reference link to non-existing reference	543	W-Bry-1369	W-Bry-111608
Reference link to non-existing reference	544	W-Bry-1369	W-Bry-111615
Reference link to non-existing reference	546	W-Bry-1369	W-Bry-111674
Reference link to non-existing reference	547	W-Bry-1369	W-Bry-111681
Reference link to non-existing reference	549	W-Bry-1369	W-Bry-111715
Reference link to non-existing reference	550	W-Bry-1369	W-Bry-111717
Reference link to non-existing reference	552	W-Bry-1369	W-Bry-111738
Reference link to non-existing reference	553	W-Bry-1369	W-Bry-111772
Reference link to non-existing reference	554	W-Bry-1369	W-Bry-111774
Reference link to non-existing reference	555	W-Bry-1369	W-Bry-111781
Reference link to non-existing reference	558	W-Bry-64	W-Bry-156491
Reference link to non-existing reference	563	W-Bry-1225	W-Bry-173299
Reference link to non-existing reference	572	W-Bry-1225	W-Bry-174335
Reference link to non-existing reference	575	W-Bry-6831	W-Bry-182970
Reference link to non-existing reference	576	W-Bry-6831	W-Bry-183004
Reference link to non-existing reference	577	W-Bry-1225	W-Bry-216004
Reference link to non-existing reference	578	W-Bry-1225	W-Bry-216006
Reference link to non-existing reference	585	W-Bry-1225	W-Bry-234090
Reference link to non-existing reference	599	W-Bry-42	W-Bry-395050
Reference link to non-existing reference	643	W-Bry-1369	W-Bry-111075
Reference link to non-existing reference	645	W-Bry-1369	W-Bry-111092
Reference link to non-existing reference	646	W-Bry-1369	W-Bry-111093
Reference link to non-existing reference	647	W-Bry-1369	W-Bry-111110
Reference link to non-existing reference	650	W-Bry-42	W-Bry-111143
Reference link to non-existing reference	651	W-Bry-1369	W-Bry-111160
Reference link to non-existing reference	652	W-Bry-1369	W-Bry-111161
Reference link to non-existing reference	654	W-Bry-1369	W-Bry-111211
Reference link to non-existing reference	655	W-Bry-1369	W-Bry-111225
Reference link to non-existing reference	656	W-Bry-1369	W-Bry-111242
Reference link to non-existing reference	659	W-Bry-1369	W-Bry-111275
Reference link to non-existing reference	661	W-Bry-1369	W-Bry-111292
Reference link to non-existing reference	663	W-Bry-1369	W-Bry-111310
Reference link to non-existing reference	665	W-Bry-1369	W-Bry-111378
Reference link to non-existing reference	668	W-Bry-1369	W-Bry-111425
Reference link to non-existing reference	669	W-Bry-1369	W-Bry-111428
Reference link to non-existing reference	670	W-Bry-1369	W-Bry-111442
Reference link to non-existing reference	672	W-Bry-1369	W-Bry-111492
Reference link to non-existing reference	673	W-Bry-1369	W-Bry-111493
Reference link to non-existing reference	674	W-Bry-1369	W-Bry-111510
Reference link to non-existing reference	676	W-Bry-1369	W-Bry-111543
Reference link to non-existing reference	678	W-Bry-1369	W-Bry-111560
Reference link to non-existing reference	679	W-Bry-42	W-Bry-111561
Reference link to non-existing reference	682	W-Bry-1369	W-Bry-111611
Reference link to non-existing reference	684	W-Bry-1369	W-Bry-111628
Reference link to non-existing reference	685	W-Bry-1369	W-Bry-111629
Reference link to non-existing reference	686	W-Bry-1369	W-Bry-111646
Reference link to non-existing reference	688	W-Bry-1369	W-Bry-111679
Reference link to non-existing reference	689	W-Bry-1369	W-Bry-111693
Reference link to non-existing reference	690	W-Bry-1369	W-Bry-111710
Reference link to non-existing reference	691	W-Bry-42	W-Bry-111743
Reference link to non-existing reference	692	W-Bry-1369	W-Bry-111761
Reference link to non-existing reference	693	W-Bry-1369	W-Bry-111778
Reference link to non-existing reference	698	W-Bry-1225	W-Bry-173077
Reference link to non-existing reference	699	W-Bry-1225	W-Bry-173276
Reference link to non-existing reference	701	W-Bry-1225	W-Bry-173676
Reference link to non-existing reference	703	W-Bry-1225	W-Bry-173795
Reference link to non-existing reference	704	W-Bry-1225	W-Bry-173894
Reference link to non-existing reference	705	W-Bry-1225	W-Bry-174013
Reference link to non-existing reference	706	W-Bry-1225	W-Bry-174212
Reference link to non-existing reference	707	W-Bry-1225	W-Bry-174263
Reference link to non-existing reference	708	W-Bry-1225	W-Bry-174294
Reference link to non-existing reference	713	W-Bry-1225	W-Bry-174430
Reference link to non-existing reference	723	W-Bry-9785	W-Bry-234109
Reference link to non-existing reference	727	W-Bry-1225	W-Bry-254615
Reference link to non-existing reference	728	W-Bry-1225	W-Bry-367626
Reference link to non-existing reference	732	W-Bry-42	W-Bry-394868
Reference link to non-existing reference	740	W-Bry-1225	W-Bry-422343
Reference link to non-existing reference	742	W-Bry-1225	W-Bry-422374
Reference link to non-existing reference	748	W-Bry-1225	W-Bry-428508
Reference link to non-existing reference	749	W-Bry-1225	W-Bry-428526
Reference link to non-existing reference	770	W-Bry-1369	W-Bry-111071
Reference link to non-existing reference	771	W-Bry-1369	W-Bry-111089
Reference link to non-existing reference	772	W-Bry-1369	W-Bry-111096
Reference link to non-existing reference	773	W-Bry-1369	W-Bry-111114
Reference link to non-existing reference	776	W-Bry-42	W-Bry-111139
Reference link to non-existing reference	777	W-Bry-1369	W-Bry-111157
Reference link to non-existing reference	779	W-Bry-1369	W-Bry-111182
Reference link to non-existing reference	781	W-Bry-1369	W-Bry-111207
Reference link to non-existing reference	782	W-Bry-1369	W-Bry-111221
Reference link to non-existing reference	783	W-Bry-1369	W-Bry-111232
Reference link to non-existing reference	784	W-Bry-1369	W-Bry-111271
Reference link to non-existing reference	785	W-Bry-1369	W-Bry-111289
Reference link to non-existing reference	786	W-Bry-1369	W-Bry-111296
Reference link to non-existing reference	789	W-Bry-1369	W-Bry-111357
Reference link to non-existing reference	791	W-Bry-1369	W-Bry-111382
Reference link to non-existing reference	792	W-Bry-42	W-Bry-111407
Reference link to non-existing reference	794	W-Bry-1369	W-Bry-111432
Reference link to non-existing reference	796	W-Bry-1369	W-Bry-111446
Reference link to non-existing reference	797	W-Bry-1369	W-Bry-111471
Reference link to non-existing reference	798	W-Bry-1369	W-Bry-111489
Reference link to non-existing reference	800	W-Bry-42	W-Bry-111496
Reference link to non-existing reference	801	W-Bry-1369	W-Bry-111514
Reference link to non-existing reference	803	W-Bry-1369	W-Bry-111557
Reference link to non-existing reference	804	W-Bry-1369	W-Bry-111564
Reference link to non-existing reference	805	W-Bry-1369	W-Bry-111582
Reference link to non-existing reference	806	W-Bry-1369	W-Bry-111625
Reference link to non-existing reference	807	W-Bry-1369	W-Bry-111632
Reference link to non-existing reference	810	W-Bry-1369	W-Bry-111675
Reference link to non-existing reference	811	W-Bry-1369	W-Bry-111689
Reference link to non-existing reference	812	W-Bry-1369	W-Bry-111700
Reference link to non-existing reference	814	W-Bry-1369	W-Bry-111714
Reference link to non-existing reference	815	W-Bry-1369	W-Bry-111739
Reference link to non-existing reference	816	W-Bry-1369	W-Bry-111757
Reference link to non-existing reference	817	W-Bry-1369	W-Bry-111764
Reference link to non-existing reference	818	W-Bry-1369	W-Bry-111782
Reference link to non-existing reference	822	W-Bry-1225	W-Bry-156500
Reference link to non-existing reference	827	W-Bry-1225	W-Bry-173498
Reference link to non-existing reference	833	W-Bry-1225	W-Bry-174298
Reference link to non-existing reference	835	W-Bry-1225	W-Bry-174327
Reference link to non-existing reference	837	W-Bry-1225	W-Bry-174341
Reference link to non-existing reference	840	W-Bry-6831	W-Bry-183039
Reference link to non-existing reference	841	W-Bry-6831	W-Bry-183103
Reference link to non-existing reference	842	W-Bry-6831	W-Bry-183439
Reference link to non-existing reference	843	W-Bry-1225	W-Bry-183483
Reference link to non-existing reference	864	W-Bry-1225	W-Bry-422353
Reference link to non-existing reference	869	W-Bry-1225	W-Bry-422428
Reference link to non-existing reference	870	W-Bry-1225	W-Bry-428512
Reference link to non-existing reference	887	W-Bry-1369	W-Bry-111058
Reference link to non-existing reference	888	W-Bry-1369	W-Bry-111059
Reference link to non-existing reference	890	W-Bry-1369	W-Bry-111094
Reference link to non-existing reference	891	W-Bry-1369	W-Bry-111108
Reference link to non-existing reference	892	W-Bry-1369	W-Bry-111109
Reference link to non-existing reference	893	W-Bry-42	W-Bry-111144
Reference link to non-existing reference	894	W-Bry-1369	W-Bry-111194
Reference link to non-existing reference	896	W-Bry-1369	W-Bry-111208
Reference link to non-existing reference	897	W-Bry-1369	W-Bry-111209
Reference link to non-existing reference	898	W-Bry-1369	W-Bry-111244
Reference link to non-existing reference	899	W-Bry-1369	W-Bry-111258
Reference link to non-existing reference	900	W-Bry-1369	W-Bry-111294
Reference link to non-existing reference	901	W-Bry-1369	W-Bry-111295
Reference link to non-existing reference	902	W-Bry-1369	W-Bry-111308
Reference link to non-existing reference	903	W-Bry-1369	W-Bry-111309
Reference link to non-existing reference	904	W-Bry-1369	W-Bry-111344
Reference link to non-existing reference	905	W-Bry-1369	W-Bry-111345
Reference link to non-existing reference	907	W-Bry-1369	W-Bry-111394
Reference link to non-existing reference	908	W-Bry-1369	W-Bry-111395
Reference link to non-existing reference	909	W-Bry-1369	W-Bry-111408
Reference link to non-existing reference	910	W-Bry-1369	W-Bry-111409
Reference link to non-existing reference	912	W-Bry-1369	W-Bry-111444
Reference link to non-existing reference	913	W-Bry-1369	W-Bry-111459
Reference link to non-existing reference	914	W-Bry-1369	W-Bry-111494
Reference link to non-existing reference	915	W-Bry-1369	W-Bry-111509
Reference link to non-existing reference	917	W-Bry-42	W-Bry-111544
Reference link to non-existing reference	918	W-Bry-1369	W-Bry-111545
Reference link to non-existing reference	920	W-Bry-42	W-Bry-111594
Reference link to non-existing reference	921	W-Bry-1369	W-Bry-111595
Reference link to non-existing reference	922	W-Bry-1369	W-Bry-111609
Reference link to non-existing reference	923	W-Bry-1369	W-Bry-111644
Reference link to non-existing reference	924	W-Bry-1369	W-Bry-111645
Reference link to non-existing reference	926	W-Bry-1369	W-Bry-111694
Reference link to non-existing reference	927	W-Bry-1369	W-Bry-111709
Reference link to non-existing reference	929	W-Bry-42	W-Bry-111744
Reference link to non-existing reference	931	W-Bry-1369	W-Bry-111759
Reference link to non-existing reference	933	W-Bry-42	W-Bry-159808
Reference link to non-existing reference	938	W-Bry-1225	W-Bry-173093
Reference link to non-existing reference	940	W-Bry-1225	W-Bry-173242
Reference link to non-existing reference	944	W-Bry-1225	W-Bry-173393
Reference link to non-existing reference	945	W-Bry-1225	W-Bry-173479
Reference link to non-existing reference	946	W-Bry-1225	W-Bry-173492
Reference link to non-existing reference	947	W-Bry-1225	W-Bry-173528
Reference link to non-existing reference	951	W-Bry-1225	W-Bry-174164
Reference link to non-existing reference	953	W-Bry-1225	W-Bry-174329
Reference link to non-existing reference	956	W-Bry-6831	W-Bry-183226
Reference link to non-existing reference	959	W-Bry-1225	W-Bry-216012
Reference link to non-existing reference	960	W-Bry-1225	W-Bry-216026
Reference link to non-existing reference	961	W-Bry-1225	W-Bry-220607
Reference link to non-existing reference	966	W-Bry-1225	W-Bry-367607
Reference link to non-existing reference	983	W-Bry-1225	W-Bry-422409
Reference link to non-existing reference	985	W-Bry-1225	W-Bry-428510
Reference link to non-existing reference	998	W-Bry-1369	W-Bry-111066
Reference link to non-existing reference	1000	W-Bry-1369	W-Bry-111100
Reference link to non-existing reference	1001	W-Bry-1369	W-Bry-111102
Reference link to non-existing reference	1003	W-Bry-1369	W-Bry-111117
Reference link to non-existing reference	1004	W-Bry-1369	W-Bry-111136
Reference link to non-existing reference	1005	W-Bry-1369	W-Bry-111151
Reference link to non-existing reference	1006	W-Bry-1369	W-Bry-111217
Reference link to non-existing reference	1007	W-Bry-1369	W-Bry-111236
Reference link to non-existing reference	1008	W-Bry-1369	W-Bry-111251
Reference link to non-existing reference	1009	W-Bry-1369	W-Bry-111266
Reference link to non-existing reference	1010	W-Bry-42	W-Bry-111300
Reference link to non-existing reference	1011	W-Bry-1369	W-Bry-111302
Reference link to non-existing reference	1012	W-Bry-1369	W-Bry-111336
Reference link to non-existing reference	1014	W-Bry-1369	W-Bry-111387
Reference link to non-existing reference	1015	W-Bry-1369	W-Bry-111400
Reference link to non-existing reference	1016	W-Bry-1369	W-Bry-111417
Reference link to non-existing reference	1017	W-Bry-1369	W-Bry-111436
Reference link to non-existing reference	1018	W-Bry-1369	W-Bry-111451
Reference link to non-existing reference	1020	W-Bry-1369	W-Bry-111487
Reference link to non-existing reference	1021	W-Bry-1369	W-Bry-111500
Reference link to non-existing reference	1023	W-Bry-1369	W-Bry-111536
Reference link to non-existing reference	1025	W-Bry-1369	W-Bry-111551
Reference link to non-existing reference	1026	W-Bry-1369	W-Bry-111553
Reference link to non-existing reference	1027	W-Bry-1369	W-Bry-111587
Reference link to non-existing reference	1028	W-Bry-1369	W-Bry-111617
Reference link to non-existing reference	1029	W-Bry-1369	W-Bry-111687
Reference link to non-existing reference	1030	W-Bry-1369	W-Bry-111702
Reference link to non-existing reference	1032	W-Bry-1369	W-Bry-111736
Reference link to non-existing reference	1033	W-Bry-1369	W-Bry-111751
Reference link to non-existing reference	1034	W-Bry-1369	W-Bry-111753
Reference link to non-existing reference	1035	W-Bry-1369	W-Bry-111787
Reference link to non-existing reference	1045	W-Bry-1225	W-Bry-173101
Reference link to non-existing reference	1049	W-Bry-1225	W-Bry-173684
Reference link to non-existing reference	1057	W-Bry-1225	W-Bry-174271
Reference link to non-existing reference	1059	W-Bry-1225	W-Bry-174337
Reference link to non-existing reference	1063	W-Bry-1225	W-Bry-182995
Reference link to non-existing reference	1064	W-Bry-1225	W-Bry-210805
Reference link to non-existing reference	1077	W-Bry-1225	W-Bry-408260
Reference link to non-existing reference	1079	W-Bry-1225	W-Bry-410032
Reference link to non-existing reference	1104	W-Bry-1369	W-Bry-111073
Reference link to non-existing reference	1105	W-Bry-1369	W-Bry-111087
Reference link to non-existing reference	1106	W-Bry-1369	W-Bry-111123
Reference link to non-existing reference	1107	W-Bry-1369	W-Bry-111137
Reference link to non-existing reference	1109	W-Bry-1369	W-Bry-111180
Reference link to non-existing reference	1110	W-Bry-1369	W-Bry-111237
Reference link to non-existing reference	1111	W-Bry-1369	W-Bry-111287
Reference link to non-existing reference	1112	W-Bry-1369	W-Bry-111323
Reference link to non-existing reference	1113	W-Bry-1369	W-Bry-111337
Reference link to non-existing reference	1114	W-Bry-1369	W-Bry-111366
Reference link to non-existing reference	1115	W-Bry-42	W-Bry-111373
Reference link to non-existing reference	1117	W-Bry-1369	W-Bry-111416
Reference link to non-existing reference	1118	W-Bry-1369	W-Bry-111430
Reference link to non-existing reference	1119	W-Bry-1369	W-Bry-111466
Reference link to non-existing reference	1121	W-Bry-42	W-Bry-111480
Reference link to non-existing reference	1122	W-Bry-1369	W-Bry-111516
Reference link to non-existing reference	1124	W-Bry-1369	W-Bry-111530
Reference link to non-existing reference	1126	W-Bry-1369	W-Bry-111566
Reference link to non-existing reference	1127	W-Bry-1369	W-Bry-111580
Reference link to non-existing reference	1129	W-Bry-1369	W-Bry-111616
Reference link to non-existing reference	1130	W-Bry-1369	W-Bry-111630
Reference link to non-existing reference	1133	W-Bry-1369	W-Bry-111680
Reference link to non-existing reference	1134	W-Bry-1369	W-Bry-111716
Reference link to non-existing reference	1137	W-Bry-1369	W-Bry-111766
Reference link to non-existing reference	1138	W-Bry-1369	W-Bry-111773
Reference link to non-existing reference	1139	W-Bry-1369	W-Bry-111780
Reference link to non-existing reference	1153	W-Bry-1225	W-Bry-173157
Reference link to non-existing reference	1155	W-Bry-1225	W-Bry-173357
Reference link to non-existing reference	1156	W-Bry-1225	W-Bry-173471
Reference link to non-existing reference	1157	W-Bry-1225	W-Bry-173750
Reference link to non-existing reference	1158	W-Bry-1225	W-Bry-173757
Reference link to non-existing reference	1159	W-Bry-1225	W-Bry-173764
Reference link to non-existing reference	1166	W-Bry-1225	W-Bry-174207
Reference link to non-existing reference	1168	W-Bry-1225	W-Bry-174300
Reference link to non-existing reference	1172	W-Bry-6831	W-Bry-183298
Reference link to non-existing reference	1173	W-Bry-1225	W-Bry-216005
Reference link to non-existing reference	1212	W-Bry-1369	W-Bry-111064
Reference link to non-existing reference	1213	W-Bry-1369	W-Bry-111078
Reference link to non-existing reference	1214	W-Bry-1369	W-Bry-111103
Reference link to non-existing reference	1215	W-Bry-1369	W-Bry-111107
Reference link to non-existing reference	1216	W-Bry-1369	W-Bry-111128
Reference link to non-existing reference	1217	W-Bry-1369	W-Bry-111132
Reference link to non-existing reference	1218	W-Bry-1369	W-Bry-111146
Reference link to non-existing reference	1219	W-Bry-1369	W-Bry-111171
Reference link to non-existing reference	1221	W-Bry-1369	W-Bry-111264
Reference link to non-existing reference	1223	W-Bry-1369	W-Bry-111321
Reference link to non-existing reference	1224	W-Bry-1369	W-Bry-111332
Reference link to non-existing reference	1225	W-Bry-1369	W-Bry-111346
Reference link to non-existing reference	1226	W-Bry-1369	W-Bry-111371
Reference link to non-existing reference	1227	W-Bry-1369	W-Bry-111396
Reference link to non-existing reference	1228	W-Bry-1369	W-Bry-111414
Reference link to non-existing reference	1230	W-Bry-1369	W-Bry-111439
Reference link to non-existing reference	1231	W-Bry-1369	W-Bry-111457
Reference link to non-existing reference	1232	W-Bry-1369	W-Bry-111464
Reference link to non-existing reference	1233	W-Bry-1369	W-Bry-111482
Reference link to non-existing reference	1234	W-Bry-1369	W-Bry-111507
Reference link to non-existing reference	1235	W-Bry-1369	W-Bry-111532
Reference link to non-existing reference	1236	W-Bry-1369	W-Bry-111546
Reference link to non-existing reference	1237	W-Bry-1369	W-Bry-111571
Reference link to non-existing reference	1238	W-Bry-1369	W-Bry-111657
Reference link to non-existing reference	1239	W-Bry-1369	W-Bry-111682
Reference link to non-existing reference	1240	W-Bry-1369	W-Bry-111707
Reference link to non-existing reference	1241	W-Bry-1369	W-Bry-111732
Reference link to non-existing reference	1242	W-Bry-1369	W-Bry-111750
Reference link to non-existing reference	1244	W-Bry-1369	W-Bry-111789
Reference link to non-existing reference	1246	W-Bry-1225	W-Bry-156082
Reference link to non-existing reference	1250	W-Bry-1225	W-Bry-173266
Reference link to non-existing reference	1252	W-Bry-1225	W-Bry-173759
Reference link to non-existing reference	1256	W-Bry-1225	W-Bry-174266
Reference link to non-existing reference	1261	W-Bry-6831	W-Bry-182953
Reference link to non-existing reference	1263	W-Bry-6831	W-Bry-183071
Reference link to non-existing reference	1265	W-Bry-1225	W-Bry-216007
Reference link to non-existing reference	1273	W-Bry-6831	W-Bry-221536
Reference link to non-existing reference	1305	W-Bry-1369	W-Bry-111063
Reference link to non-existing reference	1306	W-Bry-1369	W-Bry-111097
Reference link to non-existing reference	1307	W-Bry-1369	W-Bry-111122
Reference link to non-existing reference	1309	W-Bry-1369	W-Bry-111131
Reference link to non-existing reference	1311	W-Bry-1369	W-Bry-111156
Reference link to non-existing reference	1312	W-Bry-1369	W-Bry-111165
Reference link to non-existing reference	1314	W-Bry-1369	W-Bry-111220
Reference link to non-existing reference	1315	W-Bry-1369	W-Bry-111297
Reference link to non-existing reference	1316	W-Bry-1369	W-Bry-111322
Reference link to non-existing reference	1317	W-Bry-1369	W-Bry-111331
Reference link to non-existing reference	1318	W-Bry-1369	W-Bry-111356
Reference link to non-existing reference	1319	W-Bry-1369	W-Bry-111390
Reference link to non-existing reference	1320	W-Bry-1369	W-Bry-111424
Reference link to non-existing reference	1321	W-Bry-1369	W-Bry-111454
Reference link to non-existing reference	1322	W-Bry-1369	W-Bry-111458
Reference link to non-existing reference	1323	W-Bry-1369	W-Bry-111463
Reference link to non-existing reference	1324	W-Bry-1369	W-Bry-111488
Reference link to non-existing reference	1325	W-Bry-1369	W-Bry-111497
Reference link to non-existing reference	1326	W-Bry-1369	W-Bry-111556
Reference link to non-existing reference	1327	W-Bry-1369	W-Bry-111565
Reference link to non-existing reference	1329	W-Bry-1369	W-Bry-111599
Reference link to non-existing reference	1330	W-Bry-1369	W-Bry-111658
Reference link to non-existing reference	1331	W-Bry-1369	W-Bry-111688
Reference link to non-existing reference	1332	W-Bry-1369	W-Bry-111692
Reference link to non-existing reference	1333	W-Bry-1369	W-Bry-111722
Reference link to non-existing reference	1334	W-Bry-1369	W-Bry-111731
Reference link to non-existing reference	1335	W-Bry-1369	W-Bry-111756
Reference link to non-existing reference	1336	W-Bry-1369	W-Bry-111790
Reference link to non-existing reference	1339	W-Bry-42	W-Bry-159765
Reference link to non-existing reference	1345	W-Bry-1225	W-Bry-173315
Reference link to non-existing reference	1355	W-Bry-1225	W-Bry-174251
Reference link to non-existing reference	1356	W-Bry-1225	W-Bry-174315
Reference link to non-existing reference	1361	W-Bry-1225	W-Bry-216022
Reference link to non-existing reference	1367	W-Bry-130463	W-Bry-395043
Reference link to non-existing reference	1387	W-Bry-1369	W-Bry-111068
Reference link to non-existing reference	1388	W-Bry-1369	W-Bry-111085
Reference link to non-existing reference	1389	W-Bry-1369	W-Bry-111119
Reference link to non-existing reference	1390	W-Bry-1369	W-Bry-111149
Reference link to non-existing reference	1391	W-Bry-1369	W-Bry-111168
Reference link to non-existing reference	1392	W-Bry-1369	W-Bry-111183
Reference link to non-existing reference	1393	W-Bry-1369	W-Bry-111185
Reference link to non-existing reference	1394	W-Bry-1369	W-Bry-111219
Reference link to non-existing reference	1395	W-Bry-1369	W-Bry-111234
Reference link to non-existing reference	1396	W-Bry-1369	W-Bry-111270
Reference link to non-existing reference	1397	W-Bry-1369	W-Bry-111319
Reference link to non-existing reference	1398	W-Bry-1369	W-Bry-111368
Reference link to non-existing reference	1399	W-Bry-1369	W-Bry-111370
Reference link to non-existing reference	1400	W-Bry-1369	W-Bry-111383
Reference link to non-existing reference	1401	W-Bry-1369	W-Bry-111385
Reference link to non-existing reference	1402	W-Bry-1369	W-Bry-111468
Reference link to non-existing reference	1403	W-Bry-1369	W-Bry-111470
Reference link to non-existing reference	1404	W-Bry-1369	W-Bry-111485
Reference link to non-existing reference	1405	W-Bry-1369	W-Bry-111534
Reference link to non-existing reference	1406	W-Bry-1369	W-Bry-111568
Reference link to non-existing reference	1407	W-Bry-1369	W-Bry-111570
Reference link to non-existing reference	1408	W-Bry-1369	W-Bry-111619
Reference link to non-existing reference	1409	W-Bry-1369	W-Bry-111634
Reference link to non-existing reference	1410	W-Bry-1369	W-Bry-111685
Reference link to non-existing reference	1411	W-Bry-1369	W-Bry-111704
Reference link to non-existing reference	1412	W-Bry-1369	W-Bry-111734
Reference link to non-existing reference	1413	W-Bry-1369	W-Bry-111768
Reference link to non-existing reference	1414	W-Bry-1369	W-Bry-111770
Reference link to non-existing reference	1416	W-Bry-42	W-Bry-153818
Reference link to non-existing reference	1417	W-Bry-64	W-Bry-153836
Reference link to non-existing reference	1426	W-Bry-1225	W-Bry-173352
Reference link to non-existing reference	1427	W-Bry-1225	W-Bry-173403
Reference link to non-existing reference	1432	W-Bry-1225	W-Bry-174339
Reference link to non-existing reference	1436	W-Bry-1225	W-Bry-181506
Reference link to non-existing reference	1437	W-Bry-6831	W-Bry-183102
Reference link to non-existing reference	1438	W-Bry-6831	W-Bry-183266
Reference link to non-existing reference	1439	W-Bry-1225	W-Bry-216000
Reference link to non-existing reference	1446	W-Bry-1225	W-Bry-408264
Reference link to non-existing reference	1492	W-Bry-1369	W-Bry-111104
Reference link to non-existing reference	1493	W-Bry-1369	W-Bry-111113
Reference link to non-existing reference	1494	W-Bry-42	W-Bry-111140
Reference link to non-existing reference	1495	W-Bry-1369	W-Bry-111204
Reference link to non-existing reference	1496	W-Bry-1369	W-Bry-111206
Reference link to non-existing reference	1497	W-Bry-42	W-Bry-111213
Reference link to non-existing reference	1498	W-Bry-1369	W-Bry-111240
Reference link to non-existing reference	1499	W-Bry-1369	W-Bry-111306
Reference link to non-existing reference	1500	W-Bry-1369	W-Bry-111340
Reference link to non-existing reference	1501	W-Bry-1369	W-Bry-111349
Reference link to non-existing reference	1502	W-Bry-1369	W-Bry-111404
Reference link to non-existing reference	1503	W-Bry-1369	W-Bry-111406
Reference link to non-existing reference	1504	W-Bry-1369	W-Bry-111413
Reference link to non-existing reference	1505	W-Bry-1369	W-Bry-111447
Reference link to non-existing reference	1506	W-Bry-1369	W-Bry-111449
Reference link to non-existing reference	1507	W-Bry-1369	W-Bry-111483
Reference link to non-existing reference	1508	W-Bry-1369	W-Bry-111504
Reference link to non-existing reference	1509	W-Bry-1369	W-Bry-111583
Reference link to non-existing reference	1510	W-Bry-1369	W-Bry-111606
Reference link to non-existing reference	1511	W-Bry-1369	W-Bry-111613
Reference link to non-existing reference	1512	W-Bry-1369	W-Bry-111647
Reference link to non-existing reference	1513	W-Bry-1369	W-Bry-111742
Reference link to non-existing reference	1514	W-Bry-1369	W-Bry-111747
Reference link to non-existing reference	1515	W-Bry-1369	W-Bry-111749
Reference link to non-existing reference	1517	W-Bry-1369	W-Bry-111783
Reference link to non-existing reference	1529	W-Bry-1225	W-Bry-173088
Reference link to non-existing reference	1531	W-Bry-1225	W-Bry-173488
Reference link to non-existing reference	1540	W-Bry-6831	W-Bry-183036
Reference link to non-existing reference	1541	W-Bry-6831	W-Bry-183038
Reference link to non-existing reference	1542	W-Bry-6831	W-Bry-183238
Reference link to non-existing reference	1543	W-Bry-6831	W-Bry-183415
Reference link to non-existing reference	1547	W-Bry-1225	W-Bry-220625
Reference link to non-existing reference	1555	W-Bry-1225	W-Bry-395062
Reference link to non-existing reference	1558	W-Bry-1225	W-Bry-408266
Reference link to non-existing reference	1628	W-Bry-1225	W-Bry-722993
Reference link to non-existing reference	1661	W-Bry-1225	W-Bry-722996
Reference link to non-existing reference	1700	W-Bry-1225	W-Bry-478330
Reference link to non-existing reference	1704	W-Bry-1225	W-Bry-722981
Reference link to non-existing reference	1705	W-Bry-1225	W-Bry-722998
Reference link to non-existing reference	1800	W-Bry-1225	W-Bry-722982
Reference link to non-existing reference	1801	W-Bry-1225	W-Bry-722983
Reference link to non-existing reference	1881	W-Bry-1225	W-Bry-719710
Reference link to non-existing reference	1882	W-Bry-1225	W-Bry-722997
Reference link to non-existing reference	1918	W-Bry-1225	W-Bry-478327
Reference link to non-existing reference	1920	W-Bry-1225	W-Bry-722995
Reference link to non-existing reference	1980	W-Bry-1225	W-Bry-722985
Reference link to non-existing reference	2088	W-Bry-1225	W-Bry-469955
Reference link to non-existing reference	2116	W-Bry-1225	W-Bry-478328
Reference link to non-existing reference	2159	W-Bry-1225	W-Bry-472625
Reference link to non-existing reference	2174	W-Bry-1369	W-Bry-111056
Reference link to non-existing reference	2175	W-Bry-1369	W-Bry-111065
Reference link to non-existing reference	2176	W-Bry-1369	W-Bry-111090
Reference link to non-existing reference	2177	W-Bry-1369	W-Bry-111095
Reference link to non-existing reference	2178	W-Bry-1369	W-Bry-111154
Reference link to non-existing reference	2179	W-Bry-1369	W-Bry-111163
Reference link to non-existing reference	2180	W-Bry-1369	W-Bry-111188
Reference link to non-existing reference	2181	W-Bry-1369	W-Bry-111222
Reference link to non-existing reference	2182	W-Bry-1369	W-Bry-111231
Reference link to non-existing reference	2183	W-Bry-1369	W-Bry-111265
Reference link to non-existing reference	2184	W-Bry-1369	W-Bry-111290
Reference link to non-existing reference	2185	W-Bry-1369	W-Bry-111299
Reference link to non-existing reference	2186	W-Bry-1369	W-Bry-111324
Reference link to non-existing reference	2187	W-Bry-1369	W-Bry-111329
Reference link to non-existing reference	2188	W-Bry-1369	W-Bry-111388
Reference link to non-existing reference	2189	W-Bry-1369	W-Bry-111422
Reference link to non-existing reference	2190	W-Bry-1369	W-Bry-111465
Reference link to non-existing reference	2191	W-Bry-1369	W-Bry-111490
Reference link to non-existing reference	2192	W-Bry-1369	W-Bry-111499
Reference link to non-existing reference	2193	W-Bry-1369	W-Bry-111524
Reference link to non-existing reference	2194	W-Bry-1369	W-Bry-111533
Reference link to non-existing reference	2196	W-Bry-1369	W-Bry-111733
Reference link to non-existing reference	2197	W-Bry-1369	W-Bry-111767
Reference link to non-existing reference	2204	W-Bry-1225	W-Bry-173508
Reference link to non-existing reference	2207	W-Bry-1225	W-Bry-174351
Reference link to non-existing reference	2210	W-Bry-1225	W-Bry-181494
Reference link to non-existing reference	2211	W-Bry-1225	W-Bry-183098
Reference link to non-existing reference	2212	W-Bry-6831	W-Bry-183322
Reference link to non-existing reference	2214	W-Bry-1225	W-Bry-215999
Reference link to non-existing reference	2215	W-Bry-1225	W-Bry-216024
Reference link to non-existing reference	2289	W-Bry-1369	W-Bry-111148
Reference link to non-existing reference	2290	W-Bry-1369	W-Bry-111198
Reference link to non-existing reference	2291	W-Bry-1369	W-Bry-111212
Reference link to non-existing reference	2292	W-Bry-1369	W-Bry-111262
Reference link to non-existing reference	2293	W-Bry-1369	W-Bry-111298
Reference link to non-existing reference	2294	W-Bry-1369	W-Bry-111305
Reference link to non-existing reference	2295	W-Bry-1369	W-Bry-111341
Reference link to non-existing reference	2296	W-Bry-1369	W-Bry-111348
Reference link to non-existing reference	2297	W-Bry-1369	W-Bry-111441
Reference link to non-existing reference	2298	W-Bry-1369	W-Bry-111448
Reference link to non-existing reference	2299	W-Bry-1369	W-Bry-111455
Reference link to non-existing reference	2300	W-Bry-1369	W-Bry-111491
Reference link to non-existing reference	2301	W-Bry-1369	W-Bry-111505
Reference link to non-existing reference	2302	W-Bry-1369	W-Bry-111541
Reference link to non-existing reference	2303	W-Bry-1369	W-Bry-111555
Reference link to non-existing reference	2304	W-Bry-1369	W-Bry-111598
Reference link to non-existing reference	2305	W-Bry-1369	W-Bry-111605
Reference link to non-existing reference	2306	W-Bry-1369	W-Bry-111648
Reference link to non-existing reference	2307	W-Bry-1369	W-Bry-111655
Reference link to non-existing reference	2308	W-Bry-1369	W-Bry-111691
Reference link to non-existing reference	2309	W-Bry-1369	W-Bry-111698
Reference link to non-existing reference	2310	W-Bry-1369	W-Bry-111705
Reference link to non-existing reference	2311	W-Bry-1369	W-Bry-111755
Reference link to non-existing reference	2312	W-Bry-1369	W-Bry-111791
Reference link to non-existing reference	2313	W-Bry-1225	W-Bry-147024
Reference link to non-existing reference	2324	W-Bry-1225	W-Bry-174275
Reference link to non-existing reference	2327	W-Bry-6831	W-Bry-183030
Reference link to non-existing reference	2328	W-Bry-6831	W-Bry-183037
Reference link to non-existing reference	2329	W-Bry-6831	W-Bry-183323
Reference link to non-existing reference	2331	W-Bry-1225	W-Bry-216023
Reference link to non-existing reference	2332	W-Bry-1225	W-Bry-216073
Reference link to non-existing reference	2334	W-Bry-1225	W-Bry-236136
Reference link to non-existing reference	2403	W-Bry-1369	W-Bry-111057
Reference link to non-existing reference	2404	W-Bry-1369	W-Bry-111074
Reference link to non-existing reference	2405	W-Bry-1369	W-Bry-111111
Reference link to non-existing reference	2406	W-Bry-1369	W-Bry-111175
Reference link to non-existing reference	2407	W-Bry-1369	W-Bry-111210
Reference link to non-existing reference	2408	W-Bry-1369	W-Bry-111243
Reference link to non-existing reference	2409	W-Bry-1369	W-Bry-111261
Reference link to non-existing reference	2410	W-Bry-1369	W-Bry-111278
Reference link to non-existing reference	2411	W-Bry-1369	W-Bry-111311
Reference link to non-existing reference	2412	W-Bry-1369	W-Bry-111325
Reference link to non-existing reference	2413	W-Bry-1369	W-Bry-111328
Reference link to non-existing reference	2414	W-Bry-1369	W-Bry-111375
Reference link to non-existing reference	2415	W-Bry-1369	W-Bry-111392
Reference link to non-existing reference	2416	W-Bry-1369	W-Bry-111443
Reference link to non-existing reference	2417	W-Bry-1369	W-Bry-111460
Reference link to non-existing reference	2418	W-Bry-1369	W-Bry-111461
Reference link to non-existing reference	2419	W-Bry-1369	W-Bry-111478
Reference link to non-existing reference	2420	W-Bry-1369	W-Bry-111511
Reference link to non-existing reference	2421	W-Bry-1369	W-Bry-111528
Reference link to non-existing reference	2422	W-Bry-1369	W-Bry-111529
Reference link to non-existing reference	2423	W-Bry-1369	W-Bry-111542
Reference link to non-existing reference	2424	W-Bry-1369	W-Bry-111579
Reference link to non-existing reference	2425	W-Bry-1369	W-Bry-111593
Reference link to non-existing reference	2426	W-Bry-1369	W-Bry-111610
Reference link to non-existing reference	2427	W-Bry-1369	W-Bry-111643
Reference link to non-existing reference	2428	W-Bry-1369	W-Bry-111660
Reference link to non-existing reference	2429	W-Bry-1369	W-Bry-111661
Reference link to non-existing reference	2430	W-Bry-1369	W-Bry-111678
Reference link to non-existing reference	2431	W-Bry-1369	W-Bry-111711
Reference link to non-existing reference	2432	W-Bry-1369	W-Bry-111728
Reference link to non-existing reference	2433	W-Bry-1369	W-Bry-111729
Reference link to non-existing reference	2434	W-Bry-1369	W-Bry-111779
Reference link to non-existing reference	2445	W-Bry-1225	W-Bry-216011
Reference link to non-existing reference	2446	W-Bry-1225	W-Bry-216025
Reference link to non-existing reference	2448	W-Bry-1225	W-Bry-220623
Reference link to non-existing reference	2449	W-Bry-1225	W-Bry-220640
--------------
SELECT 'Specialist not present in scientific names table', t1.record_id, t1.specialist_name, t1.specialist_code 
FROM specialists AS t1
LEFT JOIN scientific_names AS t2 ON t1.specialist_code = t2.specialist_code
WHERE t2.specialist_code IS NULL
--------------

--------------
SELECT 'Reference without parent accepted or common name', t1.record_id, t1.author, t1.year, t1.title, t1.reference_code 
FROM `references` AS t1
LEFT JOIN scientific_name_references AS t2 ON t1.reference_code = t2.reference_code
LEFT JOIN common_names AS t3 ON t1.reference_code = t3.reference_code
WHERE t2.reference_code IS NULL AND t3.reference_code IS NULL
--------------

Reference without parent accepted or common name	record_id	author	year	title	reference_code
Reference without parent accepted or common name	1	Porter, J.S.	2004	NULL	W-Bry-1681
Reference without parent accepted or common name	3	de Ruijter, R.	2005	NULL	W-Bry-132009
Reference without parent accepted or common name	11	Dumont, J. P. C.	1981	NULL	W-Bry-166713
Reference without parent accepted or common name	17	d'Udekem d'Acoz, C.	1991	NULL	W-Bry-131986
Reference without parent accepted or common name	18	Soule, Chaney & Morris	2003	NULL	W-Bry-131210
Reference without parent accepted or common name	20	Redant, F.	1976	NULL	W-Bry-131969
Reference without parent accepted or common name	22	Koulman, A., de Bruin J. & J. Begeman	2003	NULL	W-Bry-131977
Reference without parent accepted or common name	32	Linnaeus, C.	1767	NULL	W-Bry-671
Reference without parent accepted or common name	35	Zenetos, A.; Meric, E.; Verlaque, M.; Galli, P.; Boudouresque, C.; Giangrande, A.; Cinar, M.; Bilecenoglu, M.	2008	NULL	W-Bry-195830
Reference without parent accepted or common name	43	De Blauwe, H.	2000	NULL	W-Bry-1163
Reference without parent accepted or common name	55	Soule, Chaney & Morris	2003	NULL	W-Bry-131207
Reference without parent accepted or common name	58	Kukliński, P.; Hayward, P. J.	2004	NULL	W-Bry-7011
Reference without parent accepted or common name	60	Farre, A.,	1837	NULL	W-Bry-35928
Reference without parent accepted or common name	68	Occhipinti-Ambrogi, A.; Marchini, A.; Cantone, G.; Castelli, A.; Chimenz, C.; Cormaci, M.; Froglia, C.; Furnari, G.; Gambi, M. C.; Giaccone, G.; Giangrande, A.; Gravili, C.; Mastrototaro, F.; Mazziott	2010	NULL	W-Bry-152100
Reference without parent accepted or common name	76	De Grave, S.; d’Udekem d’Acoz; C	1988	NULL	W-Bry-132020
Reference without parent accepted or common name	79	Carter, M. C.; Gordon, D. P.	2007	NULL	W-Bry-196760
Reference without parent accepted or common name	81	De Blauwe, H.	2005	NULL	W-Bry-131980
Reference without parent accepted or common name	85	Landsborough, D.,	1852	NULL	W-Bry-36478
Reference without parent accepted or common name	90	Hayward.	2003	NULL	W-Bry-128586
Reference without parent accepted or common name	92	Hayward, P. J.; Hansen, K. B.	1999	NULL	W-Bry-176947
Reference without parent accepted or common name	95	Soule, Chaney & Morris	2003	NULL	W-Bry-131211
Reference without parent accepted or common name	99	Jebram, D.	1968	NULL	W-Bry-131995
Reference without parent accepted or common name	100	Verkuil, J.	1998	NULL	W-Bry-132018
Reference without parent accepted or common name	101	d'Hondt, J.-L.; Faasse, M.A.	2006	NULL	W-Bry-42326
Reference without parent accepted or common name	104	Cadman, P. S.; Ryland, J. S.	1996	NULL	W-Bry-131978
Reference without parent accepted or common name	105	De Blauwe, H.	2001	NULL	W-Bry-1158
Reference without parent accepted or common name	106	Nehring, S.	2006	NULL	W-Bry-9803
Reference without parent accepted or common name	109	Liu, Liu & Sun.	2003	NULL	W-Bry-128872
Reference without parent accepted or common name	111	Bromley and Bleakney,	1977	NULL	W-Bry-2927
Reference without parent accepted or common name	113	De Blauwe, H.	2000	NULL	W-Bry-132015
Reference without parent accepted or common name	115	Bobin, G. & Prenant, M.	1965	NULL	W-Bry-163777
Reference without parent accepted or common name	119	d'Udekem d'Acoz, C.	1993	NULL	W-Bry-131984
Reference without parent accepted or common name	120	J-L, L.; d’	1973	NULL	W-Bry-7006
Reference without parent accepted or common name	126	Xixing, L.; Huilian, L.	1999	NULL	W-Bry-131961
Reference without parent accepted or common name	128	Soule, Chaney & Morris	2003	NULL	W-Bry-131208
Reference without parent accepted or common name	129	Heerebout, G.R.	1970	NULL	W-Bry-131992
Reference without parent accepted or common name	135	Lacourt, A.W.	1949	NULL	W-Bry-131975
Reference without parent accepted or common name	137	De Blauwe, H.	2004	NULL	W-Bry-1685
Reference without parent accepted or common name	159	Liu, Liu & Sun.	2003	NULL	W-Bry-128875
Reference without parent accepted or common name	163	Taylor, P. D.; Cook, P. L.	1981	NULL	W-Bry-173057
Reference without parent accepted or common name	165	Hastings, A. B.	1963	NULL	W-Bry-163774
Reference without parent accepted or common name	166	Harmelin, J.-G., Boury-Esnault, N., Fichez, R., Vacelet, J. & Zibrowius, H.	2003	NULL	W-Bry-193827
Reference without parent accepted or common name	170	Meinkoth, N.A.	1981	NULL	W-Bry-3017
Reference without parent accepted or common name	174	de Boois I.	1998	NULL	W-Bry-131979
Reference without parent accepted or common name	176	d'Hondt, J.-L.; Occhipinti Ambrogi, A.	1985	NULL	W-Bry-644
Reference without parent accepted or common name	181	de Ruijter, R.	2007	NULL	W-Bry-132010
Reference without parent accepted or common name	184	Ryland, J.S.; Hayward, P.J.	1977	NULL	W-Bry-1076
Reference without parent accepted or common name	196	Marcus, E.	1940	NULL	W-Bry-131976
Reference without parent accepted or common name	197	Vieira, L. M.; Migotto, A. E.; Winston, J. E.	2010	NULL	W-Bry-145352
Reference without parent accepted or common name	198	Guiry, M.D. and Nic Dhonncha, E.,	2004	NULL	W-Bry-2968
Reference without parent accepted or common name	203	Winston, J. E.; Woollacott, R. M.	2008	NULL	W-Bry-145893
Reference without parent accepted or common name	205	Novosel, M.; Poar-Domac, A.; Pasari, M.	2004	NULL	W-Bry-8621
Reference without parent accepted or common name	208	Amui, Ann-Margret,	2005	NULL	W-Bry-127991
Reference without parent accepted or common name	211	de Ruijter, R.	2006	NULL	W-Bry-132013
Reference without parent accepted or common name	212	Quelch, J. J.	1884	NULL	W-Bry-163248
Reference without parent accepted or common name	213	Kuklinski & Taylor.	2006	NULL	W-Bry-128804
Reference without parent accepted or common name	214	Macgillivray, J.	1842	NULL	W-Bry-36636
Reference without parent accepted or common name	215	Vanhaelen, M.; Jonckheere, I.; De Blauwe, H.	2006	NULL	W-Bry-131999
Reference without parent accepted or common name	216	Maitland, R.S.	1851	NULL	W-Bry-62229
Reference without parent accepted or common name	220	Eneman, E.	1984	NULL	W-Bry-755
Reference without parent accepted or common name	221	Harmelin J.G. & Capo S.	2002	NULL	W-Bry-7004
Reference without parent accepted or common name	222	Liu, Liu & Sun.	2003	NULL	W-Bry-128873
Reference without parent accepted or common name	223	Van der Sleen, W.G.N.,	1920	NULL	W-Bry-32921
Reference without parent accepted or common name	230	de Ruijter, R.	2006	NULL	W-Bry-132019
Reference without parent accepted or common name	231	Liu, Liu & Sun.	2003	NULL	W-Bry-128876
Reference without parent accepted or common name	234	Silén, L.	1946	NULL	W-Bry-163695
Reference without parent accepted or common name	238	de Blauwe, Hans; Faasse, Marco	2001	NULL	W-Bry-192070
Reference without parent accepted or common name	240	Seo & Gong.	2006	NULL	W-Bry-129385
Reference without parent accepted or common name	243	Hayward, P. J.	1996	NULL	W-Bry-156702
Reference without parent accepted or common name	244	Johnston, George	1838	NULL	W-Bry-50556
Reference without parent accepted or common name	245	Linnaeus, C.	1758	NULL	W-Bry-8
Reference without parent accepted or common name	248	Winston, J.E., P.J. Hayward, and S.F. Craig.	2000	NULL	W-Bry-3097
Reference without parent accepted or common name	254	van Benthem Jutting	1922	NULL	W-Bry-131985
Reference without parent accepted or common name	258	Ryland, J. S.	1977	NULL	W-Bry-163787
Reference without parent accepted or common name	267	Vieira, L. M.; Spencer Jones, M. E.	2012	NULL	W-Bry-164998
Reference without parent accepted or common name	268	Hayward, P. J.	1994	NULL	W-Bry-201139
Reference without parent accepted or common name	269	J P H M Adema	1991	NULL	W-Bry-21480
Reference without parent accepted or common name	272	Soule, Chaney & Morris	2003	NULL	W-Bry-131212
Reference without parent accepted or common name	280	Ellis, J.; Solander, D.	1786	NULL	W-Bry-7454
Reference without parent accepted or common name	283	Norman, A.M.,	1867	NULL	W-Bry-18220
Reference without parent accepted or common name	286	Marchini, A.; Ferrario, J.; Sfriso, A.; Occhipinti-Ambrogi, A.	2015	NULL	W-Bry-198222
Reference without parent accepted or common name	287	Lopez.	2002	NULL	W-Bry-128888
Reference without parent accepted or common name	288	Faasse, M.; De Blauwe, H.	2003	NULL	W-Bry-1669
Reference without parent accepted or common name	293	Loppens, K.	1906	NULL	W-Bry-131974
Reference without parent accepted or common name	294	Lamouroux	1821	NULL	W-Bry-7772
Reference without parent accepted or common name	295	Corriero, G.; Pierri, C.; Accoroni, S.; Alabiso, G.; Bavestrello, G.; Barbone, E.; Bastianini, M.; Bazzoni, A. M.; Bernardi Aubry, F.; Boero, F.; Buia, M. C.; Cabrini, M.; Camatti, E.; Cardone, F.; Ca	2015	NULL	W-Bry-197902
Reference without parent accepted or common name	298	Dyntaxa	2013	NULL	W-Bry-165516
Reference without parent accepted or common name	299	Ryland, J. S.; Porter, J. S.	2000	NULL	W-Bry-131968
Reference without parent accepted or common name	300	Kent, W. S.	1870	NULL	W-Bry-163200
Reference without parent accepted or common name	304	Fabricius, O	1780	NULL	W-Bry-281
Reference without parent accepted or common name	305	de Ruijter, R.	2005	NULL	W-Bry-132008
Reference without parent accepted or common name	310	Nikulina, Elena A., de Blauwe, Hans & Reverter-Gil, Oscar,	2012	NULL	W-Bry-172984
Reference without parent accepted or common name	316	Davoult, D.; Dewarumez, J.-M.; Luczak, C.; Migné, A.	1999	NULL	W-Bry-1260
Reference without parent accepted or common name	318	Vanderperren, J.-P.	1991	NULL	W-Bry-139287
Reference without parent accepted or common name	319	Cardigos, F.; Tempera, F.; Ávila, S.; Gonçalves, J.; Colaço, A.; Santos, R. S.	2006	NULL	W-Bry-191939
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
CREATE TEMPORARY TABLE duplicates_to_delete AS
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus,
	dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
FROM
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
	FROM scientific_names
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id
	HAVING cnt > 1) AS dups
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
WHERE sn.sp2000_status_id = 1 AND sn.name_code NOT IN
	(SELECT dups3.namecodes_to_keep FROM
		(SELECT MAX(name_code) AS namecodes_to_keep, genus, subgenus, species, infraspecies_marker, infraspecies, author FROM
			(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, dups.species AS species,
				dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
			FROM
				(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
				FROM scientific_names
				GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
			LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
			WHERE sn.sp2000_status_id = 1) AS dups2
		GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
DELETE QUICK FROM scientific_names
USING scientific_names
INNER JOIN duplicates_to_delete ON scientific_names.name_code = duplicates_to_delete.name_code
--------------

--------------
DELETE QUICK t1 FROM common_names AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.accepted_name_code = t2.name_code
WHERE t2.name_code IS NULL AND t1.is_accepted_name != 1
--------------

--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.infraspecies_parent_name_code = t2.name_code
WHERE t1.infraspecies_parent_name_code IS NOT NULL AND t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM lifezone AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
OPTIMIZE TABLE lifezone
--------------

Table	Op	Msg_type	Msg_text
Assembly_Bryozoa.lifezone	optimize	status	OK
--------------
DELETE QUICK t1 FROM distribution AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
OPTIMIZE TABLE distribution
--------------

Table	Op	Msg_type	Msg_text
Assembly_Bryozoa.distribution	optimize	status	OK
--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN families AS t2 ON t1.family_code = t2.family_code
WHERE t2.family_code IS NULL
--------------

--------------
OPTIMIZE TABLE scientific_names
--------------

Table	Op	Msg_type	Msg_text
Assembly_Bryozoa.scientific_names	optimize	status	OK
--------------
DELETE QUICK t1 FROM scientific_name_references AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM scientific_name_references AS t1
LEFT JOIN `references` AS t2 ON t1.reference_code = t2.reference_code
WHERE t2.reference_code IS NULL
--------------

--------------
OPTIMIZE TABLE scientific_name_references
--------------

Table	Op	Msg_type	Msg_text
Assembly_Bryozoa.scientific_name_references	optimize	status	OK
--------------
DELETE QUICK t1 FROM specialists AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.specialist_code = t2.specialist_code
WHERE t2.specialist_code IS NULL
--------------

--------------
DELETE t1 FROM `references` AS t1
LEFT JOIN scientific_name_references AS t2 ON t1.reference_code = t2.reference_code
LEFT JOIN common_names AS t3 ON t1.reference_code = t3.reference_code
WHERE t2.reference_code IS NULL AND t3.reference_code IS NULL
--------------

--------------
OPTIMIZE TABLE `references`
--------------

Table	Op	Msg_type	Msg_text
Assembly_Bryozoa.references	optimize	status	OK
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

</pre>
<pre>
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Editorial and Integrity checks Completed.
</pre>
</pre><hr><b>Replacing sectors in Assembly Global database</b>
<pre>
<pre>
Starting Sector Management
--------------
SET @dbid = 81
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
DELETE FROM ",
@dbtouse,
".`databases` WHERE `record_id` = @dbid")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`families` SELECT 
NULL AS `record_id`,
`hierarchy_code`,	
`kingdom`,	
`phylum`,	
`class`,	
`order`,	
`family`,	
`superfamily`, 	
`database_id`, 	
`family_code`,
`is_accepted_name`
FROM  `families`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`databases` SELECT 
`database_name_displayed`, 
`record_id`, 
`database_name`, 
`database_full_name`, 
`web_site`, 
`organization`, 
`contact_person`, 
`taxa`, 
`taxonomic_coverage`, 
`abstract`, 
`version`, 
`release_date`, 
`SpeciesCount`, 
`SpeciesEst`, 
`authors_editors`, 
`accepted_species_names`, 
`accepted_infraspecies_names`, 
`species_synonyms`, 
`infraspecies_synonyms`, 
`common_names`, 
`total_names`, 
`is_new`,
`coverage`,
`completeness`,
`confidence`
FROM `databases`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_names` 
(`record_id`, `name_code`, `web_site`, `genus`, `subgenus`, `species`, `infraspecies_parent_name_code`, `infraspecies`, `infraspecies_marker`, `author`, `accepted_name_code`, `comment`, `scrutiny_date`, `sp2000_status_id`, `database_id`, `specialist_id`, `family_id`, `specialist_code`, `family_code`, `is_accepted_name`, `GSDTaxonGUID`, `GSDNameGUID`, `is_extinct`, `has_preholocene`, `has_modern`) SELECT 
NULL AS `record_id`, 
`name_code`, 
`web_site`, 
`genus`, 
`subgenus`, 
`species`, 
`infraspecies_parent_name_code`, 
`infraspecies`, 
`infraspecies_marker`, 
`author`, 
`accepted_name_code`, 
`comment`, 
`scrutiny_date`, 
`sp2000_status_id`, 
`database_id`, 
`specialist_id`, 
`family_id`, 
`specialist_code`, 
`family_code`, 
`is_accepted_name`, 
`GSDTaxonGUID`, 
`GSDNameGUID`, 
`is_extinct`,
`has_preholocene`, 
`has_modern`
FROM `scientific_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`common_names` SELECT 
NULL AS `record_id`, 
`name_code`, 
`common_name`, 
`transliteration`, 
`language`, 
`country`, 
`area`, 
NULL AS `reference_id`, 
`database_id`, 
`is_infraspecies`, 
`reference_code`
FROM  `common_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`distribution` SELECT 
NULL AS `record_id`, 
`name_code`, 
`distribution`, 
`StandardInUse`, 
`DistributionStatus`,
`database_id`
FROM  `distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`lifezone` SELECT 
NULL AS `record_id`,
`name_code`, 	
`lifezone`,
`database_id`
FROM  `lifezone`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_name_references` SELECT 
NULL AS `record_id`,
`name_code`,	
`reference_type`, 	
NULL AS `reference_id`,	
`reference_code`,
`database_id`
FROM  `scientific_name_references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`references` SELECT 
NULL AS `record_id`, 
`author`, 
`year`, 
`title`, 
`source`, 
`database_id`, 
`reference_code`
FROM  `references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`specialists` SELECT 
NULL AS `record_id`,
`specialist_name`,
`specialist_code`,
`database_id`
FROM  `specialists`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Transformations Completed.
<pre>
</pre><hr><b>Chain completed</b>
</body></html>
