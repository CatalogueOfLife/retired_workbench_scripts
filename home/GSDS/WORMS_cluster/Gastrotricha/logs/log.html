<html><body>
<br><b>Harvesting...</b>
<pre>
</pre><hr><b>File format conversions...</b>
<pre>
Unzipping
Archive:  WoRMS_Gastrotricha.zip
  inflating: AcceptedSpecies.txt     
  inflating: AcceptedInfraSpecificTaxa.txt  
  inflating: Synonyms.txt            
  inflating: CommonNames.txt         
  inflating: Distribution.txt        
  inflating: References.txt          
  inflating: NameReferencesLinks.txt  
  inflating: SourceDatabase.txt      
Skipping format conversion
</pre><hr><b>Creating buffer database, performing structural transformations...</b>
<pre>
<pre>
Initiating buffer creation - this may take a while depending on size of the dataset...

Creating buffer database Buffer_Gastrotricha in schema as provided by Gastrotricha
--------------
DROP DATABASE IF EXISTS Buffer_Gastrotricha
--------------

--------------
CREATE DATABASE IF NOT EXISTS Buffer_Gastrotricha
--------------

--------------
CREATE TABLE `AcceptedInfraSpecificTaxa` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`ParentSpeciesID` varchar(50) default NULL,
`InfraSpeciesEpithet` varchar(50) default NULL,
`InfraSpecificAuthorString` varchar(50) default NULL,
`InfraSpecificMarker` varchar(10) default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`InfraSpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI`  varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `AcceptedSpecies` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`Kingdom` varchar(50) default NULL,
`Phylum` varchar(50) default NULL,
`Class` varchar(50) default NULL,
`Order` varchar(50) default NULL,
`Superfamily` varchar(50) default NULL,
`Family` varchar(50) default NULL,
`Genus` varchar(50) default NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) default NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`SpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `CommonNames` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`CommonName` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Transliteration` varchar(255) default NULL,
`Language` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Country`  varchar(255) default NULL,
`Area`  varchar(255) default NULL,
`ReferenceID` varchar(50) default NULL,
PRIMARY KEY (`record_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `Distribution` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Distribution` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`StandardInUse` varchar(50) default NULL,
`DistributionStatus` varchar(50) default NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `References` (
`ReferenceID` varchar(50) PRIMARY KEY,
`Authors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Year` varchar(255) default NULL,
`Title` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Details` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `NameReferencesLinks` (
`ID` integer(10) PRIMARY KEY,
`ReferenceType` varchar(50) default NULL,
`ReferenceID` varchar(50) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `SourceDatabase` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`DatabaseFullName` varchar(255) NOT NULL,
`DatabaseShortName` varchar(50) NOT NULL,
`DatabaseVersion` varchar(50) NOT NULL,
`ReleaseDate` varchar(50) NOT NULL,
`AuthorsEditors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`TaxonomicCoverage` varchar(255) NOT NULL,
`GroupNameInEnglish` varchar(255) NOT NULL,
`Abstract` text  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Organisation` varchar(255) NOT NULL,
`HomeURL` varchar(255) default NULL,
`Coverage` varchar(50) default NULL,
`Completeness` integer(3) default NULL,
`Confidence` integer(1) default NULL,
`LogoFileName`  varchar(255) default NULL,
`ContactPerson` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `Synonyms` (
`ID` integer(10) PRIMARY KEY,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Genus` varchar(50) NOT NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) NOT NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`InfraSpecies` varchar(50) default NULL,
`InfraSpecificMarker` varchar(50) default NULL,
`InfraSpecificAuthorString`  varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`GSDNameGUI` varchar(255) default NULL 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedInfraSpecificTaxa.txt' INTO TABLE `AcceptedInfraSpecificTaxa` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES 
(`AcceptedTaxonID`, `ParentSpeciesID`, `InfraSpeciesEpithet`, `InfraSpecificAuthorString`,  `InfraSpecificMarker`, `GSDNameStatus`,  `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `InfraSpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedSpecies.txt' INTO TABLE `AcceptedSpecies` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Kingdom`, `Phylum`, `Class`, `Order`, `Superfamily`, `Family`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `SpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'CommonNames.txt' INTO TABLE `CommonNames` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `CommonName`, `Transliteration`, `Country`, `Area`, `Language`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Distribution.txt' INTO TABLE `Distribution` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Distribution`, `StandardInUse`, `DistributionStatus`)
--------------

--------------
LOAD DATA LOCAL INFILE 'NameReferencesLinks.txt' INTO TABLE NameReferencesLinks CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `ReferenceType`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'References.txt' INTO TABLE `References` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ReferenceID`, `Authors`, `Year`, `Title`, `Details`)
--------------

--------------
LOAD DATA LOCAL INFILE 'SourceDatabase.txt' INTO TABLE `SourceDatabase` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`DatabaseFullName`, `DatabaseShortName`, `DatabaseVersion`, `ReleaseDate`, `AuthorsEditors`, `TaxonomicCoverage`, `GroupNameInEnglish`, `Abstract`, `Organisation`, `HomeURL`, `Coverage`, `Completeness`, `Confidence`, `LogoFileName`, `ContactPerson`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Synonyms.txt' INTO TABLE `Synonyms` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `AcceptedTaxonID`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `InfraSpecies`, `InfraSpecificMarker`, `InfraSpecificAuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `GSDNameGUI`)
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



Initial database created. Creating database Assembly_Gastrotricha in assembly schema
--------------
DROP DATABASE IF EXISTS Assembly_Gastrotricha
--------------

--------------
CREATE DATABASE IF NOT EXISTS Assembly_Gastrotricha
--------------

--------------
DROP TABLE IF EXISTS `databases`
--------------

--------------
CREATE TABLE  `databases` (
  `database_name_displayed` varchar(125) DEFAULT NULL,
  `record_id` int(10) NOT NULL AUTO_INCREMENT,
  `database_name` varchar(150) DEFAULT NULL,
  `database_full_name` varchar(100) NOT NULL DEFAULT '',
  `web_site` longtext,
  `organization` longtext,
  `contact_person` varchar(255) DEFAULT NULL,
  `taxa` varchar(255) DEFAULT NULL,
  `taxonomic_coverage` longtext,
  `abstract` longtext,
  `version` varchar(255) DEFAULT NULL,
  `release_date` date DEFAULT '0000-00-00',
  `SpeciesCount` int(11) DEFAULT 0,
  `SpeciesEst` int(11) DEFAULT 0,
  `authors_editors` longtext,
  `accepted_species_names` int(10) DEFAULT 0,
  `accepted_infraspecies_names` int(10) DEFAULT 0,
  `species_synonyms` int(10) DEFAULT 0,
  `infraspecies_synonyms` int(10) DEFAULT 0,
  `common_names` int(10) DEFAULT 0,
  `total_names` int(10) DEFAULT 0,
  `is_new` tinyint(1) NOT NULL DEFAULT 0,
  `coverage` varchar(45) DEFAULT NULL,
  `completeness` int(3) unsigned DEFAULT 0,
  `confidence` 	tinyint(1) unsigned DEFAULT 0,
  PRIMARY KEY (`record_id`),
  KEY `database_name` (`database_name`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `families`
--------------

--------------
CREATE TABLE  `families` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `hierarchy_code` varchar(250) NOT NULL,
  `kingdom` varchar(50) NOT NULL DEFAULT 'Not Assigned',
  `phylum` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `class` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `order` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `family` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `superfamily` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  `family_code` varchar(50) NOT NULL,
  `is_accepted_name` int(1) unsigned,
  PRIMARY KEY (`record_id`),
  KEY (`family_code`),
  KEY `kingdom` (`kingdom`),
  KEY `phylum` (`phylum`),
  KEY `class` (`class`),
  KEY `order` (`order`),
  KEY `family` (`family`),
  KEY `superfamily` (`superfamily`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `sp2000_statuses`
--------------

--------------
CREATE TABLE  `sp2000_statuses` (
  `record_id` int(1) NOT NULL AUTO_INCREMENT,
  `sp2000_status` varchar(50) NOT NULL DEFAULT '',
  PRIMARY KEY (`record_id`)
) ENGINE=MyISAM
--------------

--------------
DROP TABLE IF EXISTS `scientific_names`
--------------

--------------
CREATE TABLE  `scientific_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `web_site` longtext,
  `genus` varchar(50) DEFAULT NULL,
  `subgenus` varchar(50) DEFAULT NULL,
  `species` varchar(60) DEFAULT NULL,
  `infraspecies_parent_name_code` varchar(42) DEFAULT NULL,
  `infraspecies` varchar(50) DEFAULT NULL,
  `infraspecies_marker` varchar(50) DEFAULT NULL,
  `author` varchar(100) DEFAULT NULL,
  `accepted_name_code` varchar(42) DEFAULT NULL,
  `comment` longtext,
  `scrutiny_date` text,
  `sp2000_status_id` int(1) DEFAULT NULL,
  `database_id` int(10) DEFAULT NULL,
  `specialist_id` int(10) DEFAULT NULL,
  `family_id` int(10) DEFAULT NULL,
  `specialist_code` varchar(50) DEFAULT NULL,
  `family_code` varchar(50) DEFAULT NULL,
  `is_accepted_name` int(1) DEFAULT NULL,
  `GSDTaxonGUID` longtext,
  `GSDNameGUID` longtext,
  `is_extinct` smallint(1) NOT NULL DEFAULT '0',
  `has_preholocene` smallint(1) NOT NULL DEFAULT '0',
  `has_modern` smallint(1) NOT NULL DEFAULT '1',
  PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `specialist_code` (`specialist_code`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `common_names`
--------------

--------------
CREATE TABLE  `common_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `common_name` varchar(700) NOT NULL,
  `transliteration` varchar(700),
  `language` varchar(25) NOT NULL,
  `country` varchar(44) NOT NULL DEFAULT '',
  `area` varchar(50) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `database_id` int(10) NOT NULL,
  `is_infraspecies` int(1) NOT NULL DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `common_name` (`common_name`),
  KEY `reference_code` (`reference_code`),
  KEY `name_code` (`name_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `distribution`
--------------

--------------
CREATE TABLE  `distribution` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `distribution` longtext,
  `StandardInUse` varchar(255) DEFAULT NULL,
  
   `DistributionStatus` varchar(255),
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `lifezone`
--------------

--------------
CREATE TABLE  `lifezone` (
  `record_id` int(11) NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42),
  `lifezone` varchar(255),
  `database_id` int(10),
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `scientific_name_references`
--------------

--------------
CREATE TABLE  `scientific_name_references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `reference_type` varchar(10) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`,`reference_id`,`reference_type`),
  KEY `reference_code` (`reference_code`),
  KEY `name_code_2` (`name_code`,`reference_type`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `references`
--------------

--------------
CREATE TABLE  `references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `author` varchar(200) DEFAULT NULL,
  `year` varchar(50) DEFAULT NULL,
  `title` longtext,
  `source` longtext,
  `database_id` int(10) NOT NULL,
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `reference_code` (`reference_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `specialists`
--------------

--------------
CREATE TABLE  `specialists` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `specialist_name` varchar(255) NOT NULL DEFAULT '',
  `specialist_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `specialist_code` (`specialist_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
INSERT INTO `sp2000_statuses` 
VALUES (1,'accepted name'),
(2,'ambiguous synonym'),
(3,'misapplied name'),
(4,'provisionally accepted name'),
(5,'synonym')
--------------

--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Creation of the assembly database completed.

Starting structural transformations (ACEF3 to ACI)
--------------
SET @dbid = 122
--------------

--------------
SET @dbabbr = 'W-Gtr-'
--------------

--------------
SET @dbtouse = 'Buffer_Gastrotricha'
--------------

--------------
UPDATE `databases` SET `taxonomic_coverage`="Animalia - Gastrotricha", `is_new` = 2, `taxa`="Gastrotrichs or hairy backs", `coverage`="Global", `completeness` = 100, `confidence` = 5
--------------

--------------
SET foreign_key_checks = 0
--------------

--------------
TRUNCATE TABLE `databases`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `databases`
 SELECT
 CONCAT(`DatabaseShortName`, ': ', `DatabaseFullName`)  AS `database_name_displayed`,
 @dbid AS `record_id`,
 `DatabaseShortName` AS `database_name`,
 `DatabaseFullName` AS `database_full_name`,
  `HomeURL` AS `web_site`,
  `Organisation` AS `organization`,
  `ContactPerson` AS `contact_person`,
  `GroupNameInEnglish` AS `taxa`,
  `TaxonomicCoverage` AS `taxonomic_coverage`,
  `Abstract` AS `abstract`,
  `DatabaseVersion` AS `version`,
  `ReleaseDate` AS `release_date`,
  `Coverage` AS `SpeciesCount`,
  `Completeness` AS `SpeciesEst`,
  `AuthorsEditors` AS `authors_editors`,
  NULL AS `accepted_species_names`,
  NULL AS `accepted_infraspecies_names`,
  NULL AS `species_synonyms`,
  NULL AS `infraspecies_synonyms`,
  NULL AS `common_names`,
  NULL AS `total_names`,
  NULL AS `is_new`,
  NULL AS `coverage`,
  NULL AS `completeness`,
  NULL AS `confidence`
  FROM ",
@dbtouse,
".`SourceDatabase`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `distribution`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `distribution`
 SELECT
 NULL AS `record_id`,
 CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
 `Distribution` AS `distribution`,
 `StandardInUse` AS `StandardInUse`,
 `DistributionStatus` AS `DistributionStatus`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`Distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `families`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `families`
SELECT DISTINCT
NULL AS `record_id`,
NULL AS `hierarchy_code`,
`Kingdom` AS `kingdom`,
`Phylum` AS `phylum`,
`Class` AS `class`,
`Order` AS `order`,
`Family` AS `family`,
`Superfamily` AS `superfamily`,
@dbid AS `database_id`,
NULL AS `family_code`,
NULL AS `is_accepted_name`
FROM ",
@dbtouse,
".`AcceptedSpecies`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `families` SET `family_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `specialists`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `specialists`
SELECT DISTINCT
NULL  AS `record_id`,
`LTSSpecialist` AS `specialist_name`,
NULL AS `specialist_code`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LTSSpecialist` IS NOT NULL OR
`LTSSpecialist` != ''")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `specialists` SET `specialist_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `scientific_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`SpeciesURL` AS `web_site`,
`Genus` AS `genus`,
`SubGenusName` AS `subgenus`,
`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
NULL  AS `infraspecies`,
NULL  AS `infraspecies_marker`,
`AuthorString` AS `author`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `accepted_name_code`,
`AdditionalData` AS `comment`,
`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
`specialists`.`record_id` AS `specialist_id`,
`families`.`record_id` AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
`families`.`family_code` AS `family_code`,
1 AS `is_accepted_name`,
`GSDTaxonGUI` AS `GSDTaxonGUI`,
`GSDNameGUI` AS `GSDNameGUI`,
`IsFossil` AS `is_extinct`,
`IsFossil` AS `has_preholocene`,
if (`IsFossil` = 0, 1, 0) AS `has_modern`
FROM ",
@dbtouse,
".`AcceptedSpecies` AcceptedSpecies
LEFT OUTER JOIN `families` ON
(`AcceptedSpecies`.`Kingdom` = `families`.`kingdom` AND
`AcceptedSpecies`.`Phylum` = `families`.`phylum` AND
`AcceptedSpecies`.`Class` = `families`.`class` AND
`AcceptedSpecies`.`Order` = `families`.`order` AND
`AcceptedSpecies`.`Superfamily` = `families`.`superfamily` AND
`AcceptedSpecies`.`Family` = `families`.`family`)
LEFT OUTER JOIN `specialists` ON
`AcceptedSpecies`.`LTSSpecialist` = `specialists`.`specialist_name`
LEFT OUTER JOIN `sp2000_statuses` ON
`AcceptedSpecies`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `lifezone`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `lifezone`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`LifeZone` AS `lifezone`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LifeZone` IN('marine','freshwater','Marine','Freshwater')")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `name_code`,
NULL AS `web_site`,
`sn`.`genus` AS `genus`,
NULL AS `subgenus`,
`sn`.`species` AS `species`,
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) AS `infraspecies_parent_name_code`,
`AIT`.`InfraSpeciesEpithet` AS `infraspecies`,
`AIT`.`InfraSpecificMarker` AS `infraspecies_marker`,
`AIT`.`InfraSpecificAuthorString` AS `author`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `accepted_name_code`,
`AIT`.`AdditionalData` AS `comment`,
`AIT`.`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
sn.family_code AS `family_code`,
1 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`AIT`.`GSDNameGUI` AS `GSDNameGUI`,
0 AS `is_extinct`,
0 AS `has_preholocene`,
1 AS `has_modern`
FROM ",
@dbtouse,
".`AcceptedInfraSpecificTaxa` AIT
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`AIT`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`
LEFT OUTER JOIN `specialists` ON
`AIT`.`LTSSpecialist` = `specialists`.`specialist_name`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`Synonyms`.`ID`) AS `name_code`,
NULL AS `web_site`,
`Synonyms`.`Genus` AS `genus`,
`Synonyms`.`SubGenusName` AS `subgenus`,
`Synonyms`.`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
`Synonyms`.`InfraSpecies` AS `infraspecies`,
`Synonyms`.`InfraSpecificMarker` AS `infraspecies_marker`,
`Synonyms`.`AuthorString` AS `author`,
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) AS `accepted_name_code`,
NULL AS `comment`,
NULL AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
sn.`specialist_code` AS `specialist_code`,
sn.`family_code` AS `family_code`,
0 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`Synonyms`.`GSDNameGUI` AS `GSDNameGUI` ,
0 AS `is_extinct`,
0 AS `has_preholocene`,
1 AS `has_modern`
FROM ",
@dbtouse,
".`Synonyms` Synonyms
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`Synonyms`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `common_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `common_names`
SELECT
NULL,
CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
CONVERT(`CommonName` USING utf8) AS `common_name`,
`Transliteration` AS `transliteration`,
`Language` AS `language`,
`Country` AS `country`,
`Area` AS `area`,
 NULL AS `reference_ID`,
@dbid AS `database_ID`,
 NULL AS `is_infraspecies`,
 `ReferenceID` AS `reference_code`
 FROM ",
@dbtouse,
".`CommonNames`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `references`
SELECT
NULL AS `record_id`,
`Authors` AS `author`,
`Year` AS `year`,
NULL AS `title`,
`Title` AS `source`,
@dbid AS `database_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`
 FROM ",
@dbtouse,
".`References`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `scientific_name_references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_name_references`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr, `ID`) AS `name_code`,
`ReferenceType` AS `reference_type`,
NULL AS `reference_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`NameReferencesLinks`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET foreign_key_checks = 1
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Data Loaded.
</pre>
</pre><hr><b>Backing up...</b>
<pre>
Creating directory  22_58_04_05Oct2015
Backing up files
</pre><hr><b>Executing local editorial checks</b>
<pre>
<pre>
Integrity and editorial checks - this may take a while depending on size of the dataset...

Starting local editorial transformations
--------------
DELETE FROM `common_names` WHERE `common_name` IS NULL OR `common_name` = ""
--------------

--------------
DELETE FROM `distribution` WHERE `distribution` IS NULL OR `distribution` = ""
--------------

--------------
DELETE FROM `references` WHERE (`title` IS NULL OR `title` = "") AND (`author` IS NULL OR `author` = "")
--------------

--------------
DELETE FROM `specialists` WHERE `specialist_name` IS NULL OR `specialist_name` = ""
--------------

--------------
DELETE FROM `scientific_names` WHERE (`species` IS NULL OR `species` LIKE "%sp.%" OR `species` LIKE "%spp.%") AND `infraspecies` IS NULL
--------------

--------------
DELETE FROM `scientific_names` WHERE `genus` IS NULL OR `genus` = "" OR genus like "% %" OR `genus` LIKE '%sp.%' OR `genus` LIKE "%spp.%"
--------------

--------------
UPDATE `scientific_names` SET `family_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `specialist_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "forma" WHERE `infraspecies_marker` LIKE "f.%"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "var." WHERE `infraspecies_marker` LIKE "Variety"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "subsp." WHERE `infraspecies_marker` LIKE "Subspecies"
--------------

--------------
UPDATE `scientific_names` SET `sp2000_status_id` = 5 WHERE `sp2000_status_id` IS NULL AND `is_accepted_name` = 0
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE `family` LIKE "% %"
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE `order` LIKE "% %"
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE `class` LIKE "% %"
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE `phylum` LIKE "% %"
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE `kingdom` LIKE "% %"
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE (`family` IS NULL OR `family` = '')
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE (`order` IS NULL OR `order` = '')
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE (`class` IS NULL OR `class` = '')
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE (`phylum` IS NULL OR `phylum` = '')
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE (`kingdom` IS NULL OR `kingdom` = '')
--------------

--------------
UPDATE `families` SET `hierarchy_code` = CONCAT(`kingdom`,'-',`phylum`,'-',`class`,'-',`order`,'-',`family`)
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "subsequent type designation%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "Nom%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "taxonomy source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "additional source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "original description%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "source of synonymy%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "basis of record%"
--------------

--------------
UPDATE `databases` SET database_name_displayed = REPLACE(database_name_displayed,'_',' ')
--------------

--------------
UPDATE `databases` SET database_name = REPLACE(database_name,'_',' ')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ',', '')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ';', ',')
--------------

--------------
SELECT "Misspelt infraspecies (no subgenus): ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND 
(`subgenus` IS NULL OR `subgenus` = '') AND 
`infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%')
--------------

--------------
SELECT "Misspelt infraspecies (with subgenus): ", `name_code`, `genus`, `subgenus`, `species`, `infraspecies` FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND 
`subgenus` != '' AND 
(`infraspecies` NOT LIKE CONCAT(`genus`, ' (', `subgenus`, ') ', `species`, '%') OR `infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%'))
--------------

--------------
DELETE FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND 
(`subgenus` IS NULL OR `subgenus` = '') AND 
`infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%')
--------------

--------------
DELETE FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND 
`subgenus` != '' AND 
(`infraspecies` NOT LIKE CONCAT(`genus`, ' (', `subgenus`, ') ', `species`, '%') OR `infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%'))
--------------

--------------
SELECT "Incorrect infraspecies: ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %'  AND 
`infraspecies` NOT LIKE 'f.%' AND 
`infraspecies` NOT LIKE 'var.%' AND
`infraspecies` NOT LIKE 'subsp.%'
--------------

--------------
DELETE FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %'  AND 
`infraspecies` NOT LIKE 'f.%' AND 
`infraspecies` NOT LIKE 'var.%' AND
`infraspecies` NOT LIKE 'subsp.%'
--------------

--------------
SELECT "Infraspecies starting with marker: ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names` 
WHERE `infraspecies` LIKE '% %' AND 
(`infraspecies` LIKE 'f.%' OR 
`infraspecies` LIKE 'var.%' OR
`infraspecies` LIKE 'subsp.%')
--------------

Infraspecies starting with marker: 	name_code	genus	species	infraspecies
Infraspecies starting with marker: 	W-Gtr-378314	Lepidochaetus	zelinkai	var. bernensis
Infraspecies starting with marker: 	W-Gtr-765307	Dactylopodola	cornuta	var. brevis
Infraspecies starting with marker: 	W-Gtr-765275	Polymerurus	nodicaudus	var. comatus
Infraspecies starting with marker: 	W-Gtr-378313	Lepidochaetus	zelinkai	var. fujisanensis
Infraspecies starting with marker: 	W-Gtr-378312	Lepidochaetus	zelinkai	var. gallicus
Infraspecies starting with marker: 	W-Gtr-378311	Lepidochaetus	zelinkai	var. graecensis
Infraspecies starting with marker: 	W-Gtr-378310	Chaetonotus	multispinosus	var. minor
--------------
UPDATE `scientific_names` SET `infraspecies` = SUBSTRING_INDEX(`infraspecies`, ' ', -1)
WHERE `infraspecies` LIKE '% %' AND 
(`infraspecies` LIKE 'f.%' OR 
`infraspecies` LIKE 'var.%' OR
`infraspecies` LIKE 'subsp.%')
--------------

--------------
SELECT "Infraspecies mismatch (infraspecies_parent_name_code set but infraspecies empty): ", `name_code`, `infraspecies_parent_name_code` FROM `scientific_names` 
WHERE CHAR_LENGTH(`infraspecies_parent_name_code`) > 1 AND 
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
SELECT "Infraspecies mismatch (infraspecies_marker set but infraspecies empty): ", `name_code`, `infraspecies_marker` FROM `scientific_names` 
WHERE CHAR_LENGTH(`infraspecies_marker`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
DELETE FROM `scientific_names` 
WHERE CHAR_LENGTH(`infraspecies_parent_name_code`) > 1 AND 
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
DELETE FROM `scientific_names` 
WHERE CHAR_LENGTH(`infraspecies_marker`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
UPDATE `scientific_names` SET `species` = LOWER(`species`)
--------------

--------------
SELECT "Empty species name: ", `name_code`, `genus`, `infraspecies` FROM `scientific_names` 
WHERE `species` = '' OR `species` IS NULL
--------------

--------------
DELETE FROM `scientific_names` 
WHERE `species` = '' OR `species` IS NULL
--------------

--------------
SELECT "Empty reference: ", `author`, `year`, `reference_code` FROM `references` 
WHERE (`title` = '' OR `title` IS NULL) AND
(`source` = '' OR `source` IS NULL)
--------------

--------------
DELETE FROM `references` 
WHERE (`title` = '' OR `title` IS NULL) AND
(`source` = '' OR `source` IS NULL)
--------------

--------------
UPDATE `scientific_names` SET `scrutiny_date` = DATE_FORMAT(`scrutiny_date`, '%d-%b-%Y')
WHERE `scrutiny_date` LIKE '%:%' AND
(`scrutiny_date` != '' OR `scrutiny_date` IS NOT NULL)
--------------

--------------
SELECT "Set is_infraspecies flag: ", t1.`name_code`, t1.`common_name`, t2.`genus`, t2.`species`, t2.`infraspecies` 
FROM `common_names` AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.`name_code` = t2.`name_code` 
WHERE (t2.`infraspecies` != '' OR t2.`infraspecies` IS NOT NULL) AND
t1.`is_infraspecies` = 0
--------------

--------------
UPDATE `common_names` AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.`name_code` = t2.`name_code` 
SET t1.`is_infraspecies` = 1
WHERE (t2.`infraspecies` != '' OR t2.`infraspecies` IS NOT NULL) AND
t1.`is_infraspecies` = 0
--------------

--------------
UPDATE `scientific_names` SET `author` = TRIM(`author`)
--------------

--------------
UPDATE `references`  SET `author` = TRIM(`author`)
--------------

--------------
SELECT "Duplicate accepted names:", sn.name_code, sn.sp2000_status_id, dups.genus, dups.subgenus, dups.species, dups.infraspecies_marker, dups.infraspecies, dups.author 
FROM 
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt 
	FROM scientific_names 
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups 
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author 
WHERE sn.sp2000_status_id = 1
--------------

--------------
SELECT "Accepted name to be retained", MAX(name_code), genus, subgenus, species, infraspecies_marker, infraspecies, author 
FROM
	(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, dups.species AS species, 
		dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author 
	FROM 
		(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt 
		FROM scientific_names 
		GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups 
	LEFT JOIN scientific_names sn
	ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2 
GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author
--------------

--------------
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, 
	dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author 
FROM 
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt 
	FROM scientific_names 
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups 
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author 
WHERE sn.sp2000_status_id = 1 AND sn.name_code NOT IN 
	(SELECT dups3.namecodes_to_keep FROM
		(SELECT MAX(name_code) AS namecodes_to_keep, genus, subgenus, species, infraspecies_marker, infraspecies, author 
		FROM
			(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, 
				dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author 
			FROM 	
				(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
				FROM scientific_names
				GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
		LEFT JOIN scientific_names sn
		ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2 
GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
SELECT 'Common name without parent accepted name', t1.record_id, t1.common_name, t1.name_code FROM common_names AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
CREATE TEMPORARY TABLE scientific_names_tmp 
(PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `specialist_code` (`specialist_code`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`))
SELECT * FROM scientific_names
--------------

--------------
SELECT 'Missing parent accepted name for synonym', record_id, name_code, genus, subgenus, species, infraspecies, accepted_name_code FROM scientific_names
WHERE is_accepted_name != 1 AND family_code IS NULL
--------------

--------------
SELECT 'Missing parent accepted name for infraspecies', record_id, name_code, genus, subgenus, species, infraspecies, infraspecies_parent_name_code 
FROM scientific_names 
WHERE LENGTH(infraspecies) > 1 AND family_code IS NULL
--------------

--------------
SELECT 'Lifezone without parent accepted name', t1.record_id, t1.name_code, t1.lifezone FROM lifezone AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
SELECT 'Distribution without parent accepted name', t1.record_id, t1.name_code, t1.distribution FROM distribution AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
SELECT 'Accepted name without parent family', t1.record_id, t1.name_code, t1.genus, t1.subgenus, t1.species, t1.infraspecies, t1.family_code 
FROM scientific_names AS t1
LEFT JOIN families AS t2 ON t1.family_code = t2.family_code
WHERE t2.family_code IS NULL
--------------

--------------
SELECT 'Reference link to non-existing accepted name', t1.record_id, t1.reference_code, t1.name_code 
FROM scientific_name_references AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

Reference link to non-existing accepted name	record_id	reference_code	name_code
Reference link to non-existing accepted name	17	W-Gtr-43080	W-Gtr-114559
Reference link to non-existing accepted name	47	W-Gtr-663	W-Gtr-114699
Reference link to non-existing accepted name	67	W-Gtr-1318	W-Gtr-265280
Reference link to non-existing accepted name	70	W-Gtr-125740	W-Gtr-265290
Reference link to non-existing accepted name	117	W-Gtr-1318	W-Gtr-267988
Reference link to non-existing accepted name	219	W-Gtr-1318	W-Gtr-265428
Reference link to non-existing accepted name	308	W-Gtr-1318	W-Gtr-265250
Reference link to non-existing accepted name	332	W-Gtr-1318	W-Gtr-265493
Reference link to non-existing accepted name	353	W-Gtr-125740	W-Gtr-378178
Reference link to non-existing accepted name	414	W-Gtr-1318	W-Gtr-265253
Reference link to non-existing accepted name	436	W-Gtr-1318	W-Gtr-265523
Reference link to non-existing accepted name	494	W-Gtr-1318	W-Gtr-265320
Reference link to non-existing accepted name	517	W-Gtr-1318	W-Gtr-266005
Reference link to non-existing accepted name	550	W-Gtr-43070	W-Gtr-114577
Reference link to non-existing accepted name	558	W-Gtr-663	W-Gtr-154561
Reference link to non-existing accepted name	590	W-Gtr-1318	W-Gtr-265508
Reference link to non-existing accepted name	612	W-Gtr-125740	W-Gtr-378202
Reference link to non-existing accepted name	644	W-Gtr-1318	W-Gtr-265304
Reference link to non-existing accepted name	670	W-Gtr-1318	W-Gtr-266006
Reference link to non-existing accepted name	671	W-Gtr-1318	W-Gtr-267978
Reference link to non-existing accepted name	726	W-Gtr-125740	W-Gtr-265391
Reference link to non-existing accepted name	735	W-Gtr-125740	W-Gtr-265492
Reference link to non-existing accepted name	748	W-Gtr-1318	W-Gtr-267987
Reference link to non-existing accepted name	749	W-Gtr-125740	W-Gtr-378082
Reference link to non-existing accepted name	752	W-Gtr-125740	W-Gtr-378217
Reference link to non-existing accepted name	775	W-Gtr-1318	W-Gtr-265249
Reference link to non-existing accepted name	824	W-Gtr-1318	W-Gtr-265307
Reference link to non-existing accepted name	864	W-Gtr-1354	W-Gtr-114627
Reference link to non-existing accepted name	866	W-Gtr-1318	W-Gtr-265384
Reference link to non-existing accepted name	896	W-Gtr-1318	W-Gtr-265401
Reference link to non-existing accepted name	899	W-Gtr-1318	W-Gtr-265435
Reference link to non-existing accepted name	906	W-Gtr-125740	W-Gtr-265535
Reference link to non-existing accepted name	913	W-Gtr-1318	W-Gtr-265962
Reference link to non-existing accepted name	984	W-Gtr-43068	W-Gtr-247799
Reference link to non-existing accepted name	1004	W-Gtr-1318	W-Gtr-267981
--------------
SELECT 'Reference link to non-existing reference', t1.record_id, t1.reference_code, t1.name_code 
FROM scientific_name_references AS t1
LEFT JOIN `references` AS t2 ON t1.reference_code = t2.reference_code
WHERE t2.reference_code IS NULL
--------------

Reference link to non-existing reference	record_id	reference_code	name_code
Reference link to non-existing reference	1	W-Gtr-43068	W-Gtr-114473
Reference link to non-existing reference	6	W-Gtr-1318	W-Gtr-114500
Reference link to non-existing reference	7	W-Gtr-1318	W-Gtr-114501
Reference link to non-existing reference	8	W-Gtr-125740	W-Gtr-114509
Reference link to non-existing reference	11	W-Gtr-1318	W-Gtr-114515
Reference link to non-existing reference	15	W-Gtr-1318	W-Gtr-114550
Reference link to non-existing reference	16	W-Gtr-1318	W-Gtr-114551
Reference link to non-existing reference	20	W-Gtr-1318	W-Gtr-114565
Reference link to non-existing reference	29	W-Gtr-1318	W-Gtr-114600
Reference link to non-existing reference	30	W-Gtr-1318	W-Gtr-114601
Reference link to non-existing reference	31	W-Gtr-125740	W-Gtr-114609
Reference link to non-existing reference	32	W-Gtr-125740	W-Gtr-114610
Reference link to non-existing reference	34	W-Gtr-1318	W-Gtr-114615
Reference link to non-existing reference	39	W-Gtr-1318	W-Gtr-114650
Reference link to non-existing reference	40	W-Gtr-1318	W-Gtr-114651
Reference link to non-existing reference	41	W-Gtr-125740	W-Gtr-114659
Reference link to non-existing reference	48	W-Gtr-1318	W-Gtr-114700
Reference link to non-existing reference	49	W-Gtr-125740	W-Gtr-154536
Reference link to non-existing reference	51	W-Gtr-125740	W-Gtr-247791
Reference link to non-existing reference	52	W-Gtr-125740	W-Gtr-247792
Reference link to non-existing reference	53	W-Gtr-1318	W-Gtr-247797
Reference link to non-existing reference	54	W-Gtr-43068	W-Gtr-247805
Reference link to non-existing reference	55	W-Gtr-43068	W-Gtr-247806
Reference link to non-existing reference	56	W-Gtr-43068	W-Gtr-247820
Reference link to non-existing reference	57	W-Gtr-125740	W-Gtr-247827
Reference link to non-existing reference	58	W-Gtr-1318	W-Gtr-247832
Reference link to non-existing reference	59	W-Gtr-1318	W-Gtr-247833
Reference link to non-existing reference	60	W-Gtr-125740	W-Gtr-265225
Reference link to non-existing reference	61	W-Gtr-1318	W-Gtr-265230
Reference link to non-existing reference	62	W-Gtr-1318	W-Gtr-265231
Reference link to non-existing reference	63	W-Gtr-125740	W-Gtr-265239
Reference link to non-existing reference	64	W-Gtr-125740	W-Gtr-265240
Reference link to non-existing reference	65	W-Gtr-1318	W-Gtr-265245
Reference link to non-existing reference	66	W-Gtr-125740	W-Gtr-265275
Reference link to non-existing reference	67	W-Gtr-1318	W-Gtr-265280
Reference link to non-existing reference	68	W-Gtr-1318	W-Gtr-265281
Reference link to non-existing reference	69	W-Gtr-125740	W-Gtr-265289
Reference link to non-existing reference	70	W-Gtr-125740	W-Gtr-265290
Reference link to non-existing reference	71	W-Gtr-1318	W-Gtr-265295
Reference link to non-existing reference	72	W-Gtr-125740	W-Gtr-265325
Reference link to non-existing reference	73	W-Gtr-1318	W-Gtr-265330
Reference link to non-existing reference	74	W-Gtr-1318	W-Gtr-265331
Reference link to non-existing reference	75	W-Gtr-125740	W-Gtr-265339
Reference link to non-existing reference	76	W-Gtr-125740	W-Gtr-265340
Reference link to non-existing reference	77	W-Gtr-1318	W-Gtr-265345
Reference link to non-existing reference	78	W-Gtr-125740	W-Gtr-265375
Reference link to non-existing reference	79	W-Gtr-1318	W-Gtr-265380
Reference link to non-existing reference	80	W-Gtr-1318	W-Gtr-265381
Reference link to non-existing reference	81	W-Gtr-125740	W-Gtr-265389
Reference link to non-existing reference	82	W-Gtr-125740	W-Gtr-265390
Reference link to non-existing reference	83	W-Gtr-1318	W-Gtr-265395
Reference link to non-existing reference	84	W-Gtr-125740	W-Gtr-265425
Reference link to non-existing reference	85	W-Gtr-1318	W-Gtr-265430
Reference link to non-existing reference	86	W-Gtr-1318	W-Gtr-265431
Reference link to non-existing reference	87	W-Gtr-125740	W-Gtr-265439
Reference link to non-existing reference	88	W-Gtr-125740	W-Gtr-265440
Reference link to non-existing reference	89	W-Gtr-1318	W-Gtr-265445
Reference link to non-existing reference	90	W-Gtr-125740	W-Gtr-265475
Reference link to non-existing reference	91	W-Gtr-1318	W-Gtr-265480
Reference link to non-existing reference	92	W-Gtr-1318	W-Gtr-265481
Reference link to non-existing reference	93	W-Gtr-125740	W-Gtr-265489
Reference link to non-existing reference	94	W-Gtr-125740	W-Gtr-265490
Reference link to non-existing reference	95	W-Gtr-1318	W-Gtr-265495
Reference link to non-existing reference	96	W-Gtr-125740	W-Gtr-265525
Reference link to non-existing reference	97	W-Gtr-1318	W-Gtr-265530
Reference link to non-existing reference	98	W-Gtr-1318	W-Gtr-265531
Reference link to non-existing reference	99	W-Gtr-125740	W-Gtr-265539
Reference link to non-existing reference	100	W-Gtr-125740	W-Gtr-265540
Reference link to non-existing reference	101	W-Gtr-1318	W-Gtr-265545
Reference link to non-existing reference	103	W-Gtr-125740	W-Gtr-265575
Reference link to non-existing reference	104	W-Gtr-1318	W-Gtr-265580
Reference link to non-existing reference	105	W-Gtr-1318	W-Gtr-265581
Reference link to non-existing reference	106	W-Gtr-125740	W-Gtr-265589
Reference link to non-existing reference	107	W-Gtr-125740	W-Gtr-265590
Reference link to non-existing reference	108	W-Gtr-1318	W-Gtr-265595
Reference link to non-existing reference	110	W-Gtr-125740	W-Gtr-265825
Reference link to non-existing reference	111	W-Gtr-125740	W-Gtr-265826
Reference link to non-existing reference	112	W-Gtr-1318	W-Gtr-265830
Reference link to non-existing reference	113	W-Gtr-1318	W-Gtr-265916
Reference link to non-existing reference	114	W-Gtr-1318	W-Gtr-265931
Reference link to non-existing reference	115	W-Gtr-125740	W-Gtr-265940
Reference link to non-existing reference	116	W-Gtr-125740	W-Gtr-266025
Reference link to non-existing reference	117	W-Gtr-1318	W-Gtr-267988
Reference link to non-existing reference	118	W-Gtr-1318	W-Gtr-267989
Reference link to non-existing reference	119	W-Gtr-125740	W-Gtr-346427
Reference link to non-existing reference	120	W-Gtr-125740	W-Gtr-378201
Reference link to non-existing reference	121	W-Gtr-125740	W-Gtr-378215
Reference link to non-existing reference	122	W-Gtr-125740	W-Gtr-378216
Reference link to non-existing reference	123	W-Gtr-125740	W-Gtr-378251
Reference link to non-existing reference	124	W-Gtr-125740	W-Gtr-378265
Reference link to non-existing reference	127	W-Gtr-125740	W-Gtr-378301
Reference link to non-existing reference	138	W-Gtr-1318	W-Gtr-114467
Reference link to non-existing reference	139	W-Gtr-125740	W-Gtr-114475
Reference link to non-existing reference	142	W-Gtr-1318	W-Gtr-114484
Reference link to non-existing reference	143	W-Gtr-1318	W-Gtr-114485
Reference link to non-existing reference	147	W-Gtr-1318	W-Gtr-114498
Reference link to non-existing reference	148	W-Gtr-125740	W-Gtr-114508
Reference link to non-existing reference	152	W-Gtr-125740	W-Gtr-114526
Reference link to non-existing reference	154	W-Gtr-1318	W-Gtr-114535
Reference link to non-existing reference	156	W-Gtr-1318	W-Gtr-114548
Reference link to non-existing reference	157	W-Gtr-1318	W-Gtr-114549
Reference link to non-existing reference	163	W-Gtr-125740	W-Gtr-114593
Reference link to non-existing reference	164	W-Gtr-125740	W-Gtr-114594
Reference link to non-existing reference	166	W-Gtr-125740	W-Gtr-114611
Reference link to non-existing reference	167	W-Gtr-1318	W-Gtr-114616
Reference link to non-existing reference	168	W-Gtr-1318	W-Gtr-114617
Reference link to non-existing reference	173	W-Gtr-1318	W-Gtr-114634
Reference link to non-existing reference	176	W-Gtr-125740	W-Gtr-114661
Reference link to non-existing reference	177	W-Gtr-125740	W-Gtr-114662
Reference link to non-existing reference	179	W-Gtr-1318	W-Gtr-114667
Reference link to non-existing reference	180	W-Gtr-125740	W-Gtr-114675
Reference link to non-existing reference	183	W-Gtr-1318	W-Gtr-114684
Reference link to non-existing reference	184	W-Gtr-1318	W-Gtr-114685
Reference link to non-existing reference	187	W-Gtr-1318	W-Gtr-114702
Reference link to non-existing reference	188	W-Gtr-1318	W-Gtr-247798
Reference link to non-existing reference	189	W-Gtr-43068	W-Gtr-247804
Reference link to non-existing reference	190	W-Gtr-125740	W-Gtr-247808
Reference link to non-existing reference	191	W-Gtr-43068	W-Gtr-247821
Reference link to non-existing reference	192	W-Gtr-125740	W-Gtr-247825
Reference link to non-existing reference	193	W-Gtr-125740	W-Gtr-247826
Reference link to non-existing reference	194	W-Gtr-1318	W-Gtr-265228
Reference link to non-existing reference	195	W-Gtr-1318	W-Gtr-265229
Reference link to non-existing reference	196	W-Gtr-1318	W-Gtr-265246
Reference link to non-existing reference	197	W-Gtr-125740	W-Gtr-265256
Reference link to non-existing reference	198	W-Gtr-125740	W-Gtr-265273
Reference link to non-existing reference	199	W-Gtr-125740	W-Gtr-265274
Reference link to non-existing reference	200	W-Gtr-1318	W-Gtr-265279
Reference link to non-existing reference	201	W-Gtr-125740	W-Gtr-265291
Reference link to non-existing reference	202	W-Gtr-1318	W-Gtr-265296
Reference link to non-existing reference	203	W-Gtr-1318	W-Gtr-265297
Reference link to non-existing reference	204	W-Gtr-1318	W-Gtr-265314
Reference link to non-existing reference	205	W-Gtr-125740	W-Gtr-265324
Reference link to non-existing reference	206	W-Gtr-125740	W-Gtr-265338
Reference link to non-existing reference	207	W-Gtr-125740	W-Gtr-265341
Reference link to non-existing reference	208	W-Gtr-125740	W-Gtr-265342
Reference link to non-existing reference	209	W-Gtr-1318	W-Gtr-265347
Reference link to non-existing reference	210	W-Gtr-125740	W-Gtr-265355
Reference link to non-existing reference	211	W-Gtr-1318	W-Gtr-265364
Reference link to non-existing reference	212	W-Gtr-1318	W-Gtr-265365
Reference link to non-existing reference	213	W-Gtr-1318	W-Gtr-265378
Reference link to non-existing reference	214	W-Gtr-125740	W-Gtr-265388
Reference link to non-existing reference	215	W-Gtr-125740	W-Gtr-265392
Reference link to non-existing reference	216	W-Gtr-125740	W-Gtr-265406
Reference link to non-existing reference	217	W-Gtr-1318	W-Gtr-265415
Reference link to non-existing reference	218	W-Gtr-125740	W-Gtr-265423
Reference link to non-existing reference	219	W-Gtr-1318	W-Gtr-265428
Reference link to non-existing reference	220	W-Gtr-1318	W-Gtr-265429
Reference link to non-existing reference	221	W-Gtr-1318	W-Gtr-265432
Reference link to non-existing reference	222	W-Gtr-1318	W-Gtr-265446
Reference link to non-existing reference	223	W-Gtr-125740	W-Gtr-265456
Reference link to non-existing reference	224	W-Gtr-125740	W-Gtr-265473
Reference link to non-existing reference	225	W-Gtr-125740	W-Gtr-265474
Reference link to non-existing reference	226	W-Gtr-1318	W-Gtr-265479
Reference link to non-existing reference	227	W-Gtr-125740	W-Gtr-265491
Reference link to non-existing reference	228	W-Gtr-1318	W-Gtr-265496
Reference link to non-existing reference	229	W-Gtr-1318	W-Gtr-265497
Reference link to non-existing reference	230	W-Gtr-1318	W-Gtr-265514
Reference link to non-existing reference	231	W-Gtr-125740	W-Gtr-265524
Reference link to non-existing reference	232	W-Gtr-125740	W-Gtr-265541
Reference link to non-existing reference	233	W-Gtr-125740	W-Gtr-265542
Reference link to non-existing reference	234	W-Gtr-1318	W-Gtr-265547
Reference link to non-existing reference	235	W-Gtr-125740	W-Gtr-265559
Reference link to non-existing reference	236	W-Gtr-1318	W-Gtr-265564
Reference link to non-existing reference	237	W-Gtr-1318	W-Gtr-265565
Reference link to non-existing reference	238	W-Gtr-1318	W-Gtr-265582
Reference link to non-existing reference	240	W-Gtr-125740	W-Gtr-265592
Reference link to non-existing reference	241	W-Gtr-125740	W-Gtr-265606
Reference link to non-existing reference	242	W-Gtr-125740	W-Gtr-265609
Reference link to non-existing reference	243	W-Gtr-1318	W-Gtr-265914
Reference link to non-existing reference	244	W-Gtr-125740	W-Gtr-265941
Reference link to non-existing reference	245	W-Gtr-125740	W-Gtr-265942
Reference link to non-existing reference	246	W-Gtr-1318	W-Gtr-266033
Reference link to non-existing reference	247	W-Gtr-1318	W-Gtr-267986
Reference link to non-existing reference	248	W-Gtr-125740	W-Gtr-378181
Reference link to non-existing reference	249	W-Gtr-125740	W-Gtr-378182
Reference link to non-existing reference	250	W-Gtr-125740	W-Gtr-378199
Reference link to non-existing reference	251	W-Gtr-125740	W-Gtr-378232
Reference link to non-existing reference	252	W-Gtr-125740	W-Gtr-378249
Reference link to non-existing reference	253	W-Gtr-125740	W-Gtr-378250
Reference link to non-existing reference	254	W-Gtr-125740	W-Gtr-378267
Reference link to non-existing reference	257	W-Gtr-125740	W-Gtr-378300
Reference link to non-existing reference	265	W-Gtr-1318	W-Gtr-114477
Reference link to non-existing reference	267	W-Gtr-1318	W-Gtr-114502
Reference link to non-existing reference	268	W-Gtr-125740	W-Gtr-114504
Reference link to non-existing reference	269	W-Gtr-125740	W-Gtr-114522
Reference link to non-existing reference	270	W-Gtr-1318	W-Gtr-114527
Reference link to non-existing reference	273	W-Gtr-1318	W-Gtr-114552
Reference link to non-existing reference	275	W-Gtr-1318	W-Gtr-114556
Reference link to non-existing reference	278	W-Gtr-1318	W-Gtr-114570
Reference link to non-existing reference	280	W-Gtr-125740	W-Gtr-114572
Reference link to non-existing reference	285	W-Gtr-125740	W-Gtr-114590
Reference link to non-existing reference	287	W-Gtr-1318	W-Gtr-114620
Reference link to non-existing reference	290	W-Gtr-1318	W-Gtr-114638
Reference link to non-existing reference	291	W-Gtr-125740	W-Gtr-114640
Reference link to non-existing reference	293	W-Gtr-125740	W-Gtr-114658
Reference link to non-existing reference	294	W-Gtr-1318	W-Gtr-114663
Reference link to non-existing reference	296	W-Gtr-125740	W-Gtr-114683
Reference link to non-existing reference	299	W-Gtr-1318	W-Gtr-114706
Reference link to non-existing reference	300	W-Gtr-43068	W-Gtr-247800
Reference link to non-existing reference	301	W-Gtr-1318	W-Gtr-247802
Reference link to non-existing reference	302	W-Gtr-43068	W-Gtr-247807
Reference link to non-existing reference	303	W-Gtr-43068	W-Gtr-247811
Reference link to non-existing reference	304	W-Gtr-125740	W-Gtr-247822
Reference link to non-existing reference	305	W-Gtr-125740	W-Gtr-247829
Reference link to non-existing reference	307	W-Gtr-1318	W-Gtr-265232
Reference link to non-existing reference	308	W-Gtr-1318	W-Gtr-265250
Reference link to non-existing reference	309	W-Gtr-125740	W-Gtr-265252
Reference link to non-existing reference	310	W-Gtr-125740	W-Gtr-265270
Reference link to non-existing reference	311	W-Gtr-125740	W-Gtr-265277
Reference link to non-existing reference	312	W-Gtr-1318	W-Gtr-265293
Reference link to non-existing reference	313	W-Gtr-1318	W-Gtr-265300
Reference link to non-existing reference	314	W-Gtr-1318	W-Gtr-265318
Reference link to non-existing reference	315	W-Gtr-125740	W-Gtr-265334
Reference link to non-existing reference	316	W-Gtr-1318	W-Gtr-265343
Reference link to non-existing reference	317	W-Gtr-1318	W-Gtr-265357
Reference link to non-existing reference	318	W-Gtr-1318	W-Gtr-265361
Reference link to non-existing reference	319	W-Gtr-1318	W-Gtr-265368
Reference link to non-existing reference	320	W-Gtr-1318	W-Gtr-265382
Reference link to non-existing reference	321	W-Gtr-1318	W-Gtr-265386
Reference link to non-existing reference	322	W-Gtr-125740	W-Gtr-265402
Reference link to non-existing reference	323	W-Gtr-1318	W-Gtr-265407
Reference link to non-existing reference	324	W-Gtr-125740	W-Gtr-265409
Reference link to non-existing reference	325	W-Gtr-1318	W-Gtr-265411
Reference link to non-existing reference	326	W-Gtr-125740	W-Gtr-265413
Reference link to non-existing reference	327	W-Gtr-1318	W-Gtr-265436
Reference link to non-existing reference	328	W-Gtr-1318	W-Gtr-265450
Reference link to non-existing reference	329	W-Gtr-125740	W-Gtr-265452
Reference link to non-existing reference	330	W-Gtr-125740	W-Gtr-265470
Reference link to non-existing reference	331	W-Gtr-125740	W-Gtr-265477
Reference link to non-existing reference	332	W-Gtr-1318	W-Gtr-265493
Reference link to non-existing reference	333	W-Gtr-1318	W-Gtr-265500
Reference link to non-existing reference	334	W-Gtr-1318	W-Gtr-265518
Reference link to non-existing reference	335	W-Gtr-125740	W-Gtr-265520
Reference link to non-existing reference	336	W-Gtr-125740	W-Gtr-265538
Reference link to non-existing reference	337	W-Gtr-1318	W-Gtr-265543
Reference link to non-existing reference	338	W-Gtr-125740	W-Gtr-265563
Reference link to non-existing reference	339	W-Gtr-1318	W-Gtr-265568
Reference link to non-existing reference	341	W-Gtr-125740	W-Gtr-265588
Reference link to non-existing reference	342	W-Gtr-125740	W-Gtr-265602
Reference link to non-existing reference	343	W-Gtr-1318	W-Gtr-265611
Reference link to non-existing reference	344	W-Gtr-1318	W-Gtr-265836
Reference link to non-existing reference	345	W-Gtr-1318	W-Gtr-265850
Reference link to non-existing reference	346	W-Gtr-125740	W-Gtr-265852
Reference link to non-existing reference	347	W-Gtr-1318	W-Gtr-265854
Reference link to non-existing reference	348	W-Gtr-1318	W-Gtr-265904
Reference link to non-existing reference	349	W-Gtr-1318	W-Gtr-265918
Reference link to non-existing reference	350	W-Gtr-1318	W-Gtr-265968
Reference link to non-existing reference	351	W-Gtr-1318	W-Gtr-267976
Reference link to non-existing reference	352	W-Gtr-1318	W-Gtr-267990
Reference link to non-existing reference	353	W-Gtr-125740	W-Gtr-378178
Reference link to non-existing reference	354	W-Gtr-125740	W-Gtr-378185
Reference link to non-existing reference	355	W-Gtr-125740	W-Gtr-378203
Reference link to non-existing reference	356	W-Gtr-125740	W-Gtr-378228
Reference link to non-existing reference	357	W-Gtr-125740	W-Gtr-378246
Reference link to non-existing reference	358	W-Gtr-125740	W-Gtr-378253
Reference link to non-existing reference	359	W-Gtr-125740	W-Gtr-378296
Reference link to non-existing reference	360	W-Gtr-125740	W-Gtr-378310
Reference link to non-existing reference	361	W-Gtr-125740	W-Gtr-378314
Reference link to non-existing reference	374	W-Gtr-1318	W-Gtr-114492
Reference link to non-existing reference	375	W-Gtr-125740	W-Gtr-114503
Reference link to non-existing reference	377	W-Gtr-1318	W-Gtr-114507
Reference link to non-existing reference	379	W-Gtr-125740	W-Gtr-114537
Reference link to non-existing reference	383	W-Gtr-1318	W-Gtr-114558
Reference link to non-existing reference	384	W-Gtr-43068	W-Gtr-114566
Reference link to non-existing reference	385	W-Gtr-125740	W-Gtr-114567
Reference link to non-existing reference	386	W-Gtr-1318	W-Gtr-114573
Reference link to non-existing reference	390	W-Gtr-1318	W-Gtr-114592
Reference link to non-existing reference	395	W-Gtr-125740	W-Gtr-114637
Reference link to non-existing reference	396	W-Gtr-125740	W-Gtr-114652
Reference link to non-existing reference	398	W-Gtr-125740	W-Gtr-114654
Reference link to non-existing reference	403	W-Gtr-1318	W-Gtr-114692
Reference link to non-existing reference	404	W-Gtr-125740	W-Gtr-114701
Reference link to non-existing reference	407	W-Gtr-43068	W-Gtr-247813
Reference link to non-existing reference	408	W-Gtr-1318	W-Gtr-247824
Reference link to non-existing reference	409	W-Gtr-1318	W-Gtr-247839
Reference link to non-existing reference	410	W-Gtr-1318	W-Gtr-265223
Reference link to non-existing reference	411	W-Gtr-1318	W-Gtr-265236
Reference link to non-existing reference	412	W-Gtr-1318	W-Gtr-265238
Reference link to non-existing reference	413	W-Gtr-125740	W-Gtr-265247
Reference link to non-existing reference	414	W-Gtr-1318	W-Gtr-265253
Reference link to non-existing reference	415	W-Gtr-1318	W-Gtr-265272
Reference link to non-existing reference	416	W-Gtr-125740	W-Gtr-265283
Reference link to non-existing reference	417	W-Gtr-1318	W-Gtr-265287
Reference link to non-existing reference	418	W-Gtr-125740	W-Gtr-265298
Reference link to non-existing reference	419	W-Gtr-1318	W-Gtr-265323
Reference link to non-existing reference	420	W-Gtr-125740	W-Gtr-265332
Reference link to non-existing reference	421	W-Gtr-1318	W-Gtr-265336
Reference link to non-existing reference	422	W-Gtr-1318	W-Gtr-265353
Reference link to non-existing reference	423	W-Gtr-1318	W-Gtr-265372
Reference link to non-existing reference	424	W-Gtr-125740	W-Gtr-265383
Reference link to non-existing reference	425	W-Gtr-1318	W-Gtr-265387
Reference link to non-existing reference	426	W-Gtr-125740	W-Gtr-265398
Reference link to non-existing reference	427	W-Gtr-125740	W-Gtr-265417
Reference link to non-existing reference	428	W-Gtr-1318	W-Gtr-265438
Reference link to non-existing reference	429	W-Gtr-125740	W-Gtr-265447
Reference link to non-existing reference	430	W-Gtr-1318	W-Gtr-265453
Reference link to non-existing reference	431	W-Gtr-1318	W-Gtr-265472
Reference link to non-existing reference	432	W-Gtr-125740	W-Gtr-265483
Reference link to non-existing reference	433	W-Gtr-1318	W-Gtr-265487
Reference link to non-existing reference	434	W-Gtr-125740	W-Gtr-265498
Reference link to non-existing reference	435	W-Gtr-125740	W-Gtr-265517
Reference link to non-existing reference	436	W-Gtr-1318	W-Gtr-265523
Reference link to non-existing reference	437	W-Gtr-125740	W-Gtr-265532
Reference link to non-existing reference	438	W-Gtr-1318	W-Gtr-265572
Reference link to non-existing reference	440	W-Gtr-1318	W-Gtr-265574
Reference link to non-existing reference	442	W-Gtr-125740	W-Gtr-265583
Reference link to non-existing reference	443	W-Gtr-1318	W-Gtr-265587
Reference link to non-existing reference	444	W-Gtr-1318	W-Gtr-265908
Reference link to non-existing reference	445	W-Gtr-125740	W-Gtr-265932
Reference link to non-existing reference	446	W-Gtr-1318	W-Gtr-265972
Reference link to non-existing reference	447	W-Gtr-1318	W-Gtr-266023
Reference link to non-existing reference	448	W-Gtr-1318	W-Gtr-267980
Reference link to non-existing reference	449	W-Gtr-1318	W-Gtr-267997
Reference link to non-existing reference	450	W-Gtr-125740	W-Gtr-378174
Reference link to non-existing reference	452	W-Gtr-125740	W-Gtr-378208
Reference link to non-existing reference	453	W-Gtr-125740	W-Gtr-378223
Reference link to non-existing reference	454	W-Gtr-125740	W-Gtr-378257
Reference link to non-existing reference	456	W-Gtr-125740	W-Gtr-378259
Reference link to non-existing reference	457	W-Gtr-125740	W-Gtr-378274
Reference link to non-existing reference	458	W-Gtr-125740	W-Gtr-378308
Reference link to non-existing reference	466	W-Gtr-1318	W-Gtr-114474
Reference link to non-existing reference	467	W-Gtr-1318	W-Gtr-114491
Reference link to non-existing reference	469	W-Gtr-125740	W-Gtr-114519
Reference link to non-existing reference	477	W-Gtr-1318	W-Gtr-114657
Reference link to non-existing reference	479	W-Gtr-1318	W-Gtr-114674
Reference link to non-existing reference	481	W-Gtr-125740	W-Gtr-154563
Reference link to non-existing reference	482	W-Gtr-43068	W-Gtr-247814
Reference link to non-existing reference	483	W-Gtr-125740	W-Gtr-247815
Reference link to non-existing reference	486	W-Gtr-125740	W-Gtr-247819
Reference link to non-existing reference	487	W-Gtr-1318	W-Gtr-247838
Reference link to non-existing reference	488	W-Gtr-125740	W-Gtr-265216
Reference link to non-existing reference	489	W-Gtr-1318	W-Gtr-265222
Reference link to non-existing reference	490	W-Gtr-125740	W-Gtr-265233
Reference link to non-existing reference	491	W-Gtr-125740	W-Gtr-265263
Reference link to non-existing reference	492	W-Gtr-1318	W-Gtr-265286
Reference link to non-existing reference	493	W-Gtr-1318	W-Gtr-265303
Reference link to non-existing reference	494	W-Gtr-1318	W-Gtr-265320
Reference link to non-existing reference	495	W-Gtr-1318	W-Gtr-265337
Reference link to non-existing reference	496	W-Gtr-125740	W-Gtr-265348
Reference link to non-existing reference	497	W-Gtr-1318	W-Gtr-265354
Reference link to non-existing reference	498	W-Gtr-1318	W-Gtr-265371
Reference link to non-existing reference	499	W-Gtr-125740	W-Gtr-265399
Reference link to non-existing reference	500	W-Gtr-1318	W-Gtr-265405
Reference link to non-existing reference	501	W-Gtr-125740	W-Gtr-265416
Reference link to non-existing reference	502	W-Gtr-1318	W-Gtr-265422
Reference link to non-existing reference	503	W-Gtr-125740	W-Gtr-265433
Reference link to non-existing reference	504	W-Gtr-125740	W-Gtr-265467
Reference link to non-existing reference	505	W-Gtr-125740	W-Gtr-265484
Reference link to non-existing reference	506	W-Gtr-1318	W-Gtr-265507
Reference link to non-existing reference	507	W-Gtr-1318	W-Gtr-265537
Reference link to non-existing reference	508	W-Gtr-1318	W-Gtr-265554
Reference link to non-existing reference	509	W-Gtr-1318	W-Gtr-265571
Reference link to non-existing reference	510	W-Gtr-125740	W-Gtr-265599
Reference link to non-existing reference	511	W-Gtr-1318	W-Gtr-265605
Reference link to non-existing reference	512	W-Gtr-1318	W-Gtr-265839
Reference link to non-existing reference	513	W-Gtr-1318	W-Gtr-265856
Reference link to non-existing reference	514	W-Gtr-1318	W-Gtr-265907
Reference link to non-existing reference	515	W-Gtr-125740	W-Gtr-265952
Reference link to non-existing reference	516	W-Gtr-125740	W-Gtr-265999
Reference link to non-existing reference	517	W-Gtr-1318	W-Gtr-266005
Reference link to non-existing reference	518	W-Gtr-1318	W-Gtr-266022
Reference link to non-existing reference	519	W-Gtr-1318	W-Gtr-267979
Reference link to non-existing reference	520	W-Gtr-125740	W-Gtr-378175
Reference link to non-existing reference	521	W-Gtr-125740	W-Gtr-378192
Reference link to non-existing reference	522	W-Gtr-125740	W-Gtr-378209
Reference link to non-existing reference	523	W-Gtr-125740	W-Gtr-378226
Reference link to non-existing reference	524	W-Gtr-125740	W-Gtr-378239
Reference link to non-existing reference	526	W-Gtr-125740	W-Gtr-378243
Reference link to non-existing reference	527	W-Gtr-125740	W-Gtr-378256
Reference link to non-existing reference	528	W-Gtr-125740	W-Gtr-378273
Reference link to non-existing reference	529	W-Gtr-125740	W-Gtr-378290
Reference link to non-existing reference	530	W-Gtr-125740	W-Gtr-378307
Reference link to non-existing reference	539	W-Gtr-1318	W-Gtr-114471
Reference link to non-existing reference	540	W-Gtr-1318	W-Gtr-114494
Reference link to non-existing reference	541	W-Gtr-125740	W-Gtr-114516
Reference link to non-existing reference	543	W-Gtr-1318	W-Gtr-114528
Reference link to non-existing reference	544	W-Gtr-125740	W-Gtr-114539
Reference link to non-existing reference	547	W-Gtr-125740	W-Gtr-114546
Reference link to non-existing reference	548	W-Gtr-43068	W-Gtr-114560
Reference link to non-existing reference	554	W-Gtr-43068	W-Gtr-114660
Reference link to non-existing reference	555	W-Gtr-1318	W-Gtr-114671
Reference link to non-existing reference	557	W-Gtr-43068	W-Gtr-114694
Reference link to non-existing reference	560	W-Gtr-1318	W-Gtr-247796
Reference link to non-existing reference	561	W-Gtr-1318	W-Gtr-247803
Reference link to non-existing reference	562	W-Gtr-125740	W-Gtr-247812
Reference link to non-existing reference	563	W-Gtr-1318	W-Gtr-265215
Reference link to non-existing reference	564	W-Gtr-1318	W-Gtr-265217
Reference link to non-existing reference	565	W-Gtr-125740	W-Gtr-265226
Reference link to non-existing reference	566	W-Gtr-1318	W-Gtr-265244
Reference link to non-existing reference	567	W-Gtr-1318	W-Gtr-265251
Reference link to non-existing reference	568	W-Gtr-125740	W-Gtr-265260
Reference link to non-existing reference	569	W-Gtr-125740	W-Gtr-265262
Reference link to non-existing reference	570	W-Gtr-1318	W-Gtr-265308
Reference link to non-existing reference	571	W-Gtr-1318	W-Gtr-265310
Reference link to non-existing reference	572	W-Gtr-125740	W-Gtr-265319
Reference link to non-existing reference	573	W-Gtr-125740	W-Gtr-265326
Reference link to non-existing reference	574	W-Gtr-1318	W-Gtr-265344
Reference link to non-existing reference	575	W-Gtr-1318	W-Gtr-265351
Reference link to non-existing reference	576	W-Gtr-125740	W-Gtr-265362
Reference link to non-existing reference	577	W-Gtr-1318	W-Gtr-265374
Reference link to non-existing reference	578	W-Gtr-125740	W-Gtr-265396
Reference link to non-existing reference	579	W-Gtr-1318	W-Gtr-265408
Reference link to non-existing reference	580	W-Gtr-1318	W-Gtr-265410
Reference link to non-existing reference	581	W-Gtr-125740	W-Gtr-265419
Reference link to non-existing reference	582	W-Gtr-125740	W-Gtr-265426
Reference link to non-existing reference	583	W-Gtr-1318	W-Gtr-265444
Reference link to non-existing reference	584	W-Gtr-1318	W-Gtr-265451
Reference link to non-existing reference	585	W-Gtr-125740	W-Gtr-265460
Reference link to non-existing reference	586	W-Gtr-125740	W-Gtr-265462
Reference link to non-existing reference	590	W-Gtr-1318	W-Gtr-265508
Reference link to non-existing reference	591	W-Gtr-1318	W-Gtr-265510
Reference link to non-existing reference	592	W-Gtr-125740	W-Gtr-265519
Reference link to non-existing reference	593	W-Gtr-125740	W-Gtr-265526
Reference link to non-existing reference	594	W-Gtr-1318	W-Gtr-265544
Reference link to non-existing reference	595	W-Gtr-1318	W-Gtr-265551
Reference link to non-existing reference	596	W-Gtr-1318	W-Gtr-265553
Reference link to non-existing reference	597	W-Gtr-125740	W-Gtr-265555
Reference link to non-existing reference	598	W-Gtr-125740	W-Gtr-265560
Reference link to non-existing reference	599	W-Gtr-125740	W-Gtr-265562
Reference link to non-existing reference	601	W-Gtr-125740	W-Gtr-265596
Reference link to non-existing reference	602	W-Gtr-1318	W-Gtr-265608
Reference link to non-existing reference	603	W-Gtr-1318	W-Gtr-265610
Reference link to non-existing reference	604	W-Gtr-1318	W-Gtr-265851
Reference link to non-existing reference	605	W-Gtr-1318	W-Gtr-265910
Reference link to non-existing reference	606	W-Gtr-1318	W-Gtr-265917
Reference link to non-existing reference	607	W-Gtr-1318	W-Gtr-265951
Reference link to non-existing reference	608	W-Gtr-1318	W-Gtr-267982
Reference link to non-existing reference	609	W-Gtr-125740	W-Gtr-378172
Reference link to non-existing reference	610	W-Gtr-125740	W-Gtr-378193
Reference link to non-existing reference	611	W-Gtr-125740	W-Gtr-378195
Reference link to non-existing reference	612	W-Gtr-125740	W-Gtr-378202
Reference link to non-existing reference	613	W-Gtr-125740	W-Gtr-378229
Reference link to non-existing reference	614	W-Gtr-125740	W-Gtr-378236
Reference link to non-existing reference	615	W-Gtr-125740	W-Gtr-378238
Reference link to non-existing reference	620	W-Gtr-125740	W-Gtr-378295
Reference link to non-existing reference	621	W-Gtr-125740	W-Gtr-378302
Reference link to non-existing reference	628	W-Gtr-125740	W-Gtr-114469
Reference link to non-existing reference	629	W-Gtr-1318	W-Gtr-114490
Reference link to non-existing reference	631	W-Gtr-1318	W-Gtr-114524
Reference link to non-existing reference	632	W-Gtr-1318	W-Gtr-114541
Reference link to non-existing reference	633	W-Gtr-125740	W-Gtr-114584
Reference link to non-existing reference	634	W-Gtr-1318	W-Gtr-114624
Reference link to non-existing reference	635	W-Gtr-1318	W-Gtr-114626
Reference link to non-existing reference	637	W-Gtr-1318	W-Gtr-114677
Reference link to non-existing reference	639	W-Gtr-125740	W-Gtr-154562
Reference link to non-existing reference	640	W-Gtr-1318	W-Gtr-265219
Reference link to non-existing reference	641	W-Gtr-1318	W-Gtr-265221
Reference link to non-existing reference	642	W-Gtr-1318	W-Gtr-265255
Reference link to non-existing reference	643	W-Gtr-125740	W-Gtr-265266
Reference link to non-existing reference	644	W-Gtr-1318	W-Gtr-265304
Reference link to non-existing reference	645	W-Gtr-1318	W-Gtr-265306
Reference link to non-existing reference	646	W-Gtr-125740	W-Gtr-265315
Reference link to non-existing reference	647	W-Gtr-1318	W-Gtr-265321
Reference link to non-existing reference	648	W-Gtr-125740	W-Gtr-265349
Reference link to non-existing reference	649	W-Gtr-125740	W-Gtr-265366
Reference link to non-existing reference	650	W-Gtr-1318	W-Gtr-265370
Reference link to non-existing reference	651	W-Gtr-125740	W-Gtr-265400
Reference link to non-existing reference	652	W-Gtr-1318	W-Gtr-265404
Reference link to non-existing reference	653	W-Gtr-1318	W-Gtr-265421
Reference link to non-existing reference	654	W-Gtr-125740	W-Gtr-265449
Reference link to non-existing reference	655	W-Gtr-1318	W-Gtr-265455
Reference link to non-existing reference	656	W-Gtr-1318	W-Gtr-265457
Reference link to non-existing reference	657	W-Gtr-125740	W-Gtr-265464
Reference link to non-existing reference	658	W-Gtr-125740	W-Gtr-265466
Reference link to non-existing reference	659	W-Gtr-1318	W-Gtr-265504
Reference link to non-existing reference	660	W-Gtr-1318	W-Gtr-265506
Reference link to non-existing reference	661	W-Gtr-125740	W-Gtr-265515
Reference link to non-existing reference	662	W-Gtr-1318	W-Gtr-265521
Reference link to non-existing reference	663	W-Gtr-1318	W-Gtr-265557
Reference link to non-existing reference	664	W-Gtr-125740	W-Gtr-265566
Reference link to non-existing reference	665	W-Gtr-1318	W-Gtr-265570
Reference link to non-existing reference	666	W-Gtr-1318	W-Gtr-265604
Reference link to non-existing reference	667	W-Gtr-1318	W-Gtr-265855
Reference link to non-existing reference	668	W-Gtr-1318	W-Gtr-265906
Reference link to non-existing reference	669	W-Gtr-125740	W-Gtr-266000
Reference link to non-existing reference	670	W-Gtr-1318	W-Gtr-266006
Reference link to non-existing reference	671	W-Gtr-1318	W-Gtr-267978
Reference link to non-existing reference	672	W-Gtr-125740	W-Gtr-378176
Reference link to non-existing reference	673	W-Gtr-125740	W-Gtr-378189
Reference link to non-existing reference	674	W-Gtr-125740	W-Gtr-378206
Reference link to non-existing reference	675	W-Gtr-125740	W-Gtr-378225
Reference link to non-existing reference	676	W-Gtr-125740	W-Gtr-378242
Reference link to non-existing reference	677	W-Gtr-125740	W-Gtr-378276
Reference link to non-existing reference	679	W-Gtr-125740	W-Gtr-378291
Reference link to non-existing reference	681	W-Gtr-125740	W-Gtr-378306
Reference link to non-existing reference	682	W-Gtr-42	W-Gtr-584800
Reference link to non-existing reference	695	W-Gtr-125740	W-Gtr-114476
Reference link to non-existing reference	697	W-Gtr-1318	W-Gtr-114499
Reference link to non-existing reference	699	W-Gtr-1318	W-Gtr-114534
Reference link to non-existing reference	700	W-Gtr-1318	W-Gtr-114602
Reference link to non-existing reference	701	W-Gtr-125740	W-Gtr-114612
Reference link to non-existing reference	703	W-Gtr-1318	W-Gtr-114635
Reference link to non-existing reference	704	W-Gtr-1318	W-Gtr-114649
Reference link to non-existing reference	705	W-Gtr-1318	W-Gtr-114666
Reference link to non-existing reference	708	W-Gtr-125740	W-Gtr-154538
Reference link to non-existing reference	711	W-Gtr-1318	W-Gtr-247817
Reference link to non-existing reference	712	W-Gtr-1318	W-Gtr-247830
Reference link to non-existing reference	713	W-Gtr-125740	W-Gtr-265224
Reference link to non-existing reference	714	W-Gtr-125740	W-Gtr-265241
Reference link to non-existing reference	715	W-Gtr-1318	W-Gtr-265261
Reference link to non-existing reference	716	W-Gtr-1318	W-Gtr-265278
Reference link to non-existing reference	717	W-Gtr-125740	W-Gtr-265288
Reference link to non-existing reference	718	W-Gtr-125740	W-Gtr-265305
Reference link to non-existing reference	719	W-Gtr-1318	W-Gtr-265311
Reference link to non-existing reference	720	W-Gtr-1318	W-Gtr-265328
Reference link to non-existing reference	721	W-Gtr-1318	W-Gtr-265329
Reference link to non-existing reference	722	W-Gtr-1318	W-Gtr-265346
Reference link to non-existing reference	723	W-Gtr-125740	W-Gtr-265356
Reference link to non-existing reference	724	W-Gtr-125740	W-Gtr-265373
Reference link to non-existing reference	725	W-Gtr-1318	W-Gtr-265379
Reference link to non-existing reference	726	W-Gtr-125740	W-Gtr-265391
Reference link to non-existing reference	727	W-Gtr-1318	W-Gtr-265397
Reference link to non-existing reference	728	W-Gtr-1318	W-Gtr-265414
Reference link to non-existing reference	729	W-Gtr-125740	W-Gtr-265441
Reference link to non-existing reference	730	W-Gtr-125740	W-Gtr-265442
Reference link to non-existing reference	731	W-Gtr-125740	W-Gtr-265459
Reference link to non-existing reference	732	W-Gtr-1318	W-Gtr-265465
Reference link to non-existing reference	733	W-Gtr-1318	W-Gtr-265478
Reference link to non-existing reference	734	W-Gtr-1318	W-Gtr-265482
Reference link to non-existing reference	735	W-Gtr-125740	W-Gtr-265492
Reference link to non-existing reference	736	W-Gtr-125740	W-Gtr-265509
Reference link to non-existing reference	737	W-Gtr-1318	W-Gtr-265529
Reference link to non-existing reference	738	W-Gtr-1318	W-Gtr-265546
Reference link to non-existing reference	739	W-Gtr-125740	W-Gtr-265556
Reference link to non-existing reference	740	W-Gtr-1318	W-Gtr-265579
Reference link to non-existing reference	741	W-Gtr-125740	W-Gtr-265591
Reference link to non-existing reference	742	W-Gtr-1318	W-Gtr-265597
Reference link to non-existing reference	743	W-Gtr-125740	W-Gtr-265909
Reference link to non-existing reference	744	W-Gtr-1318	W-Gtr-265915
Reference link to non-existing reference	745	W-Gtr-1318	W-Gtr-265933
Reference link to non-existing reference	746	W-Gtr-125740	W-Gtr-265960
Reference link to non-existing reference	747	W-Gtr-125740	W-Gtr-266024
Reference link to non-existing reference	748	W-Gtr-1318	W-Gtr-267987
Reference link to non-existing reference	749	W-Gtr-125740	W-Gtr-378082
Reference link to non-existing reference	750	W-Gtr-125740	W-Gtr-378200
Reference link to non-existing reference	751	W-Gtr-125740	W-Gtr-378214
Reference link to non-existing reference	752	W-Gtr-125740	W-Gtr-378217
Reference link to non-existing reference	753	W-Gtr-125740	W-Gtr-378218
Reference link to non-existing reference	754	W-Gtr-125740	W-Gtr-378231
Reference link to non-existing reference	755	W-Gtr-125740	W-Gtr-378264
Reference link to non-existing reference	756	W-Gtr-125740	W-Gtr-378281
Reference link to non-existing reference	757	W-Gtr-125740	W-Gtr-378299
Reference link to non-existing reference	766	W-Gtr-1318	W-Gtr-114569
Reference link to non-existing reference	767	W-Gtr-1318	W-Gtr-114603
Reference link to non-existing reference	769	W-Gtr-1318	W-Gtr-114698
Reference link to non-existing reference	770	W-Gtr-1318	W-Gtr-114703
Reference link to non-existing reference	771	W-Gtr-1318	W-Gtr-114705
Reference link to non-existing reference	772	W-Gtr-1318	W-Gtr-247794
Reference link to non-existing reference	773	W-Gtr-1318	W-Gtr-247801
Reference link to non-existing reference	774	W-Gtr-1318	W-Gtr-265242
Reference link to non-existing reference	775	W-Gtr-1318	W-Gtr-265249
Reference link to non-existing reference	776	W-Gtr-1318	W-Gtr-265276
Reference link to non-existing reference	777	W-Gtr-1318	W-Gtr-265285
Reference link to non-existing reference	778	W-Gtr-125740	W-Gtr-265292
Reference link to non-existing reference	779	W-Gtr-1318	W-Gtr-265376
Reference link to non-existing reference	780	W-Gtr-1318	W-Gtr-265385
Reference link to non-existing reference	781	W-Gtr-125740	W-Gtr-265394
Reference link to non-existing reference	782	W-Gtr-1318	W-Gtr-265485
Reference link to non-existing reference	783	W-Gtr-125740	W-Gtr-265494
Reference link to non-existing reference	784	W-Gtr-125740	W-Gtr-265528
Reference link to non-existing reference	785	W-Gtr-1318	W-Gtr-265576
Reference link to non-existing reference	786	W-Gtr-1318	W-Gtr-265585
Reference link to non-existing reference	788	W-Gtr-1318	W-Gtr-265912
Reference link to non-existing reference	789	W-Gtr-1318	W-Gtr-265978
Reference link to non-existing reference	790	W-Gtr-1318	W-Gtr-266021
Reference link to non-existing reference	791	W-Gtr-1318	W-Gtr-267984
Reference link to non-existing reference	792	W-Gtr-1318	W-Gtr-267993
Reference link to non-existing reference	793	W-Gtr-125740	W-Gtr-378197
Reference link to non-existing reference	794	W-Gtr-125740	W-Gtr-378204
Reference link to non-existing reference	795	W-Gtr-125740	W-Gtr-378227
Reference link to non-existing reference	798	W-Gtr-125740	W-Gtr-378261
Reference link to non-existing reference	799	W-Gtr-125740	W-Gtr-378263
Reference link to non-existing reference	800	W-Gtr-125740	W-Gtr-378270
Reference link to non-existing reference	801	W-Gtr-125740	W-Gtr-378297
Reference link to non-existing reference	802	W-Gtr-125740	W-Gtr-378304
Reference link to non-existing reference	808	W-Gtr-1318	W-Gtr-114513
Reference link to non-existing reference	811	W-Gtr-1318	W-Gtr-247795
Reference link to non-existing reference	812	W-Gtr-1318	W-Gtr-247809
Reference link to non-existing reference	813	W-Gtr-1318	W-Gtr-247834
Reference link to non-existing reference	814	W-Gtr-1318	W-Gtr-265218
Reference link to non-existing reference	815	W-Gtr-125740	W-Gtr-265220
Reference link to non-existing reference	816	W-Gtr-125740	W-Gtr-265234
Reference link to non-existing reference	817	W-Gtr-1318	W-Gtr-265243
Reference link to non-existing reference	818	W-Gtr-1318	W-Gtr-265257
Reference link to non-existing reference	819	W-Gtr-125740	W-Gtr-265259
Reference link to non-existing reference	820	W-Gtr-1318	W-Gtr-265268
Reference link to non-existing reference	821	W-Gtr-1318	W-Gtr-265282
Reference link to non-existing reference	822	W-Gtr-125740	W-Gtr-265284
Reference link to non-existing reference	823	W-Gtr-125740	W-Gtr-265302
Reference link to non-existing reference	824	W-Gtr-1318	W-Gtr-265307
Reference link to non-existing reference	825	W-Gtr-125740	W-Gtr-265309
Reference link to non-existing reference	826	W-Gtr-125740	W-Gtr-265327
Reference link to non-existing reference	827	W-Gtr-1318	W-Gtr-265350
Reference link to non-existing reference	828	W-Gtr-125740	W-Gtr-265377
Reference link to non-existing reference	829	W-Gtr-1318	W-Gtr-265393
Reference link to non-existing reference	830	W-Gtr-1318	W-Gtr-265418
Reference link to non-existing reference	831	W-Gtr-125740	W-Gtr-265420
Reference link to non-existing reference	832	W-Gtr-125740	W-Gtr-265434
Reference link to non-existing reference	833	W-Gtr-1318	W-Gtr-265443
Reference link to non-existing reference	834	W-Gtr-1318	W-Gtr-265461
Reference link to non-existing reference	835	W-Gtr-125740	W-Gtr-265463
Reference link to non-existing reference	836	W-Gtr-1318	W-Gtr-265468
Reference link to non-existing reference	837	W-Gtr-1318	W-Gtr-265486
Reference link to non-existing reference	838	W-Gtr-125740	W-Gtr-265502
Reference link to non-existing reference	839	W-Gtr-1318	W-Gtr-265511
Reference link to non-existing reference	840	W-Gtr-125740	W-Gtr-265513
Reference link to non-existing reference	841	W-Gtr-125740	W-Gtr-265527
Reference link to non-existing reference	842	W-Gtr-1318	W-Gtr-265536
Reference link to non-existing reference	843	W-Gtr-1318	W-Gtr-265550
Reference link to non-existing reference	844	W-Gtr-125740	W-Gtr-265552
Reference link to non-existing reference	845	W-Gtr-125740	W-Gtr-265577
Reference link to non-existing reference	846	W-Gtr-1318	W-Gtr-265593
Reference link to non-existing reference	847	W-Gtr-1318	W-Gtr-265600
Reference link to non-existing reference	848	W-Gtr-1318	W-Gtr-265911
Reference link to non-existing reference	849	W-Gtr-125740	W-Gtr-265913
Reference link to non-existing reference	850	W-Gtr-125740	W-Gtr-265970
Reference link to non-existing reference	851	W-Gtr-1318	W-Gtr-266004
Reference link to non-existing reference	852	W-Gtr-1318	W-Gtr-267983
Reference link to non-existing reference	853	W-Gtr-125740	W-Gtr-378196
Reference link to non-existing reference	854	W-Gtr-125740	W-Gtr-378210
Reference link to non-existing reference	855	W-Gtr-125740	W-Gtr-378221
Reference link to non-existing reference	856	W-Gtr-125740	W-Gtr-378235
Reference link to non-existing reference	857	W-Gtr-125740	W-Gtr-378260
Reference link to non-existing reference	858	W-Gtr-125740	W-Gtr-378278
Reference link to non-existing reference	859	W-Gtr-125740	W-Gtr-378289
Reference link to non-existing reference	860	W-Gtr-125740	W-Gtr-378303
Reference link to non-existing reference	866	W-Gtr-1318	W-Gtr-265384
Reference link to non-existing reference	867	W-Gtr-1318	W-Gtr-265427
Reference link to non-existing reference	868	W-Gtr-1318	W-Gtr-265534
Reference link to non-existing reference	869	W-Gtr-125740	W-Gtr-378205
Reference link to non-existing reference	870	W-Gtr-125740	W-Gtr-378212
Reference link to non-existing reference	871	W-Gtr-125740	W-Gtr-378219
Reference link to non-existing reference	872	W-Gtr-125740	W-Gtr-378255
Reference link to non-existing reference	873	W-Gtr-125740	W-Gtr-378262
Reference link to non-existing reference	874	W-Gtr-125740	W-Gtr-378269
Reference link to non-existing reference	875	W-Gtr-125740	W-Gtr-378305
Reference link to non-existing reference	876	W-Gtr-125740	W-Gtr-378312
Reference link to non-existing reference	883	W-Gtr-125740	W-Gtr-247823
Reference link to non-existing reference	884	W-Gtr-1318	W-Gtr-265235
Reference link to non-existing reference	885	W-Gtr-125740	W-Gtr-265237
Reference link to non-existing reference	886	W-Gtr-1318	W-Gtr-265265
Reference link to non-existing reference	887	W-Gtr-125740	W-Gtr-265267
Reference link to non-existing reference	888	W-Gtr-1318	W-Gtr-265269
Reference link to non-existing reference	889	W-Gtr-1318	W-Gtr-265294
Reference link to non-existing reference	890	W-Gtr-1318	W-Gtr-265299
Reference link to non-existing reference	891	W-Gtr-1318	W-Gtr-265333
Reference link to non-existing reference	892	W-Gtr-125740	W-Gtr-265335
Reference link to non-existing reference	893	W-Gtr-1318	W-Gtr-265358
Reference link to non-existing reference	894	W-Gtr-1318	W-Gtr-265367
Reference link to non-existing reference	895	W-Gtr-125740	W-Gtr-265369
Reference link to non-existing reference	896	W-Gtr-1318	W-Gtr-265401
Reference link to non-existing reference	897	W-Gtr-125740	W-Gtr-265403
Reference link to non-existing reference	898	W-Gtr-125740	W-Gtr-265412
Reference link to non-existing reference	899	W-Gtr-1318	W-Gtr-265435
Reference link to non-existing reference	900	W-Gtr-125740	W-Gtr-265437
Reference link to non-existing reference	901	W-Gtr-1318	W-Gtr-265469
Reference link to non-existing reference	902	W-Gtr-125740	W-Gtr-265471
Reference link to non-existing reference	903	W-Gtr-1318	W-Gtr-265499
Reference link to non-existing reference	904	W-Gtr-1318	W-Gtr-265503
Reference link to non-existing reference	905	W-Gtr-1318	W-Gtr-265533
Reference link to non-existing reference	906	W-Gtr-125740	W-Gtr-265535
Reference link to non-existing reference	907	W-Gtr-1318	W-Gtr-265558
Reference link to non-existing reference	908	W-Gtr-1318	W-Gtr-265567
Reference link to non-existing reference	909	W-Gtr-1318	W-Gtr-265601
Reference link to non-existing reference	910	W-Gtr-125740	W-Gtr-265603
Reference link to non-existing reference	911	W-Gtr-125740	W-Gtr-265612
Reference link to non-existing reference	912	W-Gtr-125740	W-Gtr-265837
Reference link to non-existing reference	913	W-Gtr-1318	W-Gtr-265962
Reference link to non-existing reference	914	W-Gtr-1318	W-Gtr-265967
Reference link to non-existing reference	915	W-Gtr-1318	W-Gtr-265971
Reference link to non-existing reference	916	W-Gtr-1318	W-Gtr-266001
Reference link to non-existing reference	917	W-Gtr-1318	W-Gtr-267975
Reference link to non-existing reference	918	W-Gtr-1318	W-Gtr-346421
Reference link to non-existing reference	919	W-Gtr-125740	W-Gtr-378179
Reference link to non-existing reference	920	W-Gtr-125740	W-Gtr-378188
Reference link to non-existing reference	921	W-Gtr-125740	W-Gtr-378213
Reference link to non-existing reference	922	W-Gtr-125740	W-Gtr-378222
Reference link to non-existing reference	923	W-Gtr-125740	W-Gtr-378252
Reference link to non-existing reference	924	W-Gtr-125740	W-Gtr-378311
Reference link to non-existing reference	928	W-Gtr-1318	W-Gtr-247840
Reference link to non-existing reference	929	W-Gtr-1318	W-Gtr-265254
Reference link to non-existing reference	930	W-Gtr-1318	W-Gtr-265271
Reference link to non-existing reference	931	W-Gtr-125740	W-Gtr-265316
Reference link to non-existing reference	932	W-Gtr-1318	W-Gtr-265322
Reference link to non-existing reference	933	W-Gtr-125740	W-Gtr-265448
Reference link to non-existing reference	934	W-Gtr-1318	W-Gtr-265454
Reference link to non-existing reference	935	W-Gtr-1318	W-Gtr-265488
Reference link to non-existing reference	936	W-Gtr-125740	W-Gtr-265516
Reference link to non-existing reference	937	W-Gtr-1318	W-Gtr-265522
Reference link to non-existing reference	938	W-Gtr-1318	W-Gtr-265905
Reference link to non-existing reference	939	W-Gtr-1318	W-Gtr-266007
Reference link to non-existing reference	940	W-Gtr-1318	W-Gtr-267977
Reference link to non-existing reference	941	W-Gtr-125740	W-Gtr-378173
Reference link to non-existing reference	942	W-Gtr-125740	W-Gtr-378190
Reference link to non-existing reference	943	W-Gtr-125740	W-Gtr-378207
Reference link to non-existing reference	944	W-Gtr-125740	W-Gtr-378224
Reference link to non-existing reference	945	W-Gtr-125740	W-Gtr-378275
Reference link to non-existing reference	946	W-Gtr-125740	W-Gtr-378309
Reference link to non-existing reference	958	W-Gtr-1318	W-Gtr-265248
Reference link to non-existing reference	959	W-Gtr-125740	W-Gtr-265258
Reference link to non-existing reference	960	W-Gtr-1318	W-Gtr-265312
Reference link to non-existing reference	961	W-Gtr-1318	W-Gtr-265313
Reference link to non-existing reference	962	W-Gtr-1318	W-Gtr-265363
Reference link to non-existing reference	963	W-Gtr-125740	W-Gtr-265458
Reference link to non-existing reference	964	W-Gtr-1318	W-Gtr-265512
Reference link to non-existing reference	965	W-Gtr-1318	W-Gtr-265548
Reference link to non-existing reference	966	W-Gtr-1318	W-Gtr-265549
Reference link to non-existing reference	967	W-Gtr-1318	W-Gtr-265598
Reference link to non-existing reference	968	W-Gtr-1318	W-Gtr-267985
Reference link to non-existing reference	969	W-Gtr-125740	W-Gtr-378183
Reference link to non-existing reference	970	W-Gtr-125740	W-Gtr-378184
Reference link to non-existing reference	971	W-Gtr-125740	W-Gtr-378198
Reference link to non-existing reference	972	W-Gtr-125740	W-Gtr-378233
Reference link to non-existing reference	973	W-Gtr-125740	W-Gtr-378234
Reference link to non-existing reference	974	W-Gtr-125740	W-Gtr-378248
Reference link to non-existing reference	975	W-Gtr-125740	W-Gtr-378284
Reference link to non-existing reference	976	W-Gtr-125740	W-Gtr-378298
Reference link to non-existing reference	984	W-Gtr-43068	W-Gtr-247799
Reference link to non-existing reference	985	W-Gtr-1318	W-Gtr-265301
Reference link to non-existing reference	986	W-Gtr-1318	W-Gtr-265360
Reference link to non-existing reference	987	W-Gtr-1318	W-Gtr-265424
Reference link to non-existing reference	988	W-Gtr-1318	W-Gtr-265969
Reference link to non-existing reference	989	W-Gtr-1318	W-Gtr-267998
Reference link to non-existing reference	990	W-Gtr-125740	W-Gtr-378177
Reference link to non-existing reference	991	W-Gtr-125740	W-Gtr-378186
Reference link to non-existing reference	992	W-Gtr-125740	W-Gtr-378211
Reference link to non-existing reference	993	W-Gtr-125740	W-Gtr-378220
Reference link to non-existing reference	994	W-Gtr-125740	W-Gtr-378313
Reference link to non-existing reference	1001	W-Gtr-1318	W-Gtr-265352
Reference link to non-existing reference	1002	W-Gtr-1318	W-Gtr-265359
Reference link to non-existing reference	1003	W-Gtr-1318	W-Gtr-267974
Reference link to non-existing reference	1004	W-Gtr-1318	W-Gtr-267981
Reference link to non-existing reference	1005	W-Gtr-125740	W-Gtr-378180
Reference link to non-existing reference	1006	W-Gtr-125740	W-Gtr-378187
Reference link to non-existing reference	1007	W-Gtr-125740	W-Gtr-378230
Reference link to non-existing reference	1008	W-Gtr-125740	W-Gtr-378237
Reference link to non-existing reference	1009	W-Gtr-125740	W-Gtr-378244
Reference link to non-existing reference	1010	W-Gtr-125740	W-Gtr-378294
--------------
SELECT 'Specialist not present in scientific names table', t1.record_id, t1.specialist_name, t1.specialist_code 
FROM specialists AS t1
LEFT JOIN scientific_names AS t2 ON t1.specialist_code = t2.specialist_code
WHERE t2.specialist_code IS NULL
--------------

--------------
SELECT 'Reference without parent accepted or common name', t1.record_id, t1.author, t1.year, t1.title, t1.reference_code 
FROM `references` AS t1
LEFT JOIN scientific_name_references AS t2 ON t1.reference_code = t2.reference_code
LEFT JOIN common_names AS t3 ON t1.reference_code = t3.reference_code
WHERE t2.reference_code IS NULL AND t3.reference_code IS NULL
--------------

Reference without parent accepted or common name	record_id	author	year	title	reference_code
Reference without parent accepted or common name	9	Hummon, W. D.; Balsamo, M.; Todaro, M. A.	1992	NULL	W-Gtr-43071
Reference without parent accepted or common name	11	Hummon,W.D.	2007	NULL	W-Gtr-43073
Reference without parent accepted or common name	12	Clausen, C.	2004	NULL	W-Gtr-43074
Reference without parent accepted or common name	14	Hummon, W. D.	1974	NULL	W-Gtr-43079
Reference without parent accepted or common name	16	Rao, G. C.; Clausen, C.	1970	NULL	W-Gtr-43081
Reference without parent accepted or common name	20	Hochberg.	2003	NULL	W-Gtr-128621
Reference without parent accepted or common name	21	Todaro.	2002	NULL	W-Gtr-131244
Reference without parent accepted or common name	23	Kisielewski, J.	1988	NULL	W-Gtr-163037
Reference without parent accepted or common name	25	Remane, A.	1927	NULL	W-Gtr-163111
Reference without parent accepted or common name	28	Gerlach, S. A.	1953	NULL	W-Gtr-163114
Reference without parent accepted or common name	29	Remane, A.	1951	NULL	W-Gtr-163115
Reference without parent accepted or common name	31	Mock, H.	1979	NULL	W-Gtr-163122
Reference without parent accepted or common name	32	Gagne, G. D.	1977	NULL	W-Gtr-163123
Reference without parent accepted or common name	44	Chang, C.C.Y.; Lee, J.M.; Clausen, C.	1998	NULL	W-Gtr-164942
Reference without parent accepted or common name	71	Brunson, R. B.	1950	NULL	W-Gtr-172685
Reference without parent accepted or common name	72	Kisielewski, J.	1981	NULL	W-Gtr-172686
Reference without parent accepted or common name	74	Weiss, M. J.	1988	NULL	W-Gtr-172834
Reference without parent accepted or common name	91	Clausen, C.	2004	NULL	W-Gtr-199640
Reference without parent accepted or common name	92	Hochberg, R.	2002	NULL	W-Gtr-199641
Reference without parent accepted or common name	95	Lee, J. M.& Chang, C. Y.	2002	NULL	W-Gtr-199645
Reference without parent accepted or common name	97	Lee, J. M., & Chang, C. Y.	2007	NULL	W-Gtr-199647
Reference without parent accepted or common name	102	Todaro, M. A., Bernhard, J. M., & Hummon, W. D.	2000	NULL	W-Gtr-199652
Reference without parent accepted or common name	104	Hochberg, R.	2005	NULL	W-Gtr-199654
Reference without parent accepted or common name	107	Nicholas, W. & Todaro, M. A.	2005	NULL	W-Gtr-199659
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
CREATE TEMPORARY TABLE duplicates_to_delete AS
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus,
	dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
FROM
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
	FROM scientific_names
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id
	HAVING cnt > 1) AS dups
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
WHERE sn.sp2000_status_id = 1 AND sn.name_code NOT IN
	(SELECT dups3.namecodes_to_keep FROM
		(SELECT MAX(name_code) AS namecodes_to_keep, genus, subgenus, species, infraspecies_marker, infraspecies, author FROM
			(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, dups.species AS species,
				dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
			FROM
				(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
				FROM scientific_names
				GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
			LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
			WHERE sn.sp2000_status_id = 1) AS dups2
		GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
DELETE QUICK FROM scientific_names
USING scientific_names
INNER JOIN duplicates_to_delete ON scientific_names.name_code = duplicates_to_delete.name_code
--------------

--------------
DELETE QUICK t1 FROM common_names AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.accepted_name_code = t2.name_code
WHERE t2.name_code IS NULL AND t1.is_accepted_name != 1
--------------

--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.infraspecies_parent_name_code = t2.name_code
WHERE t1.infraspecies_parent_name_code IS NOT NULL AND t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM lifezone AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
OPTIMIZE TABLE lifezone
--------------

Table	Op	Msg_type	Msg_text
Assembly_Gastrotricha.lifezone	optimize	status	OK
--------------
DELETE QUICK t1 FROM distribution AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
OPTIMIZE TABLE distribution
--------------

Table	Op	Msg_type	Msg_text
Assembly_Gastrotricha.distribution	optimize	status	OK
--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN families AS t2 ON t1.family_code = t2.family_code
WHERE t2.family_code IS NULL
--------------

--------------
OPTIMIZE TABLE scientific_names
--------------

Table	Op	Msg_type	Msg_text
Assembly_Gastrotricha.scientific_names	optimize	status	OK
--------------
DELETE QUICK t1 FROM scientific_name_references AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM scientific_name_references AS t1
LEFT JOIN `references` AS t2 ON t1.reference_code = t2.reference_code
WHERE t2.reference_code IS NULL
--------------

--------------
OPTIMIZE TABLE scientific_name_references
--------------

Table	Op	Msg_type	Msg_text
Assembly_Gastrotricha.scientific_name_references	optimize	status	OK
--------------
DELETE QUICK t1 FROM specialists AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.specialist_code = t2.specialist_code
WHERE t2.specialist_code IS NULL
--------------

--------------
DELETE t1 FROM `references` AS t1
LEFT JOIN scientific_name_references AS t2 ON t1.reference_code = t2.reference_code
LEFT JOIN common_names AS t3 ON t1.reference_code = t3.reference_code
WHERE t2.reference_code IS NULL AND t3.reference_code IS NULL
--------------

--------------
OPTIMIZE TABLE `references`
--------------

Table	Op	Msg_type	Msg_text
Assembly_Gastrotricha.references	optimize	status	OK
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

</pre>
<pre>
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Editorial and Integrity checks Completed.
</pre>
</pre><hr><b>Replacing sectors in Assembly Global database</b>
<pre>
<pre>
Starting Sector Management
--------------
SET @dbid = 122
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
DELETE FROM ",
@dbtouse,
".`databases` WHERE `record_id` = @dbid")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`families` SELECT 
NULL AS `record_id`,
`hierarchy_code`,	
`kingdom`,	
`phylum`,	
`class`,	
`order`,	
`family`,	
`superfamily`, 	
`database_id`, 	
`family_code`,
`is_accepted_name`
FROM  `families`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`databases` SELECT 
`database_name_displayed`, 
`record_id`, 
`database_name`, 
`database_full_name`, 
`web_site`, 
`organization`, 
`contact_person`, 
`taxa`, 
`taxonomic_coverage`, 
`abstract`, 
`version`, 
`release_date`, 
`SpeciesCount`, 
`SpeciesEst`, 
`authors_editors`, 
`accepted_species_names`, 
`accepted_infraspecies_names`, 
`species_synonyms`, 
`infraspecies_synonyms`, 
`common_names`, 
`total_names`, 
`is_new`,
`coverage`,
`completeness`,
`confidence`
FROM `databases`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_names` 
(`record_id`, `name_code`, `web_site`, `genus`, `subgenus`, `species`, `infraspecies_parent_name_code`, `infraspecies`, `infraspecies_marker`, `author`, `accepted_name_code`, `comment`, `scrutiny_date`, `sp2000_status_id`, `database_id`, `specialist_id`, `family_id`, `specialist_code`, `family_code`, `is_accepted_name`, `GSDTaxonGUID`, `GSDNameGUID`, `is_extinct`, `has_preholocene`, `has_modern`) SELECT 
NULL AS `record_id`, 
`name_code`, 
`web_site`, 
`genus`, 
`subgenus`, 
`species`, 
`infraspecies_parent_name_code`, 
`infraspecies`, 
`infraspecies_marker`, 
`author`, 
`accepted_name_code`, 
`comment`, 
`scrutiny_date`, 
`sp2000_status_id`, 
`database_id`, 
`specialist_id`, 
`family_id`, 
`specialist_code`, 
`family_code`, 
`is_accepted_name`, 
`GSDTaxonGUID`, 
`GSDNameGUID`, 
`is_extinct`,
`has_preholocene`, 
`has_modern`
FROM `scientific_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`common_names` SELECT 
NULL AS `record_id`, 
`name_code`, 
`common_name`, 
`transliteration`, 
`language`, 
`country`, 
`area`, 
NULL AS `reference_id`, 
`database_id`, 
`is_infraspecies`, 
`reference_code`
FROM  `common_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`distribution` SELECT 
NULL AS `record_id`, 
`name_code`, 
`distribution`, 
`StandardInUse`, 
`DistributionStatus`,
`database_id`
FROM  `distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`lifezone` SELECT 
NULL AS `record_id`,
`name_code`, 	
`lifezone`,
`database_id`
FROM  `lifezone`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_name_references` SELECT 
NULL AS `record_id`,
`name_code`,	
`reference_type`, 	
NULL AS `reference_id`,	
`reference_code`,
`database_id`
FROM  `scientific_name_references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`references` SELECT 
NULL AS `record_id`, 
`author`, 
`year`, 
`title`, 
`source`, 
`database_id`, 
`reference_code`
FROM  `references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`specialists` SELECT 
NULL AS `record_id`,
`specialist_name`,
`specialist_code`,
`database_id`
FROM  `specialists`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Transformations Completed.
<pre>
</pre><hr><b>Chain completed</b>
</body></html>
