<html><body>
<br><b>Harvesting...</b>
<pre>
</pre><hr><b>File format conversions...</b>
<pre>
Unzipping
Archive:  WoRMS_Octocorallia.zip
  inflating: AcceptedSpecies.txt     
  inflating: AcceptedInfraSpecificTaxa.txt  
  inflating: Synonyms.txt            
  inflating: CommonNames.txt         
  inflating: Distribution.txt        
  inflating: References.txt          
  inflating: NameReferencesLinks.txt  
  inflating: SourceDatabase.txt      
Skipping format conversion
</pre><hr><b>Creating buffer database, performing structural transformations...</b>
<pre>
<pre>
Initiating buffer creation - this may take a while depending on size of the dataset...

Creating buffer database Buffer_Octocorallia in schema as provided by Octocorallia
--------------
DROP DATABASE IF EXISTS Buffer_Octocorallia
--------------

--------------
CREATE DATABASE IF NOT EXISTS Buffer_Octocorallia
--------------

--------------
CREATE TABLE `AcceptedInfraSpecificTaxa` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`ParentSpeciesID` varchar(50) default NULL,
`InfraSpeciesEpithet` varchar(50) default NULL,
`InfraSpecificAuthorString` varchar(50) default NULL,
`InfraSpecificMarker` varchar(10) default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`InfraSpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI`  varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `AcceptedSpecies` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`Kingdom` varchar(50) default NULL,
`Phylum` varchar(50) default NULL,
`Class` varchar(50) default NULL,
`Order` varchar(50) default NULL,
`Superfamily` varchar(50) default NULL,
`Family` varchar(50) default NULL,
`Genus` varchar(50) default NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) default NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`SpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `CommonNames` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`CommonName` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Transliteration` varchar(255) default NULL,
`Language` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Country`  varchar(255) default NULL,
`Area`  varchar(255) default NULL,
`ReferenceID` varchar(50) default NULL,
PRIMARY KEY (`record_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `Distribution` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Distribution` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`StandardInUse` varchar(50) default NULL,
`DistributionStatus` varchar(50) default NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `References` (
`ReferenceID` varchar(50) PRIMARY KEY,
`Authors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Year` varchar(255) default NULL,
`Title` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Details` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `NameReferencesLinks` (
`ID` integer(10) PRIMARY KEY,
`ReferenceType` varchar(50) default NULL,
`ReferenceID` varchar(50) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `SourceDatabase` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`DatabaseFullName` varchar(255) NOT NULL,
`DatabaseShortName` varchar(50) NOT NULL,
`DatabaseVersion` varchar(50) NOT NULL,
`ReleaseDate` varchar(50) NOT NULL,
`AuthorsEditors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`TaxonomicCoverage` varchar(255) NOT NULL,
`GroupNameInEnglish` varchar(255) NOT NULL,
`Abstract` text  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Organisation` varchar(255) NOT NULL,
`HomeURL` varchar(255) default NULL,
`Coverage` varchar(50) default NULL,
`Completeness` integer(3) default NULL,
`Confidence` integer(1) default NULL,
`LogoFileName`  varchar(255) default NULL,
`ContactPerson` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `Synonyms` (
`ID` integer(10) PRIMARY KEY,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Genus` varchar(50) NOT NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) NOT NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`InfraSpecies` varchar(50) default NULL,
`InfraSpecificMarker` varchar(50) default NULL,
`InfraSpecificAuthorString`  varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`GSDNameGUI` varchar(255) default NULL 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedInfraSpecificTaxa.txt' INTO TABLE `AcceptedInfraSpecificTaxa` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES 
(`AcceptedTaxonID`, `ParentSpeciesID`, `InfraSpeciesEpithet`, `InfraSpecificAuthorString`,  `InfraSpecificMarker`, `GSDNameStatus`,  `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `InfraSpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedSpecies.txt' INTO TABLE `AcceptedSpecies` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Kingdom`, `Phylum`, `Class`, `Order`, `Superfamily`, `Family`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `SpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'CommonNames.txt' INTO TABLE `CommonNames` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `CommonName`, `Transliteration`, `Country`, `Area`, `Language`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Distribution.txt' INTO TABLE `Distribution` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Distribution`, `StandardInUse`, `DistributionStatus`)
--------------

--------------
LOAD DATA LOCAL INFILE 'NameReferencesLinks.txt' INTO TABLE NameReferencesLinks CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `ReferenceType`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'References.txt' INTO TABLE `References` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ReferenceID`, `Authors`, `Year`, `Title`, `Details`)
--------------

--------------
LOAD DATA LOCAL INFILE 'SourceDatabase.txt' INTO TABLE `SourceDatabase` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`DatabaseFullName`, `DatabaseShortName`, `DatabaseVersion`, `ReleaseDate`, `AuthorsEditors`, `TaxonomicCoverage`, `GroupNameInEnglish`, `Abstract`, `Organisation`, `HomeURL`, `Coverage`, `Completeness`, `Confidence`, `LogoFileName`, `ContactPerson`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Synonyms.txt' INTO TABLE `Synonyms` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `AcceptedTaxonID`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `InfraSpecies`, `InfraSpecificMarker`, `InfraSpecificAuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `GSDNameGUI`)
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



Initial database created. Creating database Assembly_Octocorallia in assembly schema
--------------
DROP DATABASE IF EXISTS Assembly_Octocorallia
--------------

--------------
CREATE DATABASE IF NOT EXISTS Assembly_Octocorallia
--------------

--------------
DROP TABLE IF EXISTS `databases`
--------------

--------------
CREATE TABLE  `databases` (
  `database_name_displayed` varchar(125) DEFAULT NULL,
  `record_id` int(10) NOT NULL AUTO_INCREMENT,
  `database_name` varchar(150) DEFAULT NULL,
  `database_full_name` varchar(100) NOT NULL DEFAULT '',
  `web_site` longtext,
  `organization` longtext,
  `contact_person` varchar(255) DEFAULT NULL,
  `taxa` varchar(255) DEFAULT NULL,
  `taxonomic_coverage` longtext,
  `abstract` longtext,
  `version` varchar(255) DEFAULT NULL,
  `release_date` date DEFAULT '0000-00-00',
  `SpeciesCount` int(11) DEFAULT 0,
  `SpeciesEst` int(11) DEFAULT 0,
  `authors_editors` longtext,
  `accepted_species_names` int(10) DEFAULT 0,
  `accepted_infraspecies_names` int(10) DEFAULT 0,
  `species_synonyms` int(10) DEFAULT 0,
  `infraspecies_synonyms` int(10) DEFAULT 0,
  `common_names` int(10) DEFAULT 0,
  `total_names` int(10) DEFAULT 0,
  `is_new` tinyint(1) NOT NULL DEFAULT 0,
  `coverage` varchar(45) DEFAULT NULL,
  `completeness` int(3) unsigned DEFAULT 0,
  `confidence` 	tinyint(1) unsigned DEFAULT 0,
  PRIMARY KEY (`record_id`),
  KEY `database_name` (`database_name`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `families`
--------------

--------------
CREATE TABLE  `families` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `hierarchy_code` varchar(250) NOT NULL,
  `kingdom` varchar(50) NOT NULL DEFAULT 'Not Assigned',
  `phylum` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `class` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `order` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `family` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `superfamily` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  `family_code` varchar(50) NOT NULL,
  `is_accepted_name` int(1) unsigned,
  PRIMARY KEY (`record_id`),
  KEY (`family_code`),
  KEY `kingdom` (`kingdom`),
  KEY `phylum` (`phylum`),
  KEY `class` (`class`),
  KEY `order` (`order`),
  KEY `family` (`family`),
  KEY `superfamily` (`superfamily`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `sp2000_statuses`
--------------

--------------
CREATE TABLE  `sp2000_statuses` (
  `record_id` int(1) NOT NULL AUTO_INCREMENT,
  `sp2000_status` varchar(50) NOT NULL DEFAULT '',
  PRIMARY KEY (`record_id`)
) ENGINE=MyISAM
--------------

--------------
DROP TABLE IF EXISTS `scientific_names`
--------------

--------------
CREATE TABLE  `scientific_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `web_site` longtext,
  `genus` varchar(50) DEFAULT NULL,
  `subgenus` varchar(50) DEFAULT NULL,
  `species` varchar(60) DEFAULT NULL,
  `infraspecies_parent_name_code` varchar(42) DEFAULT NULL,
  `infraspecies` varchar(50) DEFAULT NULL,
  `infraspecies_marker` varchar(50) DEFAULT NULL,
  `author` varchar(100) DEFAULT NULL,
  `accepted_name_code` varchar(42) DEFAULT NULL,
  `comment` longtext,
  `scrutiny_date` text,
  `sp2000_status_id` int(1) DEFAULT NULL,
  `database_id` int(10) DEFAULT NULL,
  `specialist_id` int(10) DEFAULT NULL,
  `family_id` int(10) DEFAULT NULL,
  `specialist_code` varchar(50) DEFAULT NULL,
  `family_code` varchar(50) DEFAULT NULL,
  `is_accepted_name` int(1) DEFAULT NULL,
  `GSDTaxonGUID` longtext,
  `GSDNameGUID` longtext,
  `is_extinct` smallint(1) NOT NULL DEFAULT '0',
  `has_preholocene` smallint(1) NOT NULL DEFAULT '0',
  `has_modern` smallint(1) NOT NULL DEFAULT '1',
  PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `specialist_code` (`specialist_code`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `common_names`
--------------

--------------
CREATE TABLE  `common_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `common_name` varchar(700) NOT NULL,
  `transliteration` varchar(700),
  `language` varchar(25) NOT NULL,
  `country` varchar(44) NOT NULL DEFAULT '',
  `area` varchar(50) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `database_id` int(10) NOT NULL,
  `is_infraspecies` int(1) NOT NULL DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `common_name` (`common_name`),
  KEY `reference_code` (`reference_code`),
  KEY `name_code` (`name_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `distribution`
--------------

--------------
CREATE TABLE  `distribution` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `distribution` longtext,
  `StandardInUse` varchar(255) DEFAULT NULL,
  
   `DistributionStatus` varchar(255),
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `lifezone`
--------------

--------------
CREATE TABLE  `lifezone` (
  `record_id` int(11) NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42),
  `lifezone` varchar(255),
  `database_id` int(10),
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `scientific_name_references`
--------------

--------------
CREATE TABLE  `scientific_name_references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `reference_type` varchar(10) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`,`reference_id`,`reference_type`),
  KEY `reference_code` (`reference_code`),
  KEY `name_code_2` (`name_code`,`reference_type`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `references`
--------------

--------------
CREATE TABLE  `references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `author` varchar(200) DEFAULT NULL,
  `year` varchar(50) DEFAULT NULL,
  `title` longtext,
  `source` longtext,
  `database_id` int(10) NOT NULL,
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `reference_code` (`reference_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `specialists`
--------------

--------------
CREATE TABLE  `specialists` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `specialist_name` varchar(255) NOT NULL DEFAULT '',
  `specialist_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `specialist_code` (`specialist_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
INSERT INTO `sp2000_statuses` 
VALUES (1,'accepted name'),
(2,'ambiguous synonym'),
(3,'misapplied name'),
(4,'provisionally accepted name'),
(5,'synonym')
--------------

--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Creation of the assembly database completed.

Starting structural transformations (ACEF3 to ACI)
--------------
SET @dbid = 131
--------------

--------------
SET @dbabbr = 'W-Oct-'
--------------

--------------
SET @dbtouse = 'Buffer_Octocorallia'
--------------

--------------
SET foreign_key_checks = 0
--------------

--------------
TRUNCATE TABLE `databases`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `databases`
 SELECT
 CONCAT(`DatabaseShortName`, ': ', `DatabaseFullName`)  AS `database_name_displayed`,
 @dbid AS `record_id`,
 `DatabaseShortName` AS `database_name`,
 `DatabaseFullName` AS `database_full_name`,
  `HomeURL` AS `web_site`,
  `Organisation` AS `organization`,
  `ContactPerson` AS `contact_person`,
  `GroupNameInEnglish` AS `taxa`,
  `TaxonomicCoverage` AS `taxonomic_coverage`,
  `Abstract` AS `abstract`,
  `DatabaseVersion` AS `version`,
  `ReleaseDate` AS `release_date`,
  `Coverage` AS `SpeciesCount`,
  `Completeness` AS `SpeciesEst`,
  `AuthorsEditors` AS `authors_editors`,
  NULL AS `accepted_species_names`,
  NULL AS `accepted_infraspecies_names`,
  NULL AS `species_synonyms`,
  NULL AS `infraspecies_synonyms`,
  NULL AS `common_names`,
  NULL AS `total_names`,
  NULL AS `is_new`,
  NULL AS `coverage`,
  NULL AS `completeness`,
  NULL AS `confidence`
  FROM ",
@dbtouse,
".`SourceDatabase`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `distribution`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `distribution`
 SELECT
 NULL AS `record_id`,
 CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
 `Distribution` AS `distribution`,
 `StandardInUse` AS `StandardInUse`,
 `DistributionStatus` AS `DistributionStatus`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`Distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `families`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `families`
SELECT DISTINCT
NULL AS `record_id`,
NULL AS `hierarchy_code`,
`Kingdom` AS `kingdom`,
`Phylum` AS `phylum`,
`Class` AS `class`,
`Order` AS `order`,
`Family` AS `family`,
`Superfamily` AS `superfamily`,
@dbid AS `database_id`,
NULL AS `family_code`,
NULL AS `is_accepted_name`
FROM ",
@dbtouse,
".`AcceptedSpecies`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `families` SET `family_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `specialists`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `specialists`
SELECT DISTINCT
NULL  AS `record_id`,
`LTSSpecialist` AS `specialist_name`,
NULL AS `specialist_code`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LTSSpecialist` IS NOT NULL OR
`LTSSpecialist` != ''")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `specialists` SET `specialist_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `scientific_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`SpeciesURL` AS `web_site`,
`Genus` AS `genus`,
`SubGenusName` AS `subgenus`,
`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
NULL  AS `infraspecies`,
NULL  AS `infraspecies_marker`,
`AuthorString` AS `author`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `accepted_name_code`,
`AdditionalData` AS `comment`,
`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
`specialists`.`record_id` AS `specialist_id`,
`families`.`record_id` AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
`families`.`family_code` AS `family_code`,
1 AS `is_accepted_name`,
`GSDTaxonGUI` AS `GSDTaxonGUI`,
`GSDNameGUI` AS `GSDNameGUI`,
`IsFossil` AS `is_extinct`,
`IsFossil` AS `has_preholocene`,
if (`IsFossil` = 0, 1, 0) AS `has_modern`
FROM ",
@dbtouse,
".`AcceptedSpecies` AcceptedSpecies
LEFT OUTER JOIN `families` ON
(`AcceptedSpecies`.`Kingdom` = `families`.`kingdom` AND
`AcceptedSpecies`.`Phylum` = `families`.`phylum` AND
`AcceptedSpecies`.`Class` = `families`.`class` AND
`AcceptedSpecies`.`Order` = `families`.`order` AND
`AcceptedSpecies`.`Superfamily` = `families`.`superfamily` AND
`AcceptedSpecies`.`Family` = `families`.`family`)
LEFT OUTER JOIN `specialists` ON
`AcceptedSpecies`.`LTSSpecialist` = `specialists`.`specialist_name`
LEFT OUTER JOIN `sp2000_statuses` ON
`AcceptedSpecies`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `lifezone`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `lifezone`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`LifeZone` AS `lifezone`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LifeZone` IN('marine','freshwater','Marine','Freshwater')")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `name_code`,
NULL AS `web_site`,
`sn`.`genus` AS `genus`,
NULL AS `subgenus`,
`sn`.`species` AS `species`,
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) AS `infraspecies_parent_name_code`,
`AIT`.`InfraSpeciesEpithet` AS `infraspecies`,
`AIT`.`InfraSpecificMarker` AS `infraspecies_marker`,
`AIT`.`InfraSpecificAuthorString` AS `author`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `accepted_name_code`,
`AIT`.`AdditionalData` AS `comment`,
`AIT`.`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
sn.family_code AS `family_code`,
1 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`AIT`.`GSDNameGUI` AS `GSDNameGUI`,
`IsFossil` AS `is_extinct`,
`IsFossil` AS `has_preholocene`,
if (`IsFossil` = 0, 1, 0) AS `has_modern`
FROM ",
@dbtouse,
".`AcceptedInfraSpecificTaxa` AIT
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`AIT`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`
LEFT OUTER JOIN `specialists` ON
`AIT`.`LTSSpecialist` = `specialists`.`specialist_name`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`Synonyms`.`ID`) AS `name_code`,
NULL AS `web_site`,
`Synonyms`.`Genus` AS `genus`,
`Synonyms`.`SubGenusName` AS `subgenus`,
`Synonyms`.`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
`Synonyms`.`InfraSpecies` AS `infraspecies`,
`Synonyms`.`InfraSpecificMarker` AS `infraspecies_marker`,
`Synonyms`.`AuthorString` AS `author`,
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) AS `accepted_name_code`,
NULL AS `comment`,
NULL AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
sn.`specialist_code` AS `specialist_code`,
sn.`family_code` AS `family_code`,
0 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`Synonyms`.`GSDNameGUI` AS `GSDNameGUI` ,
0 AS `is_extinct`,
0 AS `has_preholocene`,
1 AS `has_modern`
FROM ",
@dbtouse,
".`Synonyms` Synonyms
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`Synonyms`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `common_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `common_names`
SELECT
NULL,
CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
CONVERT(`CommonName` USING utf8) AS `common_name`,
`Transliteration` AS `transliteration`,
`Language` AS `language`,
`Country` AS `country`,
`Area` AS `area`,
 NULL AS `reference_ID`,
@dbid AS `database_ID`,
 NULL AS `is_infraspecies`,
 `ReferenceID` AS `reference_code`
 FROM ",
@dbtouse,
".`CommonNames`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `references`
SELECT
NULL AS `record_id`,
`Authors` AS `author`,
`Year` AS `year`,
`Title` AS `title`,
`Details` AS `source`,
@dbid AS `database_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`
 FROM ",
@dbtouse,
".`References`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `scientific_name_references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_name_references`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr, `ID`) AS `name_code`,
`ReferenceType` AS `reference_type`,
NULL AS `reference_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`NameReferencesLinks`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET foreign_key_checks = 1
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Data Loaded.
</pre>
</pre><hr><b>Backing up...</b>
<pre>
Creating directory  00_29_05_06Oct2016
Backing up files
</pre><hr><b>Executing local editorial checks</b>
<pre>
<pre>
Integrity and editorial checks - this may take a while depending on size of the dataset...

Starting local editorial transformations
--------------
UPDATE `databases` SET `taxonomic_coverage`="Animalia - Cnidaria - Anthozoa - (subclass Octocorallia) - Alcyonacea, Helioporacea, Pennatulacea", `is_new` = 2, `taxa`="Soft corals, blue coral, sea pens and gorgonians", `coverage`="Global", `completeness` = 100, `confidence` = 4
--------------

--------------
DELETE FROM `common_names` WHERE `common_name` IS NULL OR `common_name` = ""
--------------

--------------
DELETE FROM `distribution` WHERE `distribution` IS NULL OR `distribution` = ""
--------------

--------------
DELETE FROM `references` WHERE (`title` IS NULL OR `title` = "") AND (`author` IS NULL OR `author` = "")
--------------

--------------
DELETE FROM `specialists` WHERE `specialist_name` IS NULL OR `specialist_name` = ""
--------------

--------------
DELETE FROM `scientific_names` WHERE (`species` IS NULL OR `species` LIKE "%sp.%" OR `species` LIKE "%spp.%") AND `infraspecies` IS NULL
--------------

--------------
DELETE FROM `scientific_names` WHERE `genus` IS NULL OR `genus` = "" OR genus like "% %" OR `genus` LIKE '%sp.%' OR `genus` LIKE "%spp.%"
--------------

--------------
UPDATE `scientific_names` SET `family_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `specialist_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "forma" WHERE `infraspecies_marker` LIKE "f.%"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "var." WHERE `infraspecies_marker` LIKE "Variety"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "subsp." WHERE `infraspecies_marker` LIKE "Subspecies"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "subsp." WHERE `infraspecies_marker` LIKE "ssp."
--------------

--------------
UPDATE `scientific_names` SET `sp2000_status_id` = 5 WHERE `sp2000_status_id` IS NULL AND `is_accepted_name` = 0
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE `family` LIKE "% %"
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE `order` LIKE "% %"
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE `class` LIKE "% %"
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE `phylum` LIKE "% %"
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE `kingdom` LIKE "% %"
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE (`family` IS NULL OR `family` = '')
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE (`order` IS NULL OR `order` = '')
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE (`class` IS NULL OR `class` = '')
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE (`phylum` IS NULL OR `phylum` = '')
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE (`kingdom` IS NULL OR `kingdom` = '')
--------------

--------------
UPDATE `families` SET `hierarchy_code` = CONCAT(`kingdom`,'-',`phylum`,'-',`class`,'-',`order`,'-',`family`)
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "subsequent type designation%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "Nom%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "taxonomy source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "additional source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "original description%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "source of synonymy%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "basis of record%"
--------------

--------------
UPDATE `databases` SET database_name_displayed = REPLACE(database_name_displayed,'_',' ')
--------------

--------------
UPDATE `databases` SET database_name = REPLACE(database_name,'_',' ')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ',', '')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ';', ',')
--------------

--------------
SELECT "Misspelt infraspecies (no subgenus): ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND
(`subgenus` IS NULL OR `subgenus` = '') AND
`infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%')
--------------

--------------
SELECT "Misspelt infraspecies (with subgenus): ", `name_code`, `genus`, `subgenus`, `species`, `infraspecies` FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND
`subgenus` != '' AND
(`infraspecies` NOT LIKE CONCAT(`genus`, ' (', `subgenus`, ') ', `species`, '%') OR `infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%'))
--------------

--------------
DELETE FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND
(`subgenus` IS NULL OR `subgenus` = '') AND
`infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%')
--------------

--------------
DELETE FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND
`subgenus` != '' AND
(`infraspecies` NOT LIKE CONCAT(`genus`, ' (', `subgenus`, ') ', `species`, '%') OR `infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%'))
--------------

--------------
SELECT "Incorrect infraspecies: ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names`
WHERE `infraspecies` LIKE '% %'  AND
`infraspecies` NOT LIKE 'f.%' AND
`infraspecies` NOT LIKE 'var.%' AND
`infraspecies` NOT LIKE 'subsp.%'
--------------

--------------
DELETE FROM `scientific_names`
WHERE `infraspecies` LIKE '% %'  AND
`infraspecies` NOT LIKE 'f.%' AND
`infraspecies` NOT LIKE 'var.%' AND
`infraspecies` NOT LIKE 'subsp.%'
--------------

--------------
SELECT "Infraspecies starting with marker: ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
(`infraspecies` LIKE 'f.%' OR
`infraspecies` LIKE 'var.%' OR
`infraspecies` LIKE 'subsp.%')
--------------

Infraspecies starting with marker: 	name_code	genus	species	infraspecies
Infraspecies starting with marker: 	W-Oct-409568	Calyptrophora	japonica	f. A
Infraspecies starting with marker: 	W-Oct-409570	Calyptrophora	japonica	f. B
Infraspecies starting with marker: 	W-Oct-409569	Calyptrophora	japonica	f. C
Infraspecies starting with marker: 	W-Oct-712099	Eunicea	tourneforti	f. atra
Infraspecies starting with marker: 	W-Oct-409535	Plumarella	pourtalesii	f. obtusa
Infraspecies starting with marker: 	W-Oct-409504	Thouarella	hilgendorfi	f. plumatilis
Infraspecies starting with marker: 	W-Oct-409534	Plumarella	pourtalesii	f. robusta
Infraspecies starting with marker: 	W-Oct-409539	Plumarella	dofleini	var. boninensis
Infraspecies starting with marker: 	W-Oct-409502	Thouarella	variabilis	var. brevispinosa
Infraspecies starting with marker: 	W-Oct-409503	Thouarella	variabilis	var. gracilis
Infraspecies starting with marker: 	W-Oct-409545	Callogorgia	verticillata	var. grimaldii
Infraspecies starting with marker: 	W-Oct-422750	Scleranthelia	rugosa	var. musiva
Infraspecies starting with marker: 	W-Oct-422749	Scleranthelia	rugosa	var. rugosa
Infraspecies starting with marker: 	W-Oct-409549	Primnoa	pacifica	var. willeyi
--------------
UPDATE `scientific_names` SET `infraspecies` = SUBSTRING_INDEX(`infraspecies`, ' ', -1)
WHERE `infraspecies` LIKE '% %' AND
(`infraspecies` LIKE 'f.%' OR
`infraspecies` LIKE 'var.%' OR
`infraspecies` LIKE 'subsp.%')
--------------

--------------
SELECT "Infraspecies mismatch (infraspecies_parent_name_code set but infraspecies empty): ", `name_code`, `infraspecies_parent_name_code` FROM `scientific_names`
WHERE CHAR_LENGTH(`infraspecies_parent_name_code`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
SELECT "Infraspecies mismatch (infraspecies_marker set but infraspecies empty): ", `name_code`, `infraspecies_marker` FROM `scientific_names`
WHERE CHAR_LENGTH(`infraspecies_marker`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
DELETE FROM `scientific_names`
WHERE CHAR_LENGTH(`infraspecies_parent_name_code`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
DELETE FROM `scientific_names`
WHERE CHAR_LENGTH(`infraspecies_marker`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
UPDATE `scientific_names` SET `species` = LOWER(`species`)
--------------

--------------
SELECT "Empty species name: ", `name_code`, `genus`, `infraspecies` FROM `scientific_names`
WHERE `species` = '' OR `species` IS NULL
--------------

--------------
DELETE FROM `scientific_names`
WHERE `species` = '' OR `species` IS NULL
--------------

--------------
SELECT "Empty reference: ", `author`, `year`, `reference_code` FROM `references`
WHERE (`title` = '' OR `title` IS NULL) AND
(`source` = '' OR `source` IS NULL)
--------------

--------------
DELETE FROM `references`
WHERE (`title` = '' OR `title` IS NULL) AND
(`source` = '' OR `source` IS NULL)
--------------

--------------
UPDATE `scientific_names` SET `scrutiny_date` = DATE_FORMAT(`scrutiny_date`, '%d-%b-%Y')
WHERE `scrutiny_date` LIKE '%:%' AND
(`scrutiny_date` != '' OR `scrutiny_date` IS NOT NULL)
--------------

--------------
SELECT "Set is_infraspecies flag: ", t1.`name_code`, t1.`common_name`, t2.`genus`, t2.`species`, t2.`infraspecies`
FROM `common_names` AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.`name_code` = t2.`name_code`
WHERE (t2.`infraspecies` != '' OR t2.`infraspecies` IS NOT NULL) AND
t1.`is_infraspecies` = 0
--------------

--------------
UPDATE `common_names` AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.`name_code` = t2.`name_code`
SET t1.`is_infraspecies` = 1
WHERE (t2.`infraspecies` != '' OR t2.`infraspecies` IS NOT NULL) AND
t1.`is_infraspecies` = 0
--------------

--------------
UPDATE `scientific_names` SET `author` = TRIM(`author`)
--------------

--------------
UPDATE `references`  SET `author` = TRIM(`author`)
--------------

--------------
SELECT "Duplicate accepted names:", sn.name_code, sn.sp2000_status_id, dups.genus, dups.subgenus, dups.species, dups.infraspecies_marker, dups.infraspecies, dups.author
FROM
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
	FROM scientific_names
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
WHERE sn.sp2000_status_id = 1
--------------

--------------
SELECT "Accepted name to be retained", MAX(name_code), genus, subgenus, species, infraspecies_marker, infraspecies, author
FROM
	(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, dups.species AS species,
		dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
	FROM
		(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
		FROM scientific_names
		GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
	LEFT JOIN scientific_names sn
	ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2
GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author
--------------

--------------
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus,
	dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
FROM
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
	FROM scientific_names
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
WHERE sn.sp2000_status_id = 1 AND sn.name_code NOT IN
	(SELECT dups3.namecodes_to_keep FROM
		(SELECT MAX(name_code) AS namecodes_to_keep, genus, subgenus, species, infraspecies_marker, infraspecies, author
		FROM
			(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus,
				dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
			FROM
				(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
				FROM scientific_names
				GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
		LEFT JOIN scientific_names sn
		ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2
GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
SELECT 'Common name without parent accepted name', t1.record_id, t1.common_name, t1.name_code FROM common_names AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
CREATE TEMPORARY TABLE scientific_names_tmp
(PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `specialist_code` (`specialist_code`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`))
SELECT * FROM scientific_names
--------------

--------------
SELECT 'Synonym without parent accepted name', t1.record_id, t1.name_code, t1.genus, t1.species, t1.infraspecies, t1.accepted_name_code
FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.accepted_name_code = t2.name_code
WHERE t2.name_code IS NULL AND t1.is_accepted_name != 1
--------------

Synonym without parent accepted name	record_id	name_code	genus	species	infraspecies	accepted_name_code
Synonym without parent accepted name	4102	W-Oct-288416	Acabaria	dakini		W-Oct-517575
Synonym without parent accepted name	4240	W-Oct-213043	Nephthea	hirsuta		W-Oct-205239
Synonym without parent accepted name	4279	W-Oct-288651	Nephthea	armata		W-Oct-205239
Synonym without parent accepted name	4280	W-Oct-288691	Nephthea	zanzibarensis		W-Oct-205239
--------------
SELECT 'Infraspecies without parent accepted name', t1.record_id, t1.name_code, t1.genus, t1.species, t1.infraspecies, t1.accepted_name_code
FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.infraspecies_parent_name_code = t2.name_code
WHERE t1.infraspecies_parent_name_code IS NOT NULL AND t2.name_code IS NULL
--------------

--------------
SELECT 'Lifezone without parent accepted name', t1.record_id, t1.name_code, t1.lifezone
FROM lifezone AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
SELECT 'Distribution without parent accepted name', t1.record_id, t1.name_code, t1.distribution
FROM distribution AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
SELECT 'Accepted name without parent family', t1.record_id, t1.name_code,
	t1.genus, t1.subgenus, t1.species, t1.infraspecies, t1.family_code
FROM scientific_names AS t1
LEFT JOIN families AS t2 ON t1.family_code = t2.family_code
WHERE t2.family_code IS NULL
--------------

Accepted name without parent family	record_id	name_code	genus	subgenus	species	infraspecies	family_code
Accepted name without parent family	4102	W-Oct-288416	Acabaria		dakini		NULL
Accepted name without parent family	4240	W-Oct-213043	Nephthea		hirsuta		NULL
Accepted name without parent family	4279	W-Oct-288651	Nephthea		armata		NULL
Accepted name without parent family	4280	W-Oct-288691	Nephthea		zanzibarensis		NULL
--------------
SELECT 'Reference link to non-existing accepted name', t1.record_id, t1.reference_code, t1.name_code
FROM scientific_name_references AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

Reference link to non-existing accepted name	record_id	reference_code	name_code
Reference link to non-existing accepted name	25	W-Oct-1318	W-Oct-290793
Reference link to non-existing accepted name	96	W-Oct-1659	W-Oct-151658
Reference link to non-existing accepted name	102	W-Oct-1318	W-Oct-173336
Reference link to non-existing accepted name	226	W-Oct-152417	W-Oct-288005
Reference link to non-existing accepted name	254	W-Oct-124428	W-Oct-288658
Reference link to non-existing accepted name	416	W-Oct-124428	W-Oct-288586
Reference link to non-existing accepted name	596	W-Oct-124428	W-Oct-288652
Reference link to non-existing accepted name	1338	W-Oct-124428	W-Oct-288414
Reference link to non-existing accepted name	1371	W-Oct-229720	W-Oct-213041
Reference link to non-existing accepted name	1507	W-Oct-5987	W-Oct-212761
Reference link to non-existing accepted name	1679	W-Oct-124428	W-Oct-288144
Reference link to non-existing accepted name	1719	W-Oct-1309	W-Oct-151649
Reference link to non-existing accepted name	1826	W-Oct-4179	W-Oct-173325
Reference link to non-existing accepted name	1849	W-Oct-124428	W-Oct-286208
Reference link to non-existing accepted name	1853	W-Oct-124428	W-Oct-286258
Reference link to non-existing accepted name	2132	W-Oct-47806	W-Oct-345452
Reference link to non-existing accepted name	2141	W-Oct-222910	W-Oct-527572
Reference link to non-existing accepted name	2233	W-Oct-1318	W-Oct-291713
Reference link to non-existing accepted name	2236	W-Oct-1318	W-Oct-291781
Reference link to non-existing accepted name	2257	W-Oct-50201	W-Oct-338179
Reference link to non-existing accepted name	2258	W-Oct-8	W-Oct-340941
Reference link to non-existing accepted name	2271	W-Oct-671	W-Oct-724654
Reference link to non-existing accepted name	2319	W-Oct-124428	W-Oct-290037
Reference link to non-existing accepted name	2360	W-Oct-1318	W-Oct-291715
Reference link to non-existing accepted name	2364	W-Oct-1318	W-Oct-291851
Reference link to non-existing accepted name	2374	W-Oct-1318	W-Oct-291953
Reference link to non-existing accepted name	2375	W-Oct-1318	W-Oct-291958
Reference link to non-existing accepted name	2381	W-Oct-1318	W-Oct-292060
Reference link to non-existing accepted name	2416	W-Oct-7945	W-Oct-863505
Reference link to non-existing accepted name	2455	W-Oct-124428	W-Oct-290416
Reference link to non-existing accepted name	2471	W-Oct-124428	W-Oct-290902
Reference link to non-existing accepted name	2485	W-Oct-1318	W-Oct-291857
Reference link to non-existing accepted name	2626	W-Oct-8	W-Oct-337823
Reference link to non-existing accepted name	2742	W-Oct-1318	W-Oct-292536
Reference link to non-existing accepted name	2853	W-Oct-1318	W-Oct-291788
Reference link to non-existing accepted name	2864	W-Oct-1318	W-Oct-292056
Reference link to non-existing accepted name	2970	W-Oct-1318	W-Oct-291888
Reference link to non-existing accepted name	3006	W-Oct-175546	W-Oct-754314
Reference link to non-existing accepted name	3045	W-Oct-124422	W-Oct-289627
Reference link to non-existing accepted name	3087	W-Oct-1318	W-Oct-291939
Reference link to non-existing accepted name	3105	W-Oct-141724	W-Oct-467967
Reference link to non-existing accepted name	3203	W-Oct-1318	W-Oct-291891
Reference link to non-existing accepted name	3216	W-Oct-1318	W-Oct-292095
Reference link to non-existing accepted name	3272	W-Oct-124428	W-Oct-289961
Reference link to non-existing accepted name	3313	W-Oct-1318	W-Oct-291941
Reference link to non-existing accepted name	3314	W-Oct-1318	W-Oct-291966
Reference link to non-existing accepted name	3322	W-Oct-1318	W-Oct-292059
Reference link to non-existing accepted name	3355	W-Oct-35242	W-Oct-869613
Reference link to non-existing accepted name	3373	W-Oct-152417	W-Oct-289640
Reference link to non-existing accepted name	3408	W-Oct-124418	W-Oct-290960
Reference link to non-existing accepted name	3414	W-Oct-1318	W-Oct-291714
Reference link to non-existing accepted name	3427	W-Oct-1318	W-Oct-291965
Reference link to non-existing accepted name	3492	W-Oct-124422	W-Oct-289621
Reference link to non-existing accepted name	3644	W-Oct-1318	W-Oct-291832
Reference link to non-existing accepted name	3695	W-Oct-1309	W-Oct-151647
Reference link to non-existing accepted name	3699	W-Oct-5987	W-Oct-212763
Reference link to non-existing accepted name	3842	W-Oct-1318	W-Oct-291933
Reference link to non-existing accepted name	3933	W-Oct-124428	W-Oct-288422
Reference link to non-existing accepted name	3969	W-Oct-124428	W-Oct-289558
Reference link to non-existing accepted name	4009	W-Oct-1318	W-Oct-291849
Reference link to non-existing accepted name	4011	W-Oct-1318	W-Oct-291883
Reference link to non-existing accepted name	4013	W-Oct-1318	W-Oct-291917
Reference link to non-existing accepted name	4015	W-Oct-1318	W-Oct-291951
Reference link to non-existing accepted name	4021	W-Oct-1318	W-Oct-292058
--------------
SELECT 'Reference link to non-existing reference', t1.record_id, t1.reference_code, t1.name_code
FROM scientific_name_references AS t1
LEFT JOIN `references` AS t2 ON t1.reference_code = t2.reference_code
WHERE t2.reference_code IS NULL
--------------

Reference link to non-existing reference	record_id	reference_code	name_code
Reference link to non-existing reference	87	W-Oct-132089	W-Oct-125409
Reference link to non-existing reference	89	W-Oct-132089	W-Oct-125413
Reference link to non-existing reference	108	W-Oct-132089	W-Oct-173570
Reference link to non-existing reference	175	W-Oct-132089	W-Oct-286487
Reference link to non-existing reference	178	W-Oct-132089	W-Oct-286512
Reference link to non-existing reference	179	W-Oct-132089	W-Oct-286521
Reference link to non-existing reference	181	W-Oct-132089	W-Oct-286546
Reference link to non-existing reference	210	W-Oct-132089	W-Oct-287648
Reference link to non-existing reference	212	W-Oct-132089	W-Oct-287657
Reference link to non-existing reference	221	W-Oct-132089	W-Oct-287857
Reference link to non-existing reference	345	W-Oct-132089	W-Oct-286491
Reference link to non-existing reference	349	W-Oct-132089	W-Oct-286572
Reference link to non-existing reference	383	W-Oct-132089	W-Oct-287661
Reference link to non-existing reference	456	W-Oct-132089	W-Oct-173547
Reference link to non-existing reference	510	W-Oct-132089	W-Oct-286489
Reference link to non-existing reference	512	W-Oct-132089	W-Oct-286506
Reference link to non-existing reference	514	W-Oct-132089	W-Oct-286523
Reference link to non-existing reference	517	W-Oct-132089	W-Oct-286540
Reference link to non-existing reference	519	W-Oct-132089	W-Oct-286557
Reference link to non-existing reference	521	W-Oct-132089	W-Oct-286571
Reference link to non-existing reference	522	W-Oct-132089	W-Oct-286574
Reference link to non-existing reference	554	W-Oct-132089	W-Oct-287659
Reference link to non-existing reference	627	W-Oct-132089	W-Oct-125405
Reference link to non-existing reference	699	W-Oct-132089	W-Oct-286513
Reference link to non-existing reference	700	W-Oct-132089	W-Oct-286516
Reference link to non-existing reference	702	W-Oct-132089	W-Oct-286530
Reference link to non-existing reference	705	W-Oct-132089	W-Oct-286547
Reference link to non-existing reference	734	W-Oct-132089	W-Oct-287652
Reference link to non-existing reference	735	W-Oct-132089	W-Oct-287653
Reference link to non-existing reference	736	W-Oct-132089	W-Oct-287670
Reference link to non-existing reference	863	W-Oct-132089	W-Oct-286492
Reference link to non-existing reference	865	W-Oct-132089	W-Oct-286507
Reference link to non-existing reference	867	W-Oct-132089	W-Oct-286522
Reference link to non-existing reference	869	W-Oct-132089	W-Oct-286556
Reference link to non-existing reference	870	W-Oct-132089	W-Oct-286558
Reference link to non-existing reference	873	W-Oct-132089	W-Oct-286573
Reference link to non-existing reference	900	W-Oct-132089	W-Oct-287658
Reference link to non-existing reference	1007	W-Oct-132089	W-Oct-286486
Reference link to non-existing reference	1009	W-Oct-132089	W-Oct-286536
Reference link to non-existing reference	1011	W-Oct-132089	W-Oct-286543
Reference link to non-existing reference	1012	W-Oct-132089	W-Oct-286560
Reference link to non-existing reference	1029	W-Oct-132089	W-Oct-287472
Reference link to non-existing reference	1098	W-Oct-132089	W-Oct-173558
Reference link to non-existing reference	1144	W-Oct-132089	W-Oct-286509
Reference link to non-existing reference	1145	W-Oct-132089	W-Oct-286551
Reference link to non-existing reference	1168	W-Oct-132089	W-Oct-287649
Reference link to non-existing reference	1230	W-Oct-132089	W-Oct-289317
Reference link to non-existing reference	1286	W-Oct-132089	W-Oct-286502
Reference link to non-existing reference	1411	W-Oct-132089	W-Oct-286481
Reference link to non-existing reference	1412	W-Oct-132089	W-Oct-286500
Reference link to non-existing reference	1415	W-Oct-132089	W-Oct-286514
Reference link to non-existing reference	1416	W-Oct-132089	W-Oct-286515
Reference link to non-existing reference	1419	W-Oct-132089	W-Oct-286550
Reference link to non-existing reference	1422	W-Oct-132089	W-Oct-286564
Reference link to non-existing reference	1445	W-Oct-132089	W-Oct-287651
Reference link to non-existing reference	1540	W-Oct-132089	W-Oct-286526
Reference link to non-existing reference	1542	W-Oct-132089	W-Oct-286569
Reference link to non-existing reference	1563	W-Oct-132089	W-Oct-287662
Reference link to non-existing reference	1641	W-Oct-132089	W-Oct-286483
Reference link to non-existing reference	1643	W-Oct-132089	W-Oct-286497
Reference link to non-existing reference	1757	W-Oct-132089	W-Oct-286531
Reference link to non-existing reference	1779	W-Oct-132089	W-Oct-287667
Reference link to non-existing reference	1963	W-Oct-132089	W-Oct-286524
Reference link to non-existing reference	1983	W-Oct-132089	W-Oct-287660
Reference link to non-existing reference	2043	W-Oct-132089	W-Oct-289316
Reference link to non-existing reference	2047	W-Oct-132089	W-Oct-289398
Reference link to non-existing reference	2058	W-Oct-132089	W-Oct-289950
Reference link to non-existing reference	2072	W-Oct-132089	W-Oct-290350
Reference link to non-existing reference	2087	W-Oct-132089	W-Oct-290720
Reference link to non-existing reference	2095	W-Oct-132089	W-Oct-290886
Reference link to non-existing reference	2134	W-Oct-132089	W-Oct-409495
Reference link to non-existing reference	2135	W-Oct-132089	W-Oct-409512
Reference link to non-existing reference	2136	W-Oct-132089	W-Oct-409559
Reference link to non-existing reference	2189	W-Oct-132089	W-Oct-289948
Reference link to non-existing reference	2214	W-Oct-132089	W-Oct-290684
Reference link to non-existing reference	2215	W-Oct-132089	W-Oct-290718
Reference link to non-existing reference	2222	W-Oct-132089	W-Oct-290884
Reference link to non-existing reference	2252	W-Oct-132089	W-Oct-292038
Reference link to non-existing reference	2259	W-Oct-132089	W-Oct-409510
Reference link to non-existing reference	2260	W-Oct-132089	W-Oct-409561
Reference link to non-existing reference	2261	W-Oct-132089	W-Oct-409578
Reference link to non-existing reference	2387	W-Oct-132089	W-Oct-409516
Reference link to non-existing reference	2388	W-Oct-132089	W-Oct-409522
Reference link to non-existing reference	2389	W-Oct-132089	W-Oct-409525
Reference link to non-existing reference	2390	W-Oct-132089	W-Oct-409546
Reference link to non-existing reference	2391	W-Oct-132089	W-Oct-409547
Reference link to non-existing reference	2392	W-Oct-132089	W-Oct-409550
Reference link to non-existing reference	2393	W-Oct-132089	W-Oct-409556
Reference link to non-existing reference	2394	W-Oct-132089	W-Oct-409589
Reference link to non-existing reference	2437	W-Oct-132089	W-Oct-289455
Reference link to non-existing reference	2501	W-Oct-132089	W-Oct-292029
Reference link to non-existing reference	2505	W-Oct-132089	W-Oct-409504
Reference link to non-existing reference	2506	W-Oct-132089	W-Oct-409519
Reference link to non-existing reference	2508	W-Oct-132089	W-Oct-409568
Reference link to non-existing reference	2509	W-Oct-132089	W-Oct-409569
Reference link to non-existing reference	2553	W-Oct-132089	W-Oct-289368
Reference link to non-existing reference	2554	W-Oct-132089	W-Oct-289370
Reference link to non-existing reference	2567	W-Oct-132089	W-Oct-289901
Reference link to non-existing reference	2589	W-Oct-132089	W-Oct-290883
Reference link to non-existing reference	2628	W-Oct-132089	W-Oct-409496
Reference link to non-existing reference	2629	W-Oct-132089	W-Oct-409529
Reference link to non-existing reference	2630	W-Oct-132089	W-Oct-409532
Reference link to non-existing reference	2631	W-Oct-132089	W-Oct-409539
Reference link to non-existing reference	2632	W-Oct-132089	W-Oct-409541
Reference link to non-existing reference	2633	W-Oct-132089	W-Oct-409570
Reference link to non-existing reference	2672	W-Oct-132089	W-Oct-289319
Reference link to non-existing reference	2676	W-Oct-132089	W-Oct-289400
Reference link to non-existing reference	2693	W-Oct-132089	W-Oct-289955
Reference link to non-existing reference	2746	W-Oct-132089	W-Oct-409540
Reference link to non-existing reference	2747	W-Oct-132089	W-Oct-409571
Reference link to non-existing reference	2798	W-Oct-132089	W-Oct-289456
Reference link to non-existing reference	2803	W-Oct-132089	W-Oct-289823
Reference link to non-existing reference	2867	W-Oct-132089	W-Oct-390614
Reference link to non-existing reference	2868	W-Oct-132089	W-Oct-409503
Reference link to non-existing reference	2869	W-Oct-132089	W-Oct-409517
Reference link to non-existing reference	2870	W-Oct-132089	W-Oct-409520
Reference link to non-existing reference	2871	W-Oct-132089	W-Oct-409534
Reference link to non-existing reference	2874	W-Oct-132089	W-Oct-409567
Reference link to non-existing reference	2984	W-Oct-132089	W-Oct-409502
Reference link to non-existing reference	2985	W-Oct-132089	W-Oct-409535
Reference link to non-existing reference	2986	W-Oct-132089	W-Oct-409553
Reference link to non-existing reference	2987	W-Oct-132089	W-Oct-409583
Reference link to non-existing reference	3047	W-Oct-132089	W-Oct-289709
Reference link to non-existing reference	3100	W-Oct-132089	W-Oct-409536
Reference link to non-existing reference	3101	W-Oct-132089	W-Oct-409551
Reference link to non-existing reference	3166	W-Oct-132089	W-Oct-289953
Reference link to non-existing reference	3222	W-Oct-132089	W-Oct-409523
Reference link to non-existing reference	3223	W-Oct-132089	W-Oct-409531
Reference link to non-existing reference	3225	W-Oct-132089	W-Oct-409549
Reference link to non-existing reference	3319	W-Oct-132089	W-Oct-292031
Reference link to non-existing reference	3323	W-Oct-132089	W-Oct-409538
Reference link to non-existing reference	3324	W-Oct-132089	W-Oct-409555
Reference link to non-existing reference	3326	W-Oct-132089	W-Oct-409581
Reference link to non-existing reference	3381	W-Oct-132089	W-Oct-289963
Reference link to non-existing reference	3399	W-Oct-132089	W-Oct-290719
Reference link to non-existing reference	3439	W-Oct-132089	W-Oct-409560
Reference link to non-existing reference	3555	W-Oct-132089	W-Oct-409528
Reference link to non-existing reference	3556	W-Oct-132089	W-Oct-409545
Reference link to non-existing reference	3655	W-Oct-132089	W-Oct-292033
Reference link to non-existing reference	3662	W-Oct-132089	W-Oct-409515
Reference link to non-existing reference	3727	W-Oct-132089	W-Oct-286501
Reference link to non-existing reference	3729	W-Oct-132089	W-Oct-286525
Reference link to non-existing reference	3849	W-Oct-132089	W-Oct-409566
Reference link to non-existing reference	4025	W-Oct-132089	W-Oct-409514
--------------
SELECT 'Specialist not present in scientific names table', t1.record_id,
	t1.specialist_name, t1.specialist_code
FROM specialists AS t1
LEFT JOIN scientific_names AS t2 ON t1.specialist_code = t2.specialist_code
WHERE t2.specialist_code IS NULL
--------------

--------------
SELECT 'Reference without parent accepted or common name', t1.record_id, t1.author, t1.year,
	t1.title, t1.reference_code
FROM `references` AS t1
LEFT JOIN scientific_name_references AS t2 ON t1.reference_code = t2.reference_code
LEFT JOIN common_names AS t3 ON t1.reference_code = t3.reference_code
WHERE t2.reference_code IS NULL AND t3.reference_code IS NULL
--------------

Reference without parent accepted or common name	record_id	author	year	title	reference_code
Reference without parent accepted or common name	4	Hayward, P.J.; Nelson-Smith, A.; Shields, C.	1996	Collins pocket guide: sea shore of Britain and Europe. <i>Collins pocket guides</i>. Harper-Collins Publishers: London, UK. ISBN 0-00-219955-6. 352 pp.	W-Oct-614
Reference without parent accepted or common name	6	Hayward, P.; Nelson-Smith, A.; Shields, C.	1999	Gids van kust en strand: flora en fauna [Coast and beach guide: flora and fauna]. Tirion: Baarn, Netherlands. ISBN 90-5210-327-5. 352, ill. pp.	W-Oct-685
Reference without parent accepted or common name	7	Leewis, R.	2002	Flora en fauna van de zee [Marine flora and fauna]. <i>Veldgids</i>, 16. KNNV Uitgeverij: Utrecht, The Netherlands. ISBN 90-5011-153-X. 320 pp.	W-Oct-1116
Reference without parent accepted or common name	19	Jurgensen, H.F.E.	1927	Anthomastus. The Danish Ingolf-Expedition, Vol. V. Bianco Luno. Copenhagen. 14 p.	W-Oct-2988
Reference without parent accepted or common name	21	Logan, A.	1998	A sublittoral hard substrate epibenthic community below 30 m in Head Harbour Passage, New Brunswick, Canada	W-Oct-3000
Reference without parent accepted or common name	23	Meinkoth, N.A.	1981	Field guide to North American seashore creatures. The Audubon Society. Alfred A. Knopf. New York. 799 p.	W-Oct-3017
Reference without parent accepted or common name	24	Opresko,	1980	Opresko, 1980	W-Oct-3032
Reference without parent accepted or common name	25	Pollock, L.W.	1998	A Practical Guide to the Marine Animals of Northeastern North America.	W-Oct-3042
Reference without parent accepted or common name	26	Thomas, M.L.H. (ed.).	1983	Marine and coastal systems of the Quoddy Region, New Brunswick. Canadian Special Publication of Fisheries and Aquatic Sciences 64. 306 p.	W-Oct-3071
Reference without parent accepted or common name	29			Nomenclator Zoologicus Online	W-Oct-4181
Reference without parent accepted or common name	32	Veron, J.E.N.	1986	Corals of Australia and the Indo-Pacific. Angus & Robertson Publishers, London.	W-Oct-5874
Reference without parent accepted or common name	41	Verseveldt, J.	1969	A new species of the genus <I>Anthelia</I> (Octocorallia: Alcyonacea) from the Gulf of 'Aqaba (Red Sea). Israel Journal of Zoology 18: 325-327.	W-Oct-6415
Reference without parent accepted or common name	42	Verseveldt, J.	1970	A new species of <I>Sinularia</I> (Octocorallia: Alcyonacea) from Madagascar. Israel Journal of Zoology 19:165-168.	W-Oct-6416
Reference without parent accepted or common name	44	McFadden, C. S.	1999	Genetic and taxonomic relationships among northeastern Atlantic and Mediterranean populations of the soft coral Alcyonium corallioides	W-Oct-6808
Reference without parent accepted or common name	47	Muller, Y.	2004	Faune et flore du littoral du Nord, du Pas-de-Calais et de la Belgique: inventaire. [Coastal fauna and flora of the Nord, Pas-de-Calais and Belgium: inventory]	W-Oct-9269
Reference without parent accepted or common name	50			BIOTIC - Biological Traits Information Catalogue	W-Oct-10085
Reference without parent accepted or common name	53	Studer, T.	1878	Uebersicht der Steinkorallen aus der Familie der Madreporaria aporosa, Eupsammina und Turbinarina, welche auf der Reise S.M.S. "Gazelle" um die Erde gesammelt wurden.	W-Oct-35230
Reference without parent accepted or common name	55	Hassall A.H.	1843	Remarks on three species of marine zoophytes	W-Oct-36209
Reference without parent accepted or common name	60	Fauchald, K.	2007	World Register of Polychaeta	W-Oct-47591
Reference without parent accepted or common name	63	McIntosh, W. C.	1923	A monograph of the British marine annelids. Polychaeta, Sabellidae to Serpulidae. With additions to the British marine Polychaeta during the publication of the monograph	W-Oct-51007
Reference without parent accepted or common name	64	Quatrefages, Armand de.	1866	Histoire naturelle des Annelés marins et d'eau douce. Annélides et Géphyriens. <b>Volume 1.</b> 1-588. Librarie Encyclopédique de Roret. Paris. [<b>some vol.2 species are also linked here but see also source 51472</b>].	W-Oct-51461
Reference without parent accepted or common name	65	Linnaeus, C.	1788	Systema Naturae per regna tria naturae, secundum classes, ordines, genera, species, cum characteribus differentiis, synonymis, locis.	W-Oct-100017
Reference without parent accepted or common name	73	Breedy, O.; M. guzman, H.	1999	A new species of alcyonacean octocoral from the Galápagos Archipelago	W-Oct-128170
Reference without parent accepted or common name	74	Cairns, S. D.; Bayer, F. M.	2003	Studies on western Atlantic Octocorallia (Coelenterata: Anthozoa). Part 3. The genus Narella Gray, 1870	W-Oct-128217
Reference without parent accepted or common name	77	Williams.	2003	Capitate taxa of the soft coral genus Eleutherobia (Octocorallia:  Alcyoniidae) from Palau and South Africa;  a new species and a new combination. Zoologische Verhandelingen (Leiden) 345: 419-436	W-Oct-129636
Reference without parent accepted or common name	78	Cairns, S. D.; Bayer, F. M.	2003	Studies on western Atlantic Octocorallia (Coelenterata: Anthozoa). Part 2. The genus Callogorgia Gray, 1858	W-Oct-129698
Reference without parent accepted or common name	79	Alderslade, P.	2003	A new genus and new species of soft coral (Octocorallia: Alcyonacea: Alcyoniidae) from the south western region of Australia	W-Oct-130523
Reference without parent accepted or common name	82			Davorin Tome	W-Oct-138974
Reference without parent accepted or common name	86	Roberts, J.M., A. Wheeler, A. Freiwald, and S.D. Cairns,	2009	Cold-Water Corals: The Biology and Geology of Deep-Sea Coral Habitats. Cambridge University Press, Cambridge.  334 pp.	W-Oct-142536
Reference without parent accepted or common name	89			Unterwasser-Welt Ostsee	W-Oct-147412
Reference without parent accepted or common name	103	Breedy, O.; Guzman, H. M.	2011	A revision of the genus Heterogorgia Verrill, 1868 (Anthozoa: Octocorallia: Plexauridae)	W-Oct-153348
Reference without parent accepted or common name	106	Zenetos, A.; Gofas, S.; Verlaque, M.; Cinar, M.; Garcia Raso, J.; Bianchi, C.; Morri, C.; Azzurro, E.; Bilecenoglu, M.; Froglia, C.; Siokou, I.; Violanti, D.; Sfriso, A.; San Martin, G.; Giangrande, A	2010	Alien species in the Mediterranean Sea by 2010. A contribution to the application of European Union’s Marine Strategy Framework Directive (MSFD). Part I. Spatial distribution	W-Oct-155063
Reference without parent accepted or common name	131	Alderslade, P.	1994	A redescription of Anthomastus agilis Tixier-Durivault with a generic placement in Sinularia (Coelenterata: Octocorallia), and some remarks on Sinularia ramosa Tixier-Durivault. The Beagle 11: 133-139	W-Oct-170818
Reference without parent accepted or common name	141	Maldonado, M., M. López-Acosta, L. Sánchez-Tocino & C. Sitjà,	2013	The rare, giant gorgonian Ellisella paraplexauroides:demographics and conservation concerns. Marine Ecology  Progres Series 479: 127–141.	W-Oct-171467
Reference without parent accepted or common name	159	Stiasny, G.	1937	Gorgonaria von Setubal. Arquivos do Museu	W-Oct-176232
Reference without parent accepted or common name	166	Galil, B.	2007	Seeing Red: Alien species along the Mediterranean coast of Israel	W-Oct-190896
Reference without parent accepted or common name	167	Trott, T. J.	2004	Cobscook Bay inventory: a historical checklist of marine invertebrates spanning 162 years	W-Oct-192633
Reference without parent accepted or common name	174	Alderslade, P.	2007	New subfamilies and a new genus and species of Melithaeidae (Coelenterata: Octocorallia: Alcyonacea) with comparative data on the structure of both melithaeid and subergorgiid axes	W-Oct-196638
Reference without parent accepted or common name	178	Cairns, S.D.	2007	Studies on western Atlantic Octocorallia (Gorgonacea: Primnoidae). Part 8: New records of Primnoidae from the New England and Corner Rise Seamounts	W-Oct-196754
Reference without parent accepted or common name	187	Wallace, C. C.	2008	New Species and Records from the Eocene of England and France Support Early Diversification of the Coral Genus Acropora	W-Oct-220936
Reference without parent accepted or common name	189	Bayer, F. M.	1990	A new isidid octocoral (Anthozoa: Gorgonacea) from New Caledonia, with descriptions of other new species from elsewhere in the Pacific Ocean	W-Oct-221792
Reference without parent accepted or common name	197	Verseveldt, J.	1974	Alcyonacea (Octocorallia) from the Red Sea, with a discussion of a new Sinularia species from Ceylon	W-Oct-230307
Reference without parent accepted or common name	202	Griffiths, H. J.; Waller, C. L.	2016	The first comprehensive description of the biodiversity and biogeography of Antarctic and Sub-Antarctic intertidal communities	W-Oct-231440
Reference without parent accepted or common name	211	Alderslade, P.	2002	A new soft coral genus (Coelenterata: Octocorallia) from Palau	W-Oct-240130
Reference without parent accepted or common name	214	Cairns, S. D.; Bayer, F. M.	2003	Studies on western Atlantic Octocorallia (Coelenterata: Anthozoa). Part 2: The genus Callogorgia Gray, 1858	W-Oct-240206
Reference without parent accepted or common name	215	Bayer, F. M.	2000	A new species of Leptogorgia from the eastern Pacific (Coelenterata: Octocorallia: Holaxonia)	W-Oct-240207
Reference without parent accepted or common name	217	Benayahu, Y.; Perkol-Finkel, S.	2004	Soft Corals (Octocorallia: Alcyonacea) from southern Taiwan: I. Sarcophyton nanwanensis sp. nov.(Octocorallia: Alcyonacea)	W-Oct-240228
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
CREATE TEMPORARY TABLE duplicates_to_delete AS
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus,
	dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
FROM
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
	FROM scientific_names
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id
	HAVING cnt > 1) AS dups
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
WHERE sn.sp2000_status_id = 1 AND sn.name_code NOT IN
	(SELECT dups3.namecodes_to_keep FROM
		(SELECT MAX(name_code) AS namecodes_to_keep, genus, subgenus, species, infraspecies_marker, infraspecies, author FROM
			(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, dups.species AS species,
				dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
			FROM
				(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
				FROM scientific_names
				GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
			LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
			WHERE sn.sp2000_status_id = 1) AS dups2
		GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
DELETE QUICK FROM scientific_names
USING scientific_names
INNER JOIN duplicates_to_delete ON scientific_names.name_code = duplicates_to_delete.name_code
--------------

--------------
DELETE QUICK t1 FROM common_names AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.accepted_name_code = t2.name_code
WHERE t2.name_code IS NULL AND t1.is_accepted_name != 1
--------------

--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.infraspecies_parent_name_code = t2.name_code
WHERE t1.infraspecies_parent_name_code IS NOT NULL AND t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM lifezone AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
OPTIMIZE TABLE lifezone
--------------

Table	Op	Msg_type	Msg_text
Assembly_Octocorallia.lifezone	optimize	status	OK
--------------
DELETE QUICK t1 FROM distribution AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
OPTIMIZE TABLE distribution
--------------

Table	Op	Msg_type	Msg_text
Assembly_Octocorallia.distribution	optimize	status	OK
--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN families AS t2 ON t1.family_code = t2.family_code
WHERE t2.family_code IS NULL
--------------

--------------
OPTIMIZE TABLE scientific_names
--------------

Table	Op	Msg_type	Msg_text
Assembly_Octocorallia.scientific_names	optimize	status	OK
--------------
DELETE QUICK t1 FROM scientific_name_references AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM scientific_name_references AS t1
LEFT JOIN `references` AS t2 ON t1.reference_code = t2.reference_code
WHERE t2.reference_code IS NULL
--------------

--------------
OPTIMIZE TABLE scientific_name_references
--------------

Table	Op	Msg_type	Msg_text
Assembly_Octocorallia.scientific_name_references	optimize	status	OK
--------------
DELETE QUICK t1 FROM specialists AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.specialist_code = t2.specialist_code
WHERE t2.specialist_code IS NULL
--------------

--------------
DELETE t1 FROM `references` AS t1
LEFT JOIN scientific_name_references AS t2 ON t1.reference_code = t2.reference_code
LEFT JOIN common_names AS t3 ON t1.reference_code = t3.reference_code
WHERE t2.reference_code IS NULL AND t3.reference_code IS NULL
--------------

--------------
OPTIMIZE TABLE `references`
--------------

Table	Op	Msg_type	Msg_text
Assembly_Octocorallia.references	optimize	status	OK
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

</pre>
<pre>
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Editorial and Integrity checks Completed.
</pre>
</pre><hr><b>Replacing sectors in Assembly Global database</b>
<pre>
<pre>
Starting Sector Management
--------------
SET @dbid = 131
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
DELETE FROM ",
@dbtouse,
".`databases` WHERE `record_id` = @dbid")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`families` SELECT 
NULL AS `record_id`,
`hierarchy_code`,	
`kingdom`,	
`phylum`,	
`class`,	
`order`,	
`family`,	
`superfamily`, 	
`database_id`, 	
`family_code`,
`is_accepted_name`
FROM  `families`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`databases` SELECT 
`database_name_displayed`, 
`record_id`, 
`database_name`, 
`database_full_name`, 
`web_site`, 
`organization`, 
`contact_person`, 
`taxa`, 
`taxonomic_coverage`, 
`abstract`, 
`version`, 
`release_date`, 
`SpeciesCount`, 
`SpeciesEst`, 
`authors_editors`, 
`accepted_species_names`, 
`accepted_infraspecies_names`, 
`species_synonyms`, 
`infraspecies_synonyms`, 
`common_names`, 
`total_names`, 
`is_new`,
`coverage`,
`completeness`,
`confidence`
FROM `databases`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_names` 
(`record_id`, `name_code`, `web_site`, `genus`, `subgenus`, `species`, `infraspecies_parent_name_code`, `infraspecies`, `infraspecies_marker`, `author`, `accepted_name_code`, `comment`, `scrutiny_date`, `sp2000_status_id`, `database_id`, `specialist_id`, `family_id`, `specialist_code`, `family_code`, `is_accepted_name`, `GSDTaxonGUID`, `GSDNameGUID`, `is_extinct`, `has_preholocene`, `has_modern`) SELECT 
NULL AS `record_id`, 
`name_code`, 
`web_site`, 
`genus`, 
`subgenus`, 
`species`, 
`infraspecies_parent_name_code`, 
`infraspecies`, 
`infraspecies_marker`, 
`author`, 
`accepted_name_code`, 
`comment`, 
`scrutiny_date`, 
`sp2000_status_id`, 
`database_id`, 
`specialist_id`, 
`family_id`, 
`specialist_code`, 
`family_code`, 
`is_accepted_name`, 
`GSDTaxonGUID`, 
`GSDNameGUID`, 
`is_extinct`,
`has_preholocene`, 
`has_modern`
FROM `scientific_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`common_names` SELECT 
NULL AS `record_id`, 
`name_code`, 
`common_name`, 
`transliteration`, 
`language`, 
`country`, 
`area`, 
NULL AS `reference_id`, 
`database_id`, 
`is_infraspecies`, 
`reference_code`
FROM  `common_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`distribution` SELECT 
NULL AS `record_id`, 
`name_code`, 
`distribution`, 
`StandardInUse`, 
`DistributionStatus`,
`database_id`
FROM  `distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`lifezone` SELECT 
NULL AS `record_id`,
`name_code`, 	
`lifezone`,
`database_id`
FROM  `lifezone`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_name_references` SELECT 
NULL AS `record_id`,
`name_code`,	
`reference_type`, 	
NULL AS `reference_id`,	
`reference_code`,
`database_id`
FROM  `scientific_name_references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`references` SELECT 
NULL AS `record_id`, 
`author`, 
`year`, 
`title`, 
`source`, 
`database_id`, 
`reference_code`
FROM  `references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`specialists` SELECT 
NULL AS `record_id`,
`specialist_name`,
`specialist_code`,
`database_id`
FROM  `specialists`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Transformations Completed.
<pre>
</pre><hr><b>Chain completed</b>
</body></html>
