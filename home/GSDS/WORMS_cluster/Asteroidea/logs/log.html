<html><body>
<br><b>Harvesting...</b>
<pre>
</pre><hr><b>File format conversions...</b>
<pre>
Unzipping
Archive:  WoRMS_Asteroidea.zip
  inflating: AcceptedSpecies.txt     
  inflating: AcceptedInfraSpecificTaxa.txt  
  inflating: Synonyms.txt            
  inflating: CommonNames.txt         
  inflating: Distribution.txt        
  inflating: References.txt          
  inflating: NameReferencesLinks.txt  
  inflating: SourceDatabase.txt      
Skipping format conversion
</pre><hr><b>Creating buffer database, performing structural transformations...</b>
<pre>
<pre>
Initiating buffer creation - this may take a while depending on size of the dataset...

Creating buffer database Buffer_Asteroidea in schema as provided by Asteroidea
--------------
DROP DATABASE IF EXISTS Buffer_Asteroidea
--------------

--------------
CREATE DATABASE IF NOT EXISTS Buffer_Asteroidea
--------------

--------------
CREATE TABLE `AcceptedInfraSpecificTaxa` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`ParentSpeciesID` varchar(50) default NULL,
`InfraSpeciesEpithet` varchar(50) default NULL,
`InfraSpecificAuthorString` varchar(50) default NULL,
`InfraSpecificMarker` varchar(10) default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`InfraSpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI`  varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `AcceptedSpecies` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`Kingdom` varchar(50) default NULL,
`Phylum` varchar(50) default NULL,
`Class` varchar(50) default NULL,
`Order` varchar(50) default NULL,
`Superfamily` varchar(50) default NULL,
`Family` varchar(50) default NULL,
`Genus` varchar(50) default NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) default NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`SpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `CommonNames` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`CommonName` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Transliteration` varchar(255) default NULL,
`Language` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Country`  varchar(255) default NULL,
`Area`  varchar(255) default NULL,
`ReferenceID` varchar(50) default NULL,
PRIMARY KEY (`record_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `Distribution` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Distribution` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`StandardInUse` varchar(50) default NULL,
`DistributionStatus` varchar(50) default NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `References` (
`ReferenceID` varchar(50) PRIMARY KEY,
`Authors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Year` varchar(255) default NULL,
`Title` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Details` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `NameReferencesLinks` (
`ID` integer(10) PRIMARY KEY,
`ReferenceType` varchar(50) default NULL,
`ReferenceID` varchar(50) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `SourceDatabase` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`DatabaseFullName` varchar(255) NOT NULL,
`DatabaseShortName` varchar(50) NOT NULL,
`DatabaseVersion` varchar(50) NOT NULL,
`ReleaseDate` varchar(50) NOT NULL,
`AuthorsEditors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`TaxonomicCoverage` varchar(255) NOT NULL,
`GroupNameInEnglish` varchar(255) NOT NULL,
`Abstract` text  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Organisation` varchar(255) NOT NULL,
`HomeURL` varchar(255) default NULL,
`Coverage` varchar(50) default NULL,
`Completeness` integer(3) default NULL,
`Confidence` integer(1) default NULL,
`LogoFileName`  varchar(255) default NULL,
`ContactPerson` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `Synonyms` (
`ID` integer(10) PRIMARY KEY,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Genus` varchar(50) NOT NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) NOT NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`InfraSpecies` varchar(50) default NULL,
`InfraSpecificMarker` varchar(50) default NULL,
`InfraSpecificAuthorString`  varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`GSDNameGUI` varchar(255) default NULL 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedInfraSpecificTaxa.txt' INTO TABLE `AcceptedInfraSpecificTaxa` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES 
(`AcceptedTaxonID`, `ParentSpeciesID`, `InfraSpeciesEpithet`, `InfraSpecificAuthorString`,  `InfraSpecificMarker`, `GSDNameStatus`,  `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `InfraSpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedSpecies.txt' INTO TABLE `AcceptedSpecies` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Kingdom`, `Phylum`, `Class`, `Order`, `Superfamily`, `Family`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `SpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'CommonNames.txt' INTO TABLE `CommonNames` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `CommonName`, `Transliteration`, `Country`, `Area`, `Language`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Distribution.txt' INTO TABLE `Distribution` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Distribution`, `StandardInUse`, `DistributionStatus`)
--------------

--------------
LOAD DATA LOCAL INFILE 'NameReferencesLinks.txt' INTO TABLE NameReferencesLinks CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `ReferenceType`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'References.txt' INTO TABLE `References` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ReferenceID`, `Authors`, `Year`, `Title`, `Details`)
--------------

--------------
LOAD DATA LOCAL INFILE 'SourceDatabase.txt' INTO TABLE `SourceDatabase` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`DatabaseFullName`, `DatabaseShortName`, `DatabaseVersion`, `ReleaseDate`, `AuthorsEditors`, `TaxonomicCoverage`, `GroupNameInEnglish`, `Abstract`, `Organisation`, `HomeURL`, `Coverage`, `Completeness`, `Confidence`, `LogoFileName`, `ContactPerson`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Synonyms.txt' INTO TABLE `Synonyms` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `AcceptedTaxonID`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `InfraSpecies`, `InfraSpecificMarker`, `InfraSpecificAuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `GSDNameGUI`)
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!



Initial database created. Creating database Assembly_Asteroidea in assembly schema
--------------
DROP DATABASE IF EXISTS Assembly_Asteroidea
--------------

--------------
CREATE DATABASE IF NOT EXISTS Assembly_Asteroidea
--------------

--------------
DROP TABLE IF EXISTS `databases`
--------------

--------------
CREATE TABLE  `databases` (
  `database_name_displayed` varchar(125) DEFAULT NULL,
  `record_id` int(10) NOT NULL AUTO_INCREMENT,
  `database_name` varchar(150) DEFAULT NULL,
  `database_full_name` varchar(100) NOT NULL DEFAULT '',
  `web_site` longtext,
  `organization` longtext,
  `contact_person` varchar(255) DEFAULT NULL,
  `taxa` varchar(255) DEFAULT NULL,
  `taxonomic_coverage` longtext,
  `abstract` longtext,
  `version` varchar(255) DEFAULT NULL,
  `release_date` date DEFAULT '0000-00-00',
  `SpeciesCount` int(11) DEFAULT 0,
  `SpeciesEst` int(11) DEFAULT 0,
  `authors_editors` longtext,
  `accepted_species_names` int(10) DEFAULT 0,
  `accepted_infraspecies_names` int(10) DEFAULT 0,
  `species_synonyms` int(10) DEFAULT 0,
  `infraspecies_synonyms` int(10) DEFAULT 0,
  `common_names` int(10) DEFAULT 0,
  `total_names` int(10) DEFAULT 0,
  `is_new` tinyint(1) NOT NULL DEFAULT 0,
  `coverage` varchar(45) DEFAULT NULL,
  `completeness` int(3) unsigned DEFAULT 0,
  `confidence` 	tinyint(1) unsigned DEFAULT 0,
  PRIMARY KEY (`record_id`),
  KEY `database_name` (`database_name`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `families`
--------------

--------------
CREATE TABLE  `families` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `hierarchy_code` varchar(250) NOT NULL,
  `kingdom` varchar(50) NOT NULL DEFAULT 'Not Assigned',
  `phylum` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `class` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `order` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `family` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `superfamily` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  `family_code` varchar(50) NOT NULL,
  `is_accepted_name` int(1) unsigned,
  PRIMARY KEY (`record_id`),
  KEY (`family_code`),
  KEY `kingdom` (`kingdom`),
  KEY `phylum` (`phylum`),
  KEY `class` (`class`),
  KEY `order` (`order`),
  KEY `family` (`family`),
  KEY `superfamily` (`superfamily`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `sp2000_statuses`
--------------

--------------
CREATE TABLE  `sp2000_statuses` (
  `record_id` int(1) NOT NULL AUTO_INCREMENT,
  `sp2000_status` varchar(50) NOT NULL DEFAULT '',
  PRIMARY KEY (`record_id`)
) ENGINE=MyISAM
--------------

--------------
DROP TABLE IF EXISTS `scientific_names`
--------------

--------------
CREATE TABLE  `scientific_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `web_site` longtext,
  `genus` varchar(50) DEFAULT NULL,
  `subgenus` varchar(50) DEFAULT NULL,
  `species` varchar(60) DEFAULT NULL,
  `infraspecies_parent_name_code` varchar(42) DEFAULT NULL,
  `infraspecies` varchar(50) DEFAULT NULL,
  `infraspecies_marker` varchar(50) DEFAULT NULL,
  `author` varchar(100) DEFAULT NULL,
  `accepted_name_code` varchar(42) DEFAULT NULL,
  `comment` longtext,
  `scrutiny_date` text,
  `sp2000_status_id` int(1) DEFAULT NULL,
  `database_id` int(10) DEFAULT NULL,
  `specialist_id` int(10) DEFAULT NULL,
  `family_id` int(10) DEFAULT NULL,
  `specialist_code` varchar(50) DEFAULT NULL,
  `family_code` varchar(50) DEFAULT NULL,
  `is_accepted_name` int(1) DEFAULT NULL,
  `GSDTaxonGUID` longtext,
  `GSDNameGUID` longtext,
  `is_extinct` smallint(1) NOT NULL DEFAULT '0',
  `has_preholocene` smallint(1) NOT NULL DEFAULT '0',
  `has_modern` smallint(1) NOT NULL DEFAULT '1',
  PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `specialist_code` (`specialist_code`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `common_names`
--------------

--------------
CREATE TABLE  `common_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `common_name` varchar(700) NOT NULL,
  `transliteration` varchar(700),
  `language` varchar(25) NOT NULL,
  `country` varchar(44) NOT NULL DEFAULT '',
  `area` varchar(50) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `database_id` int(10) NOT NULL,
  `is_infraspecies` int(1) NOT NULL DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `common_name` (`common_name`),
  KEY `reference_code` (`reference_code`),
  KEY `name_code` (`name_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `distribution`
--------------

--------------
CREATE TABLE  `distribution` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `distribution` longtext,
  `StandardInUse` varchar(255) DEFAULT NULL,
  
   `DistributionStatus` varchar(255),
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `lifezone`
--------------

--------------
CREATE TABLE  `lifezone` (
  `record_id` int(11) NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42),
  `lifezone` varchar(255),
  `database_id` int(10),
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `scientific_name_references`
--------------

--------------
CREATE TABLE  `scientific_name_references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `reference_type` varchar(10) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`,`reference_id`,`reference_type`),
  KEY `reference_code` (`reference_code`),
  KEY `name_code_2` (`name_code`,`reference_type`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `references`
--------------

--------------
CREATE TABLE  `references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `author` varchar(200) DEFAULT NULL,
  `year` varchar(50) DEFAULT NULL,
  `title` longtext,
  `source` longtext,
  `database_id` int(10) NOT NULL,
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `reference_code` (`reference_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `specialists`
--------------

--------------
CREATE TABLE  `specialists` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `specialist_name` varchar(255) NOT NULL DEFAULT '',
  `specialist_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `specialist_code` (`specialist_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
INSERT INTO `sp2000_statuses` 
VALUES (1,'accepted name'),
(2,'ambiguous synonym'),
(3,'misapplied name'),
(4,'provisionally accepted name'),
(5,'synonym')
--------------

--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Creation of the assembly database completed.

Starting structural transformations (ACEF3 to ACI)
--------------
SET @dbid = 95
--------------

--------------
SET @dbabbr = 'W-Ase-'
--------------

--------------
SET @dbtouse = 'Buffer_Asteroidea'
--------------

--------------
SET foreign_key_checks = 0
--------------

--------------
TRUNCATE TABLE `databases`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `databases`
 SELECT
 CONCAT(`DatabaseShortName`, ': ', `DatabaseFullName`)  AS `database_name_displayed`,
 @dbid AS `record_id`,
 `DatabaseShortName` AS `database_name`,
 `DatabaseFullName` AS `database_full_name`,
  `HomeURL` AS `web_site`,
  `Organisation` AS `organization`,
  `ContactPerson` AS `contact_person`,
  `GroupNameInEnglish` AS `taxa`,
  `TaxonomicCoverage` AS `taxonomic_coverage`,
  `Abstract` AS `abstract`,
  `DatabaseVersion` AS `version`,
  `ReleaseDate` AS `release_date`,
  `Coverage` AS `SpeciesCount`,
  `Completeness` AS `SpeciesEst`,
  `AuthorsEditors` AS `authors_editors`,
  NULL AS `accepted_species_names`,
  NULL AS `accepted_infraspecies_names`,
  NULL AS `species_synonyms`,
  NULL AS `infraspecies_synonyms`,
  NULL AS `common_names`,
  NULL AS `total_names`,
  NULL AS `is_new`,
  NULL AS `coverage`,
  NULL AS `completeness`,
  NULL AS `confidence`
  FROM ",
@dbtouse,
".`SourceDatabase`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `distribution`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `distribution`
 SELECT
 NULL AS `record_id`,
 CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
 `Distribution` AS `distribution`,
 `StandardInUse` AS `StandardInUse`,
 `DistributionStatus` AS `DistributionStatus`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`Distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `families`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `families`
SELECT DISTINCT
NULL AS `record_id`,
NULL AS `hierarchy_code`,
`Kingdom` AS `kingdom`,
`Phylum` AS `phylum`,
`Class` AS `class`,
`Order` AS `order`,
`Family` AS `family`,
`Superfamily` AS `superfamily`,
@dbid AS `database_id`,
NULL AS `family_code`,
NULL AS `is_accepted_name`
FROM ",
@dbtouse,
".`AcceptedSpecies`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `families` SET `family_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `specialists`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `specialists`
SELECT DISTINCT
NULL  AS `record_id`,
`LTSSpecialist` AS `specialist_name`,
NULL AS `specialist_code`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LTSSpecialist` IS NOT NULL OR
`LTSSpecialist` != ''")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `specialists` SET `specialist_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `scientific_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`SpeciesURL` AS `web_site`,
`Genus` AS `genus`,
`SubGenusName` AS `subgenus`,
`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
NULL  AS `infraspecies`,
NULL  AS `infraspecies_marker`,
`AuthorString` AS `author`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `accepted_name_code`,
`AdditionalData` AS `comment`,
`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
`specialists`.`record_id` AS `specialist_id`,
`families`.`record_id` AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
`families`.`family_code` AS `family_code`,
1 AS `is_accepted_name`,
`GSDTaxonGUI` AS `GSDTaxonGUI`,
`GSDNameGUI` AS `GSDNameGUI`,
`IsFossil` AS `is_extinct`,
`IsFossil` AS `has_preholocene`,
if (`IsFossil` = 0, 1, 0) AS `has_modern`
FROM ",
@dbtouse,
".`AcceptedSpecies` AcceptedSpecies
LEFT OUTER JOIN `families` ON
(`AcceptedSpecies`.`Kingdom` = `families`.`kingdom` AND
`AcceptedSpecies`.`Phylum` = `families`.`phylum` AND
`AcceptedSpecies`.`Class` = `families`.`class` AND
`AcceptedSpecies`.`Order` = `families`.`order` AND
`AcceptedSpecies`.`Superfamily` = `families`.`superfamily` AND
`AcceptedSpecies`.`Family` = `families`.`family`)
LEFT OUTER JOIN `specialists` ON
`AcceptedSpecies`.`LTSSpecialist` = `specialists`.`specialist_name`
LEFT OUTER JOIN `sp2000_statuses` ON
`AcceptedSpecies`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `lifezone`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `lifezone`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`LifeZone` AS `lifezone`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LifeZone` IN('marine','freshwater','Marine','Freshwater')")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `name_code`,
NULL AS `web_site`,
`sn`.`genus` AS `genus`,
NULL AS `subgenus`,
`sn`.`species` AS `species`,
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) AS `infraspecies_parent_name_code`,
`AIT`.`InfraSpeciesEpithet` AS `infraspecies`,
`AIT`.`InfraSpecificMarker` AS `infraspecies_marker`,
`AIT`.`InfraSpecificAuthorString` AS `author`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `accepted_name_code`,
`AIT`.`AdditionalData` AS `comment`,
`AIT`.`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
sn.family_code AS `family_code`,
1 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`AIT`.`GSDNameGUI` AS `GSDNameGUI`,
`IsFossil` AS `is_extinct`,
`IsFossil` AS `has_preholocene`,
if (`IsFossil` = 0, 1, 0) AS `has_modern`
FROM ",
@dbtouse,
".`AcceptedInfraSpecificTaxa` AIT
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`AIT`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`
LEFT OUTER JOIN `specialists` ON
`AIT`.`LTSSpecialist` = `specialists`.`specialist_name`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr,`Synonyms`.`ID`) AS `name_code`,
NULL AS `web_site`,
`Synonyms`.`Genus` AS `genus`,
`Synonyms`.`SubGenusName` AS `subgenus`,
`Synonyms`.`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
`Synonyms`.`InfraSpecies` AS `infraspecies`,
`Synonyms`.`InfraSpecificMarker` AS `infraspecies_marker`,
`Synonyms`.`AuthorString` AS `author`,
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) AS `accepted_name_code`,
NULL AS `comment`,
NULL AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
sn.`specialist_code` AS `specialist_code`,
sn.`family_code` AS `family_code`,
0 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`Synonyms`.`GSDNameGUI` AS `GSDNameGUI` ,
0 AS `is_extinct`,
0 AS `has_preholocene`,
1 AS `has_modern`
FROM ",
@dbtouse,
".`Synonyms` Synonyms
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`Synonyms`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `common_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `common_names`
SELECT
NULL,
CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
CONVERT(`CommonName` USING utf8) AS `common_name`,
`Transliteration` AS `transliteration`,
`Language` AS `language`,
`Country` AS `country`,
`Area` AS `area`,
 NULL AS `reference_ID`,
@dbid AS `database_ID`,
 NULL AS `is_infraspecies`,
 `ReferenceID` AS `reference_code`
 FROM ",
@dbtouse,
".`CommonNames`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `references`
SELECT
NULL AS `record_id`,
`Authors` AS `author`,
`Year` AS `year`,
`Title` AS `title`,
`Details` AS `source`,
@dbid AS `database_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`
 FROM ",
@dbtouse,
".`References`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `scientific_name_references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_name_references`
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr, `ID`) AS `name_code`,
`ReferenceType` AS `reference_type`,
NULL AS `reference_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`NameReferencesLinks`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET foreign_key_checks = 1
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Data Loaded.
</pre>
</pre><hr><b>Backing up...</b>
<pre>
Creating directory  23_00_06_05Oct2016
Backing up files
</pre><hr><b>Executing local editorial checks</b>
<pre>
<pre>
Integrity and editorial checks - this may take a while depending on size of the dataset...

Starting local editorial transformations
--------------
UPDATE `databases` SET `taxonomic_coverage`="Animalia - Echinodermata - Asteroidea", `is_new` = 2, `taxa`="Starfish or sea stars", `coverage`="Global", `completeness` = 96, `confidence` = 5
--------------

--------------
DELETE FROM `common_names` WHERE `common_name` IS NULL OR `common_name` = ""
--------------

--------------
DELETE FROM `distribution` WHERE `distribution` IS NULL OR `distribution` = ""
--------------

--------------
DELETE FROM `references` WHERE (`title` IS NULL OR `title` = "") AND (`author` IS NULL OR `author` = "")
--------------

--------------
DELETE FROM `specialists` WHERE `specialist_name` IS NULL OR `specialist_name` = ""
--------------

--------------
DELETE FROM `scientific_names` WHERE (`species` IS NULL OR `species` LIKE "%sp.%" OR `species` LIKE "%spp.%") AND `infraspecies` IS NULL
--------------

--------------
DELETE FROM `scientific_names` WHERE `genus` IS NULL OR `genus` = "" OR genus like "% %" OR `genus` LIKE '%sp.%' OR `genus` LIKE "%spp.%"
--------------

--------------
UPDATE `scientific_names` SET `family_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `specialist_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "forma" WHERE `infraspecies_marker` LIKE "f.%"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "var." WHERE `infraspecies_marker` LIKE "Variety"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "subsp." WHERE `infraspecies_marker` LIKE "Subspecies"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "subsp." WHERE `infraspecies_marker` LIKE "ssp."
--------------

--------------
UPDATE `scientific_names` SET `sp2000_status_id` = 5 WHERE `sp2000_status_id` IS NULL AND `is_accepted_name` = 0
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE `family` LIKE "% %"
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE `order` LIKE "% %"
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE `class` LIKE "% %"
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE `phylum` LIKE "% %"
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE `kingdom` LIKE "% %"
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE (`family` IS NULL OR `family` = '')
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE (`order` IS NULL OR `order` = '')
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE (`class` IS NULL OR `class` = '')
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE (`phylum` IS NULL OR `phylum` = '')
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE (`kingdom` IS NULL OR `kingdom` = '')
--------------

--------------
UPDATE `families` SET `hierarchy_code` = CONCAT(`kingdom`,'-',`phylum`,'-',`class`,'-',`order`,'-',`family`)
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "subsequent type designation%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "Nom%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "taxonomy source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "additional source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "original description%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "source of synonymy%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "basis of record%"
--------------

--------------
UPDATE `databases` SET database_name_displayed = REPLACE(database_name_displayed,'_',' ')
--------------

--------------
UPDATE `databases` SET database_name = REPLACE(database_name,'_',' ')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ',', '')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ';', ',')
--------------

--------------
SELECT "Misspelt infraspecies (no subgenus): ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND
(`subgenus` IS NULL OR `subgenus` = '') AND
`infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%')
--------------

--------------
SELECT "Misspelt infraspecies (with subgenus): ", `name_code`, `genus`, `subgenus`, `species`, `infraspecies` FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND
`subgenus` != '' AND
(`infraspecies` NOT LIKE CONCAT(`genus`, ' (', `subgenus`, ') ', `species`, '%') OR `infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%'))
--------------

--------------
DELETE FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND
(`subgenus` IS NULL OR `subgenus` = '') AND
`infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%')
--------------

--------------
DELETE FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
`infraspecies` LIKE CONCAT(`genus`, '%') AND
`subgenus` != '' AND
(`infraspecies` NOT LIKE CONCAT(`genus`, ' (', `subgenus`, ') ', `species`, '%') OR `infraspecies` NOT LIKE CONCAT(`genus`, ' ', `species`, '%'))
--------------

--------------
SELECT "Incorrect infraspecies: ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names`
WHERE `infraspecies` LIKE '% %'  AND
`infraspecies` NOT LIKE 'f.%' AND
`infraspecies` NOT LIKE 'var.%' AND
`infraspecies` NOT LIKE 'subsp.%'
--------------

Incorrect infraspecies: 	name_code	genus	species	infraspecies
Incorrect infraspecies: 	W-Ase-369068	Lysastrosoma	anthosticta	Lysastroma anthosticta anthosticta
--------------
DELETE FROM `scientific_names`
WHERE `infraspecies` LIKE '% %'  AND
`infraspecies` NOT LIKE 'f.%' AND
`infraspecies` NOT LIKE 'var.%' AND
`infraspecies` NOT LIKE 'subsp.%'
--------------

--------------
SELECT "Infraspecies starting with marker: ", `name_code`, `genus`, `species`, `infraspecies` FROM `scientific_names`
WHERE `infraspecies` LIKE '% %' AND
(`infraspecies` LIKE 'f.%' OR
`infraspecies` LIKE 'var.%' OR
`infraspecies` LIKE 'subsp.%')
--------------

Infraspecies starting with marker: 	name_code	genus	species	infraspecies
Infraspecies starting with marker: 	W-Ase-224150	Marthasterias	glacialis	f. africana
Infraspecies starting with marker: 	W-Ase-234961	Acodontaster	elongatus	f. capitatus
Infraspecies starting with marker: 	W-Ase-380241	Luidia	maculata	f. herdmani
Infraspecies starting with marker: 	W-Ase-172770	Acodontaster	hodgsoni	f. hodgsoni
Infraspecies starting with marker: 	W-Ase-125263	Cribrella	sanguinolenta	f. laevior
Infraspecies starting with marker: 	W-Ase-125265	Echinaster	oculatus	f. major
Infraspecies starting with marker: 	W-Ase-125266	Echinaster	oculatus	f. minor
Infraspecies starting with marker: 	W-Ase-765421	Culcita	novaeguineae	f. nesiotis
Infraspecies starting with marker: 	W-Ase-762312	Culcita	novaeguineae	f. novaeguineae
Infraspecies starting with marker: 	W-Ase-881613	Nardoa	tuberculata	f. pauciforis
Infraspecies starting with marker: 	W-Ase-224151	Marthasterias	glacialis	f. rarispina
Infraspecies starting with marker: 	W-Ase-125264	Cribrella	sanguinolenta	f. scabrior
Infraspecies starting with marker: 	W-Ase-172771	Acodontaster	hodgsoni	f. stellatus
Infraspecies starting with marker: 	W-Ase-172744	Henricia	smilax	f. tenuis
Infraspecies starting with marker: 	W-Ase-234962	Acodontaster	elongatus	var. abbreviatus
Infraspecies starting with marker: 	W-Ase-125239	Freyella	spinosa	var. abyssicola
Infraspecies starting with marker: 	W-Ase-125247	Cribrella	sanguinolenta	var. abyssicola
Infraspecies starting with marker: 	W-Ase-762313	Culcita	novaeguineae	var. acutispinosa
Infraspecies starting with marker: 	W-Ase-224166	Culcita	schmideliana	var. africana
Infraspecies starting with marker: 	W-Ase-379325	Asterias	epichlora	var. alaskensis
Infraspecies starting with marker: 	W-Ase-125242	Stichaster	roseus	var. ambigua
Infraspecies starting with marker: 	W-Ase-828503	Astropecten	michaelseni	var. ambiguus
Infraspecies starting with marker: 	W-Ase-423760	Solaster	dawsoni	var. arctica
Infraspecies starting with marker: 	W-Ase-762316	Culcita	novaeguineae	var. arenosa
Infraspecies starting with marker: 	W-Ase-409618	Henricia	compacta	var. aucklandiae
Infraspecies starting with marker: 	W-Ase-380761	Benthopecten	pikei	var. australis
Infraspecies starting with marker: 	W-Ase-379709	Pisaster	luetkeni	var. australis
Infraspecies starting with marker: 	W-Ase-380216	Luidia	alternata	var. bicolor
Infraspecies starting with marker: 	W-Ase-828504	Astropecten	polyacanthus	var. burbonica
Infraspecies starting with marker: 	W-Ase-828505	Astropecten	articulatus	var. buschi
Infraspecies starting with marker: 	W-Ase-125243	Dytaster	exilis	var. carinata
Infraspecies starting with marker: 	W-Ase-125244	Psilaster	andromeda	var. cassiope
Infraspecies starting with marker: 	W-Ase-478484	Luidia	maculata	var. ceylonica
Infraspecies starting with marker: 	W-Ase-379699	Leptasterias	aequalis	var. compacta
Infraspecies starting with marker: 	W-Ase-379700	Leptasterias	aequalis	var. concinna
Infraspecies starting with marker: 	W-Ase-125241	Leptasterias	floccosa	var. crassa
Infraspecies starting with marker: 	W-Ase-828510	Sclerasterias	alexandri	var. crassa
Infraspecies starting with marker: 	W-Ase-125248	Cribrella	sanguinolenta	var. curta
Infraspecies starting with marker: 	W-Ase-125245	Cribrella	oculata	var. cylindrella
Infraspecies starting with marker: 	W-Ase-828506	Astropecten	platyacanthus	var. flanaticus
Infraspecies starting with marker: 	W-Ase-828507	Astropecten	nitidus	var. forcipatus
Infraspecies starting with marker: 	W-Ase-125249	Pseudarchaster	intermedius	var. insignis
Infraspecies starting with marker: 	W-Ase-125261	Leptasterias	hyperborea	var. intermedia
Infraspecies starting with marker: 	W-Ase-536043	Asterina	cepheus	var. iranica
Infraspecies starting with marker: 	W-Ase-125240	Asterias	mÃ¼lleri	var. islandica
Infraspecies starting with marker: 	W-Ase-379492	Asterias	arenicola	var. lacazei
Infraspecies starting with marker: 	W-Ase-828509	Henricia	leviuscula	var. lunula
Infraspecies starting with marker: 	W-Ase-379523	Asterias	rubens	var. migratum
Infraspecies starting with marker: 	W-Ase-125246	Cribrella	oculata	var. murina
Infraspecies starting with marker: 	W-Ase-459282	Asterina	gibbosa	var. panceri
Infraspecies starting with marker: 	W-Ase-762314	Culcita	novaeguineae	var. plana
Infraspecies starting with marker: 	W-Ase-380240	Luidia	maculata	var. quinaria
Infraspecies starting with marker: 	W-Ase-379137	Asterias	calcar	var. quinqueangula
Infraspecies starting with marker: 	W-Ase-765936	Asterias	volsellata	var. sakurana
Infraspecies starting with marker: 	W-Ase-149896	Solaster	papposus	var. squamata
Infraspecies starting with marker: 	W-Ase-828508	Astropecten	americanus	var. subgracilis
Infraspecies starting with marker: 	W-Ase-762311	Culcita	novaeguineae	var. typica
--------------
UPDATE `scientific_names` SET `infraspecies` = SUBSTRING_INDEX(`infraspecies`, ' ', -1)
WHERE `infraspecies` LIKE '% %' AND
(`infraspecies` LIKE 'f.%' OR
`infraspecies` LIKE 'var.%' OR
`infraspecies` LIKE 'subsp.%')
--------------

--------------
SELECT "Infraspecies mismatch (infraspecies_parent_name_code set but infraspecies empty): ", `name_code`, `infraspecies_parent_name_code` FROM `scientific_names`
WHERE CHAR_LENGTH(`infraspecies_parent_name_code`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
SELECT "Infraspecies mismatch (infraspecies_marker set but infraspecies empty): ", `name_code`, `infraspecies_marker` FROM `scientific_names`
WHERE CHAR_LENGTH(`infraspecies_marker`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

Infraspecies mismatch (infraspecies_marker set but infraspecies empty): 	name_code	infraspecies_marker
Infraspecies mismatch (infraspecies_marker set but infraspecies empty): 	W-Ase-172791	subsp.
--------------
DELETE FROM `scientific_names`
WHERE CHAR_LENGTH(`infraspecies_parent_name_code`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
DELETE FROM `scientific_names`
WHERE CHAR_LENGTH(`infraspecies_marker`) > 1 AND
(`infraspecies` IS NULL OR `infraspecies` = '')
--------------

--------------
UPDATE `scientific_names` SET `species` = LOWER(`species`)
--------------

--------------
SELECT "Empty species name: ", `name_code`, `genus`, `infraspecies` FROM `scientific_names`
WHERE `species` = '' OR `species` IS NULL
--------------

--------------
DELETE FROM `scientific_names`
WHERE `species` = '' OR `species` IS NULL
--------------

--------------
SELECT "Empty reference: ", `author`, `year`, `reference_code` FROM `references`
WHERE (`title` = '' OR `title` IS NULL) AND
(`source` = '' OR `source` IS NULL)
--------------

--------------
DELETE FROM `references`
WHERE (`title` = '' OR `title` IS NULL) AND
(`source` = '' OR `source` IS NULL)
--------------

--------------
UPDATE `scientific_names` SET `scrutiny_date` = DATE_FORMAT(`scrutiny_date`, '%d-%b-%Y')
WHERE `scrutiny_date` LIKE '%:%' AND
(`scrutiny_date` != '' OR `scrutiny_date` IS NOT NULL)
--------------

--------------
SELECT "Set is_infraspecies flag: ", t1.`name_code`, t1.`common_name`, t2.`genus`, t2.`species`, t2.`infraspecies`
FROM `common_names` AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.`name_code` = t2.`name_code`
WHERE (t2.`infraspecies` != '' OR t2.`infraspecies` IS NOT NULL) AND
t1.`is_infraspecies` = 0
--------------

--------------
UPDATE `common_names` AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.`name_code` = t2.`name_code`
SET t1.`is_infraspecies` = 1
WHERE (t2.`infraspecies` != '' OR t2.`infraspecies` IS NOT NULL) AND
t1.`is_infraspecies` = 0
--------------

--------------
UPDATE `scientific_names` SET `author` = TRIM(`author`)
--------------

--------------
UPDATE `references`  SET `author` = TRIM(`author`)
--------------

--------------
SELECT "Duplicate accepted names:", sn.name_code, sn.sp2000_status_id, dups.genus, dups.subgenus, dups.species, dups.infraspecies_marker, dups.infraspecies, dups.author
FROM
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
	FROM scientific_names
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
WHERE sn.sp2000_status_id = 1
--------------

--------------
SELECT "Accepted name to be retained", MAX(name_code), genus, subgenus, species, infraspecies_marker, infraspecies, author
FROM
	(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, dups.species AS species,
		dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
	FROM
		(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
		FROM scientific_names
		GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
	LEFT JOIN scientific_names sn
	ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2
GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author
--------------

--------------
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus,
	dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
FROM
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
	FROM scientific_names
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
WHERE sn.sp2000_status_id = 1 AND sn.name_code NOT IN
	(SELECT dups3.namecodes_to_keep FROM
		(SELECT MAX(name_code) AS namecodes_to_keep, genus, subgenus, species, infraspecies_marker, infraspecies, author
		FROM
			(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus,
				dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
			FROM
				(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
				FROM scientific_names
				GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
		LEFT JOIN scientific_names sn
		ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2
GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
SELECT 'Common name without parent accepted name', t1.record_id, t1.common_name, t1.name_code FROM common_names AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
CREATE TEMPORARY TABLE scientific_names_tmp
(PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `specialist_code` (`specialist_code`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`))
SELECT * FROM scientific_names
--------------

--------------
SELECT 'Synonym without parent accepted name', t1.record_id, t1.name_code, t1.genus, t1.species, t1.infraspecies, t1.accepted_name_code
FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.accepted_name_code = t2.name_code
WHERE t2.name_code IS NULL AND t1.is_accepted_name != 1
--------------

Synonym without parent accepted name	record_id	name_code	genus	species	infraspecies	accepted_name_code
Synonym without parent accepted name	2125	W-Ase-379077	Asterias	borbonica		W-Ase-172534
Synonym without parent accepted name	2316	W-Ase-381975	Marginaster	littoralis		W-Ase-123133
Synonym without parent accepted name	2933	W-Ase-378639	Linckia	franciscus		W-Ase-123314
Synonym without parent accepted name	3687	W-Ase-370908	Randasia	luzonica		W-Ase-204844
Synonym without parent accepted name	4320	W-Ase-380692	Albatrossia	nuda		W-Ase-123267
Synonym without parent accepted name	4569	W-Ase-382114	Pedicellaster	parvulus		W-Ase-123225
Synonym without parent accepted name	4623	W-Ase-881622	Asterias	eustyla		W-Ase-123225
--------------
SELECT 'Infraspecies without parent accepted name', t1.record_id, t1.name_code, t1.genus, t1.species, t1.infraspecies, t1.accepted_name_code
FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.infraspecies_parent_name_code = t2.name_code
WHERE t1.infraspecies_parent_name_code IS NOT NULL AND t2.name_code IS NULL
--------------

--------------
SELECT 'Lifezone without parent accepted name', t1.record_id, t1.name_code, t1.lifezone
FROM lifezone AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
SELECT 'Distribution without parent accepted name', t1.record_id, t1.name_code, t1.distribution
FROM distribution AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
SELECT 'Accepted name without parent family', t1.record_id, t1.name_code,
	t1.genus, t1.subgenus, t1.species, t1.infraspecies, t1.family_code
FROM scientific_names AS t1
LEFT JOIN families AS t2 ON t1.family_code = t2.family_code
WHERE t2.family_code IS NULL
--------------

Accepted name without parent family	record_id	name_code	genus	subgenus	species	infraspecies	family_code
Accepted name without parent family	2125	W-Ase-379077	Asterias		borbonica		NULL
Accepted name without parent family	2316	W-Ase-381975	Marginaster		littoralis		NULL
Accepted name without parent family	2933	W-Ase-378639	Linckia		franciscus		NULL
Accepted name without parent family	3687	W-Ase-370908	Randasia		luzonica		NULL
Accepted name without parent family	4320	W-Ase-380692	Albatrossia		nuda		NULL
Accepted name without parent family	4569	W-Ase-382114	Pedicellaster		parvulus		NULL
Accepted name without parent family	4623	W-Ase-881622	Asterias	Stolasterias	eustyla		NULL
--------------
SELECT 'Reference link to non-existing accepted name', t1.record_id, t1.reference_code, t1.name_code
FROM scientific_name_references AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

Reference link to non-existing accepted name	record_id	reference_code	name_code
Reference link to non-existing accepted name	80	W-Ase-1368	W-Ase-124040
Reference link to non-existing accepted name	81	W-Ase-124623	W-Ase-124044
Reference link to non-existing accepted name	355	W-Ase-6325	W-Ase-216166
Reference link to non-existing accepted name	356	W-Ase-6324	W-Ase-216169
Reference link to non-existing accepted name	415	W-Ase-64	W-Ase-123720
Reference link to non-existing accepted name	497	W-Ase-71	W-Ase-213135
Reference link to non-existing accepted name	501	W-Ase-71	W-Ase-213244
Reference link to non-existing accepted name	510	W-Ase-47408	W-Ase-224147
Reference link to non-existing accepted name	512	W-Ase-10010	W-Ase-234873
Reference link to non-existing accepted name	661	W-Ase-152417	W-Ase-378712
Reference link to non-existing accepted name	666	W-Ase-6342	W-Ase-379538
Reference link to non-existing accepted name	668	W-Ase-125364	W-Ase-380313
Reference link to non-existing accepted name	678	W-Ase-47470	W-Ase-381784
Reference link to non-existing accepted name	680	W-Ase-132589	W-Ase-382102
Reference link to non-existing accepted name	692	W-Ase-125337	W-Ase-762315
Reference link to non-existing accepted name	693	W-Ase-125337	W-Ase-762317
Reference link to non-existing accepted name	730	W-Ase-64	W-Ase-124114
Reference link to non-existing accepted name	734	W-Ase-64	W-Ase-125157
Reference link to non-existing accepted name	751	W-Ase-125371	W-Ase-178031
Reference link to non-existing accepted name	878	W-Ase-47509	W-Ase-377346
Reference link to non-existing accepted name	882	W-Ase-126089	W-Ase-377848
Reference link to non-existing accepted name	893	W-Ase-127081	W-Ase-380329
Reference link to non-existing accepted name	902	W-Ase-168094	W-Ase-380835
Reference link to non-existing accepted name	938	W-Ase-47480	W-Ase-123918
Reference link to non-existing accepted name	944	W-Ase-1368	W-Ase-124025
Reference link to non-existing accepted name	961	W-Ase-5869	W-Ase-125234
Reference link to non-existing accepted name	1165	W-Ase-71	W-Ase-234960
Reference link to non-existing accepted name	1171	W-Ase-10011	W-Ase-235012
Reference link to non-existing accepted name	1195	W-Ase-6273	W-Ase-370885
Reference link to non-existing accepted name	1198	W-Ase-47430	W-Ase-377956
Reference link to non-existing accepted name	1213	W-Ase-138507	W-Ase-379565
Reference link to non-existing accepted name	1216	W-Ase-141249	W-Ase-380220
Reference link to non-existing accepted name	1239	W-Ase-47467	W-Ase-763779
Reference link to non-existing accepted name	1240	W-Ase-156693	W-Ase-877726
Reference link to non-existing accepted name	1261	W-Ase-47453	W-Ase-377927
Reference link to non-existing accepted name	1276	W-Ase-125364	W-Ase-380321
Reference link to non-existing accepted name	1289	W-Ase-1368	W-Ase-382090
Reference link to non-existing accepted name	1330	W-Ase-125374	W-Ase-370972
Reference link to non-existing accepted name	1333	W-Ase-6392	W-Ase-377377
Reference link to non-existing accepted name	1357	W-Ase-47427	W-Ase-380700
Reference link to non-existing accepted name	1415	W-Ase-5869	W-Ase-178135
Reference link to non-existing accepted name	1434	W-Ase-6338	W-Ase-213180
Reference link to non-existing accepted name	1506	W-Ase-71	W-Ase-124041
Reference link to non-existing accepted name	1519	W-Ase-4179	W-Ase-172754
Reference link to non-existing accepted name	1550	W-Ase-6273	W-Ase-221151
Reference link to non-existing accepted name	1605	W-Ase-1368	W-Ase-123791
Reference link to non-existing accepted name	1697	W-Ase-139319	W-Ase-123716
Reference link to non-existing accepted name	1756	W-Ase-124945	W-Ase-254889
Reference link to non-existing accepted name	1774	W-Ase-125364	W-Ase-368441
Reference link to non-existing accepted name	1799	W-Ase-1368	W-Ase-124076
Reference link to non-existing accepted name	1806	W-Ase-667	W-Ase-149885
Reference link to non-existing accepted name	1818	W-Ase-71	W-Ase-213132
Reference link to non-existing accepted name	1863	W-Ase-126089	W-Ase-377843
Reference link to non-existing accepted name	1870	W-Ase-43179	W-Ase-378709
Reference link to non-existing accepted name	1926	W-Ase-671	W-Ase-379048
Reference link to non-existing accepted name	1928	W-Ase-139547	W-Ase-379650
Reference link to non-existing accepted name	1931	W-Ase-47480	W-Ase-380348
Reference link to non-existing accepted name	1966	W-Ase-6392	W-Ase-377375
Reference link to non-existing accepted name	1997	W-Ase-47480	W-Ase-381040
Reference link to non-existing accepted name	2041	W-Ase-47471	W-Ase-377876
Reference link to non-existing accepted name	2053	W-Ase-47471	W-Ase-380627
Reference link to non-existing accepted name	2092	W-Ase-47408	W-Ase-368440
Reference link to non-existing accepted name	2114	W-Ase-47480	W-Ase-377806
Reference link to non-existing accepted name	2118	W-Ase-47454	W-Ase-378511
Reference link to non-existing accepted name	2120	W-Ase-6313	W-Ase-378597
Reference link to non-existing accepted name	2141	W-Ase-47480	W-Ase-381951
Reference link to non-existing accepted name	2158	W-Ase-1368	W-Ase-123951
Reference link to non-existing accepted name	2160	W-Ase-1368	W-Ase-124037
Reference link to non-existing accepted name	2180	W-Ase-6820	W-Ase-179589
Reference link to non-existing accepted name	2342	W-Ase-124967	W-Ase-382107
Reference link to non-existing accepted name	2347	W-Ase-168094	W-Ase-880866
Reference link to non-existing accepted name	2361	W-Ase-47431	W-Ase-378969
Reference link to non-existing accepted name	2363	W-Ase-667	W-Ase-379142
Reference link to non-existing accepted name	2394	W-Ase-1368	W-Ase-124016
Reference link to non-existing accepted name	2416	W-Ase-70	W-Ase-213260
Reference link to non-existing accepted name	2499	W-Ase-1368	W-Ase-125162
Reference link to non-existing accepted name	2522	W-Ase-6324	W-Ase-216171
Reference link to non-existing accepted name	2546	W-Ase-125374	W-Ase-377355
Reference link to non-existing accepted name	2550	W-Ase-47480	W-Ase-378535
Reference link to non-existing accepted name	2553	W-Ase-43179	W-Ase-378710
Reference link to non-existing accepted name	2581	W-Ase-124647	W-Ase-765422
Reference link to non-existing accepted name	2585	W-Ase-1368	W-Ase-123717
Reference link to non-existing accepted name	2596	W-Ase-1368	W-Ase-123917
Reference link to non-existing accepted name	2619	W-Ase-6324	W-Ase-213337
Reference link to non-existing accepted name	2621	W-Ase-139419	W-Ase-248038
Reference link to non-existing accepted name	2652	W-Ase-125374	W-Ase-370963
--------------
SELECT 'Reference link to non-existing reference', t1.record_id, t1.reference_code, t1.name_code
FROM scientific_name_references AS t1
LEFT JOIN `references` AS t2 ON t1.reference_code = t2.reference_code
WHERE t2.reference_code IS NULL
--------------

Reference link to non-existing reference	record_id	reference_code	name_code
Reference link to non-existing reference	110	W-Ase-4179	W-Ase-172691
Reference link to non-existing reference	113	W-Ase-4179	W-Ase-172716
Reference link to non-existing reference	117	W-Ase-4179	W-Ase-172750
Reference link to non-existing reference	119	W-Ase-4179	W-Ase-172755
Reference link to non-existing reference	122	W-Ase-4179	W-Ase-172780
Reference link to non-existing reference	123	W-Ase-4179	W-Ase-172781
Reference link to non-existing reference	124	W-Ase-4179	W-Ase-172784
Reference link to non-existing reference	126	W-Ase-4179	W-Ase-172789
Reference link to non-existing reference	299	W-Ase-4179	W-Ase-172660
Reference link to non-existing reference	300	W-Ase-4179	W-Ase-172662
Reference link to non-existing reference	302	W-Ase-4179	W-Ase-172677
Reference link to non-existing reference	303	W-Ase-4179	W-Ase-172696
Reference link to non-existing reference	464	W-Ase-4179	W-Ase-172698
Reference link to non-existing reference	468	W-Ase-4179	W-Ase-172741
Reference link to non-existing reference	469	W-Ase-4179	W-Ase-172775
Reference link to non-existing reference	742	W-Ase-4179	W-Ase-172674
Reference link to non-existing reference	743	W-Ase-4179	W-Ase-172742
Reference link to non-existing reference	745	W-Ase-4179	W-Ase-172767
Reference link to non-existing reference	747	W-Ase-4179	W-Ase-172792
Reference link to non-existing reference	962	W-Ase-4179	W-Ase-172663
Reference link to non-existing reference	963	W-Ase-4179	W-Ase-172667
Reference link to non-existing reference	965	W-Ase-4179	W-Ase-172749
Reference link to non-existing reference	966	W-Ase-4179	W-Ase-172756
Reference link to non-existing reference	970	W-Ase-4179	W-Ase-172774
Reference link to non-existing reference	1115	W-Ase-4179	W-Ase-172661
Reference link to non-existing reference	1116	W-Ase-4179	W-Ase-172678
Reference link to non-existing reference	1119	W-Ase-4179	W-Ase-172695
Reference link to non-existing reference	1121	W-Ase-4179	W-Ase-172760
Reference link to non-existing reference	1122	W-Ase-4179	W-Ase-172763
Reference link to non-existing reference	1124	W-Ase-4179	W-Ase-172777
Reference link to non-existing reference	1125	W-Ase-4179	W-Ase-172793
Reference link to non-existing reference	1412	W-Ase-4179	W-Ase-172753
Reference link to non-existing reference	1413	W-Ase-4179	W-Ase-172770
Reference link to non-existing reference	1516	W-Ase-4179	W-Ase-172650
Reference link to non-existing reference	1517	W-Ase-4179	W-Ase-172655
Reference link to non-existing reference	1518	W-Ase-4179	W-Ase-172680
Reference link to non-existing reference	1519	W-Ase-4179	W-Ase-172754
Reference link to non-existing reference	1520	W-Ase-4179	W-Ase-172757
Reference link to non-existing reference	1630	W-Ase-4179	W-Ase-172715
Reference link to non-existing reference	1631	W-Ase-4179	W-Ase-172722
Reference link to non-existing reference	1632	W-Ase-4179	W-Ase-172732
Reference link to non-existing reference	1633	W-Ase-4179	W-Ase-172746
Reference link to non-existing reference	1634	W-Ase-4179	W-Ase-172758
Reference link to non-existing reference	1635	W-Ase-4179	W-Ase-172772
Reference link to non-existing reference	1719	W-Ase-4179	W-Ase-172687
Reference link to non-existing reference	1720	W-Ase-4179	W-Ase-172718
Reference link to non-existing reference	1721	W-Ase-4179	W-Ase-172736
Reference link to non-existing reference	1722	W-Ase-4179	W-Ase-172751
Reference link to non-existing reference	1724	W-Ase-4179	W-Ase-172786
Reference link to non-existing reference	1807	W-Ase-4179	W-Ase-172659
Reference link to non-existing reference	1808	W-Ase-4179	W-Ase-172744
Reference link to non-existing reference	1809	W-Ase-4179	W-Ase-172778
Reference link to non-existing reference	2163	W-Ase-4179	W-Ase-172669
Reference link to non-existing reference	2165	W-Ase-4179	W-Ase-172768
Reference link to non-existing reference	2243	W-Ase-4179	W-Ase-172664
Reference link to non-existing reference	2244	W-Ase-4179	W-Ase-172766
Reference link to non-existing reference	2403	W-Ase-4179	W-Ase-172783
Reference link to non-existing reference	2506	W-Ase-4179	W-Ase-172676
Reference link to non-existing reference	2508	W-Ase-4179	W-Ase-172776
Reference link to non-existing reference	2509	W-Ase-4179	W-Ase-172779
Reference link to non-existing reference	2607	W-Ase-4179	W-Ase-172653
Reference link to non-existing reference	2608	W-Ase-4179	W-Ase-172721
Reference link to non-existing reference	2609	W-Ase-4179	W-Ase-172771
--------------
SELECT 'Specialist not present in scientific names table', t1.record_id,
	t1.specialist_name, t1.specialist_code
FROM specialists AS t1
LEFT JOIN scientific_names AS t2 ON t1.specialist_code = t2.specialist_code
WHERE t2.specialist_code IS NULL
--------------

--------------
SELECT 'Reference without parent accepted or common name', t1.record_id, t1.author, t1.year,
	t1.title, t1.reference_code
FROM `references` AS t1
LEFT JOIN scientific_name_references AS t2 ON t1.reference_code = t2.reference_code
LEFT JOIN common_names AS t3 ON t1.reference_code = t3.reference_code
WHERE t2.reference_code IS NULL AND t3.reference_code IS NULL
--------------

Reference without parent accepted or common name	record_id	author	year	title	reference_code
Reference without parent accepted or common name	3	Cattrijsse, A.; Vincx, M.	2001	Biodiversity of the benthos and the avifauna of the Belgian coastal waters: summary of data collected between 1970 and 1998. Sustainable Management of the North Sea. Federal Office for Scientific, Technical and Cultural Affairs: Brussel, Belgium. 48 pp.	W-Ase-61
Reference without parent accepted or common name	8	Hayward, P.J.; Nelson-Smith, A.; Shields, C.	1996	Collins pocket guide: sea shore of Britain and Europe. <i>Collins pocket guides</i>. Harper-Collins Publishers: London, UK. ISBN 0-00-219955-6. 352 pp.	W-Ase-614
Reference without parent accepted or common name	9	Hansson, H.G. (Comp.)	1998	NEAT (North East Atlantic Taxa): Scandinavian Echinodermata Check-List	W-Ase-631
Reference without parent accepted or common name	13	Hayward, P.; Nelson-Smith, A.; Shields, C.	1999	Gids van kust en strand: flora en fauna [Coast and beach guide: flora and fauna]. Tirion: Baarn, Netherlands. ISBN 90-5210-327-5. 352, ill. pp.	W-Ase-685
Reference without parent accepted or common name	15	Eneman, E.	1984	Uit het Natuurhistorisch Archief [From the Natural History Archive]. <i>De Strandvlo 4(1)</i>: 4-17	W-Ase-755
Reference without parent accepted or common name	16	Leewis, R.	2002	Flora en fauna van de zee [Marine flora and fauna]. <i>Veldgids</i>, 16. KNNV Uitgeverij: Utrecht, The Netherlands. ISBN 90-5011-153-X. 320 pp.	W-Ase-1116
Reference without parent accepted or common name	20	Gosner, K. L.	1971	Guide to identification of marine and estuarine invertebrates: Cape Hatteras to the Bay of Fundy	W-Ase-2964
Reference without parent accepted or common name	21	Gosner,	1977	Gosner, 1977	W-Ase-2965
Reference without parent accepted or common name	23	Meinkoth, N.A.	1981	Field guide to North American seashore creatures. The Audubon Society. Alfred A. Knopf. New York. 799 p.	W-Ase-3017
Reference without parent accepted or common name	25	Studer, T.	1876	Echinodermen aus dem antarktischen Meere und zwei neue Seeigel von den Papua-Inseln, gesammelt auf der Reise S.M.S. Gazelle um die Erde	W-Ase-3167
Reference without parent accepted or common name	26	Koehler R.	1906	ExpÃ©dition Antarctique FranÃ§aise (1903-1905). Echinodermes (stellÃ©rides, ophiures et Ã©chinides).  L. Joubin (ed.): 1-41. Masson et Cie, Paris	W-Ase-3190
Reference without parent accepted or common name	61	Thomson, C. W.	1873	The Depths of the Sea	W-Ase-8316
Reference without parent accepted or common name	62	Southward, E.C.; Campbell, A.C.	2006	[Echinoderms: keys and notes for the identification of British species]. <i>Synopses of the British fauna (new series)</i>, 56. Field Studies Council: Shrewsbury, UK. ISBN 1-85153-269-2. 272 pp.	W-Ase-9214
Reference without parent accepted or common name	70	Montagu, G.	1808	Description of several marine animals found on the south coast of Devonshire  	W-Ase-19343
Reference without parent accepted or common name	72	Leach, W. E.	1815	The Zoological Miscellany; Being Descriptions of New, or Interesting Animals	W-Ase-21978
Reference without parent accepted or common name	73	Delle Chiaje S.	1823-1831	Memorie sulla storia e notomia degli animali senza vertebre del regno di Napoli	W-Ase-42132
Reference without parent accepted or common name	76	McKnight, D. G.	1967	Some asterozoans from Norfolk Island. New Zealand	W-Ase-42912
Reference without parent accepted or common name	80			Class Asteroidea, Hawaii checklist	W-Ase-42936
Reference without parent accepted or common name	99	Downey, M. E.	1980	i>Floriaster maya</i>, new genus and species of the family Goniasteridae	W-Ase-47415
Reference without parent accepted or common name	102	Halpern, J. A.	1969	Biological investigations of the deep-sea. 50. The validity and generic position of <i>Pentagonaster parvus</i> Perrier (Echinodermata, Asteroidea	W-Ase-47418
Reference without parent accepted or common name	123	Jangoux, M.	1981	Une nouvelle espÃ¨ce dâastÃ©ride bathyale des eaux de Nouvelle-CalÃ©donie (Echinodermata, Asteroidea). Bulletin du Museum National DâHistoire Naturelle (Zoologie), sect	W-Ase-47448
Reference without parent accepted or common name	126	DÃ¶derlein, L.	1922	Uber die Gattung <i>Calliaster</i> Gray.  Bijdragen tot de Dierkunde. 1922: 47-52	W-Ase-47451
Reference without parent accepted or common name	142	Fujita, T. and F.W.E. Rowe.	2002	Podospherasteridae fam. Nov. (Echinodermata: Asteroidea: Valvatida) with a new species, <i>Podospheraster toyoshiomaruae</i> from Southern Japan. Species Diversity 7: 317-332.	W-Ase-47481
Reference without parent accepted or common name	143	Clark, A. M.; Wright, C. W.	1962	A new genus and species of recent starfishes belonging to the aberrant family Sphaerasteridae, with notes on the possible origin and  affinities  of the family	W-Ase-47482
Reference without parent accepted or common name	151	Downey, M. E.	1971	i>Ampheraster alaminos</i>, a new species of the family Asteriidae (Echinodermata: Asteroidea) from the Gulf of Mexico	W-Ase-47495
Reference without parent accepted or common name	152	Blake, D. B.	1978	The taxonomic position of the modern sea-star <i>Cistina</i> Gray, 1840	W-Ase-47496
Reference without parent accepted or common name	162	Downey, M. E.	1970	i>Marsipaster acicula</i>, new species (Echinodermata; Asteroidea) from the Caribbean and Gulf of Mexico	W-Ase-47517
Reference without parent accepted or common name	165	Downey, M. E.	1979	i>Hymenaster kieri</i> a new species of starfish of the family Pterasteridae (Echinodermata: Asteroidea	W-Ase-47520
Reference without parent accepted or common name	166	Mah, C. L.	2003	i>Astrosarkus idipi</i>, a new Indo-Pacific genus and species of Oreasteridae (Valvatida; Asteroidea) displaying extreme skeletal reduction	W-Ase-47524
Reference without parent accepted or common name	171	Downey, M. E.	1971	Two new species of the genus <i>Tamaria</i> (Echinodermata:  Asteroidea) from the tropical western Atlantic	W-Ase-47544
Reference without parent accepted or common name	173	Howell, K.L., D.W. Pond, D.S.M. Billett & P.A. Tyler	2003	Feeding ecology of deep-sea seastars (Echinodermata: Asteroidea): A fatty-acid biomarker approach.	W-Ase-88470
Reference without parent accepted or common name	174			Strandvondsten van Gravelines tot Nieuwpoort. Ecogids Tjiftjaf	W-Ase-123768
Reference without parent accepted or common name	175	Zenetos, A., M.E. Ãinar, M.A. Pancucci-Papadopoulou, J.G. Harmelin, G. Furnari, F. Andaloro, N. Bellou, N. Streftaris & H. Zibrowius	2005	Annotated list of marine alien species in the Mediterranean with records of the worst invasive species.	W-Ase-124391
Reference without parent accepted or common name	176	Rowe, F.W.E.	1989	A review of the family Caymanostellidae (Echinodermata:  Asteroidea) with the description of a new species of Caymanostella Belyaev and a new genus. Proceedings of the Linnaean Society of New South Wales 111(4):293-307	W-Ase-124596
Reference without parent accepted or common name	179	Rowe, F. W. E.	1985	Six  new species of <i>Asterodiscides</i> A.M. Clark (Echinodermata, Asteroidea) with a discussion of the origin and distribution of the Asterodiscididae and other 'amphi-Pacific echinoderms. Bulletin MusÃ©um national d'Histoire naturelle, Paris Sect	W-Ase-124602
Reference without parent accepted or common name	180	Rowe, F. W. E. and E. L. Albertson.	1986	he echinoderm genus <i>Henricia</i> Gray, 1840 (Asteroidea:  Echinasteridae) in southern and southeastern Australian waters, with the description of a new species Proceedings of the Linnean Society of New South Wales 109(3): 183-194	W-Ase-124603
Reference without parent accepted or common name	193	MÃ¶bius,K.	1859	Neue Seesterne des Hamburger und Ieler Museums. Abhandlungen und Verhandlungen. Naturwissenschaftlicher Verein in Hamburg 4(2). 14 p.	W-Ase-124634
Reference without parent accepted or common name	198	Fisher, W. K.	1917	The asteroid genus <i>Coronaster</i	W-Ase-124646
Reference without parent accepted or common name	200	Fisher, W.K.	1926	A new sea star of the genus <i>Evasterias</i>. Proceedings of the U.S. National Museum 69(6):1-5.	W-Ase-124652
Reference without parent accepted or common name	211	Harvey, R.	1989	A new pterasterid (Echinodermata:  Asteroidea) from the deep north-east Atlantic	W-Ase-124965
Reference without parent accepted or common name	214	Doderlein, L.	1916	Uber die Gattung <i>Oreaster</i> und Verwandte.Zoologischen Jahrbuchern 40:  409-440	W-Ase-124978
Reference without parent accepted or common name	220	Dons, C.	1936	Zoologische Notizen XXXIV. <i>Pseudoporania stormi</i> n. gen, n. sp. Det Kongelige Norske Videnskabers selskab Forhandlinger 8(4): 17-20.	W-Ase-125307
Reference without parent accepted or common name	228	Miller, J. E.	1984	Systematics of the ophidiasterid sea stars Copidaster lymani A.H. Clark, and Hacelia superba H.L. Clark (Echinodermata:  Asteroidea) with a key to species of Ophidiasteridae from the Western Atlantic	W-Ase-125340
Reference without parent accepted or common name	230	Howell K L A D Rogers; Tyler, P. A.; Billett, D. S. M.	2004	Reproductive isolation among morphotypes of the Atlantic seastar species <i>Zoroaster fulgens</i	W-Ase-125349
Reference without parent accepted or common name	232	Farquhar, H.	1895	XX-Notes on New Zealand Echinoderms	W-Ase-125357
Reference without parent accepted or common name	233	Williams, S. T.	2000	Species boundaries in the starfish genus <i>Linckia</i	W-Ase-125360
Reference without parent accepted or common name	239	LÃ¼tken, C.	1871	Fortasatte kritiske og beskrivende Bidrag til Kundskab om Sostjernerne (Asteriderne) Videnskabelige Meddelelsefra Dansk Naturhistorisk Forening 1871: 227-304.	W-Ase-125719
Reference without parent accepted or common name	241	Liao, Y.	1983	A new species of goniasterid sea-star from the Huanghai Sea	W-Ase-125724
Reference without parent accepted or common name	244	Liao, Y.	1982	A new genus of starfish from the continental shelf of the East China Sea	W-Ase-125727
Reference without parent accepted or common name	246	Liao, Y.	1989	A new species of astropectinid sea-star from East China Sea	W-Ase-125729
Reference without parent accepted or common name	263	Clark, A. M.	1981	Notes on Atlantic and other Asteroidea. 1. Family Benthopectinidae	W-Ase-126109
Reference without parent accepted or common name	269	O'loughlin, P. M.; Waters, J. M.	2002	Description of a new species of Patiriella from New Zealand, and review of Patiriella regularis (Echinodermata, Asteroidea) based on morphological and molecular data	W-Ase-127017
Reference without parent accepted or common name	276	McKnight.	2006	The marine fauna of New Zealand: Asteroidea (sea-stars). 3. Orders Velatida, Spinulosida, Forcipulatida, Brisingida with addenda to Paxillosida, Valvatida. NIWA Biodiversity Memoir Volume: 120 Pages: 5-184	W-Ase-128965
Reference without parent accepted or common name	278	Clark, A. H.	1931	A monograph of the existing crinoids, vol. 1 . The comatulids, pt. 3: Superfamily Comasterida	W-Ase-129946
Reference without parent accepted or common name	284	Clark, H. E. S.	2001	Superfamily Goniasteracea, Family Goniasteridae	W-Ase-133489
Reference without parent accepted or common name	286	Jangoux, M.	1982	On Tremaster Verrill, 1879, an odd genus of Recent starfish (Echinodermata: Asteroidea). Pp. 155-163, 4pls. in Lawrence, J.M. (ed). Echinoderms.	W-Ase-133496
Reference without parent accepted or common name	287	Clark, A.; Clark, A.	1967	A monograph of the existing crinoids 1(5	W-Ase-133557
Reference without parent accepted or common name	289	Clark, H. E. S.	1972	i>Knightaster</i>, a new genus of asteroid from Northern New Zealand	W-Ase-133578
Reference without parent accepted or common name	294	MÃ¼ller, J. H.; Troschel, F. H.	1842	System der Asteriden	W-Ase-139303
Reference without parent accepted or common name	297	MÃ¼ller, J.; Troschel, F. H.	1844	Beschreibung neuer Asteriden	W-Ase-139362
Reference without parent accepted or common name	298	Philippi	1858	Beschreibungen einiger neuer Seesterne aus dem Meere von Chiloe	W-Ase-139373
Reference without parent accepted or common name	300	Benham, W. B.	1909	Echinoderma (Science reports N.Z. Government Trawling Expedition)	W-Ase-139407
Reference without parent accepted or common name	302	Verrill, A. E.	1867	Notes on radiata in the museum of Yale College with descriptions of new genera and species - II. Notes on the echinoderms of Panama and the west coast of America, with descriptions of a new genus	W-Ase-139425
Reference without parent accepted or common name	307	Verrill, A. E.	1894	Descriptions of new species of starfishes and ophiurans, with a revision of certain species formerly described; mostly from the collections made by the United States Commission of Fish and Fisheries	W-Ase-139521
Reference without parent accepted or common name	311	Mortensen, T.	1925	On some echinoderms from South Africa. Annals and Magazines of Natural History	W-Ase-139633
Reference without parent accepted or common name	317	Emson, R. G.; Crump, R. H.	1979	Description of a new species of Asterina (Asteroidea), with an account of its ecology	W-Ase-141275
Reference without parent accepted or common name	320	Sibuet, M.	1977	<i>Ophidiaster reyssi</i> nouvelle espece d'Asteride bathyale de l'ocean Atlantique. Bulletin du Museum national d'Histoire naturelle. 3rd ser. 343 (494): 1085-1090.	W-Ase-142513
Reference without parent accepted or common name	324	Bousfield, E.L.	1964	Coquillages des cotes canadiennes de l'Atlantique	W-Ase-145894
Reference without parent accepted or common name	330	Dilman, A.B.	2005	Starfishes of the genus <i>Myxaster</i> (Echinodermata, asteroidea). Zoologieskij Zurnal 84(4):455-463  (in Russian)	W-Ase-149347
Reference without parent accepted or common name	335	Clark, R.N. and Jewett, S.C.	2011	A new sea star of the genus <i>Hippasteria</i> (Asteroidea; Goniasteridae) from the Aleutian Islands. <i>Zootaxa</i> 2963: 48-54.	W-Ase-153328
Reference without parent accepted or common name	340			TermCat, The Center for Terminology	W-Ase-163043
Reference without parent accepted or common name	341	Bell FJ	1908	Echinoderma. In National Antarctic Expedition. Natural History 4:1â15, pl. 1â5.	W-Ase-164912
Reference without parent accepted or common name	354	Belyaev, G. M.	1974	A new family of Abyssal starfishes	W-Ase-181835
Reference without parent accepted or common name	356	Bell, F. J.	1881	Account of the Echinodermata collected during the Survey of H.M.S. "Alert" in the Straits of Magellan and on the Coast of Patagonia	W-Ase-190217
Reference without parent accepted or common name	357	Galil, B.	2007	Seeing Red: Alien species along the Mediterranean coast of Israel	W-Ase-190896
Reference without parent accepted or common name	362	Zenetos, A.; Meric, E.; Verlaque, M.; Galli, P.; Boudouresque, C.; Giangrande, A.; Cinar, M.; Bilecenoglu, M.	2008	Additions to the annotated list of marine alien biota in the Mediterranean with special emphasis on Foraminifera and Parasites	W-Ase-195830
Reference without parent accepted or common name	364	Sibuet, M	1976	Le genre <i>Hymenaster</i> (Asterides) dans l'ocean Atlantique	W-Ase-196889
Reference without parent accepted or common name	367	Verrill, A. E.	1867-1871	Notes on Radiata	W-Ase-197942
Reference without parent accepted or common name	370	LÃ¼tken C	1857	De ved Danmarks kyster levende Pighude	W-Ase-223126
Reference without parent accepted or common name	374	Bernasconi I	1972	Nuevas especies de Asteroidea: Bathybiaster herwigi sp.nov. (Astropectinidae) y Calyptraster vitreus sp.nov. (Pterasteridae)	W-Ase-225479
Reference without parent accepted or common name	377	Ludwig H	1907	Diagnosen neuer Tiefsee-Seesterne aus der Familie der Porcellanasteriden	W-Ase-229914
Reference without parent accepted or common name	378	Korovchinsky N. M.	1976	New Species of Abyssal Starfishes of the Genus Freyella (Brisingidae) from the South Atlantic	W-Ase-229915
Reference without parent accepted or common name	384	Thomson, C. W.	1877	The voyage of the "Challenger" : the Atlantic	W-Ase-230063
Reference without parent accepted or common name	385	Fisher WK	1919	North Pacific Zoroasteridae	W-Ase-230077
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
CREATE TEMPORARY TABLE duplicates_to_delete AS
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus,
	dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
FROM
	(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
	FROM scientific_names
	GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id
	HAVING cnt > 1) AS dups
LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
WHERE sn.sp2000_status_id = 1 AND sn.name_code NOT IN
	(SELECT dups3.namecodes_to_keep FROM
		(SELECT MAX(name_code) AS namecodes_to_keep, genus, subgenus, species, infraspecies_marker, infraspecies, author FROM
			(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.subgenus AS subgenus, dups.species AS species,
				dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author
			FROM
				(SELECT genus, subgenus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
				FROM scientific_names
				GROUP BY genus, subgenus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) AS dups
			LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.subgenus = dups.subgenus AND sn.species = dups.species AND sn.author = dups.author
			WHERE sn.sp2000_status_id = 1) AS dups2
		GROUP BY genus, subgenus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
DELETE QUICK FROM scientific_names
USING scientific_names
INNER JOIN duplicates_to_delete ON scientific_names.name_code = duplicates_to_delete.name_code
--------------

--------------
DELETE QUICK t1 FROM common_names AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.accepted_name_code = t2.name_code
WHERE t2.name_code IS NULL AND t1.is_accepted_name != 1
--------------

--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN scientific_names_tmp AS t2 ON t1.infraspecies_parent_name_code = t2.name_code
WHERE t1.infraspecies_parent_name_code IS NOT NULL AND t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM lifezone AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
OPTIMIZE TABLE lifezone
--------------

Table	Op	Msg_type	Msg_text
Assembly_Asteroidea.lifezone	optimize	status	OK
--------------
DELETE QUICK t1 FROM distribution AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
OPTIMIZE TABLE distribution
--------------

Table	Op	Msg_type	Msg_text
Assembly_Asteroidea.distribution	optimize	status	OK
--------------
DELETE QUICK t1 FROM scientific_names AS t1
LEFT JOIN families AS t2 ON t1.family_code = t2.family_code
WHERE t2.family_code IS NULL
--------------

--------------
OPTIMIZE TABLE scientific_names
--------------

Table	Op	Msg_type	Msg_text
Assembly_Asteroidea.scientific_names	optimize	status	OK
--------------
DELETE QUICK t1 FROM scientific_name_references AS t1
LEFT JOIN scientific_names AS t2 ON t1.name_code = t2.name_code
WHERE t2.name_code IS NULL
--------------

--------------
DELETE QUICK t1 FROM scientific_name_references AS t1
LEFT JOIN `references` AS t2 ON t1.reference_code = t2.reference_code
WHERE t2.reference_code IS NULL
--------------

--------------
OPTIMIZE TABLE scientific_name_references
--------------

Table	Op	Msg_type	Msg_text
Assembly_Asteroidea.scientific_name_references	optimize	status	OK
--------------
DELETE QUICK t1 FROM specialists AS t1
LEFT JOIN `scientific_names` AS t2 ON t1.specialist_code = t2.specialist_code
WHERE t2.specialist_code IS NULL
--------------

--------------
DELETE t1 FROM `references` AS t1
LEFT JOIN scientific_name_references AS t2 ON t1.reference_code = t2.reference_code
LEFT JOIN common_names AS t3 ON t1.reference_code = t3.reference_code
WHERE t2.reference_code IS NULL AND t3.reference_code IS NULL
--------------

--------------
OPTIMIZE TABLE `references`
--------------

Table	Op	Msg_type	Msg_text
Assembly_Asteroidea.references	optimize	status	OK
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

</pre>
<pre>
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Editorial and Integrity checks Completed.
</pre>
</pre><hr><b>Replacing sectors in Assembly Global database</b>
<pre>
<pre>
Starting Sector Management
--------------
SET @dbid = 95
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
DELETE FROM ",
@dbtouse,
".`databases` WHERE `record_id` = @dbid")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`families` SELECT 
NULL AS `record_id`,
`hierarchy_code`,	
`kingdom`,	
`phylum`,	
`class`,	
`order`,	
`family`,	
`superfamily`, 	
`database_id`, 	
`family_code`,
`is_accepted_name`
FROM  `families`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`databases` SELECT 
`database_name_displayed`, 
`record_id`, 
`database_name`, 
`database_full_name`, 
`web_site`, 
`organization`, 
`contact_person`, 
`taxa`, 
`taxonomic_coverage`, 
`abstract`, 
`version`, 
`release_date`, 
`SpeciesCount`, 
`SpeciesEst`, 
`authors_editors`, 
`accepted_species_names`, 
`accepted_infraspecies_names`, 
`species_synonyms`, 
`infraspecies_synonyms`, 
`common_names`, 
`total_names`, 
`is_new`,
`coverage`,
`completeness`,
`confidence`
FROM `databases`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_names` 
(`record_id`, `name_code`, `web_site`, `genus`, `subgenus`, `species`, `infraspecies_parent_name_code`, `infraspecies`, `infraspecies_marker`, `author`, `accepted_name_code`, `comment`, `scrutiny_date`, `sp2000_status_id`, `database_id`, `specialist_id`, `family_id`, `specialist_code`, `family_code`, `is_accepted_name`, `GSDTaxonGUID`, `GSDNameGUID`, `is_extinct`, `has_preholocene`, `has_modern`) SELECT 
NULL AS `record_id`, 
`name_code`, 
`web_site`, 
`genus`, 
`subgenus`, 
`species`, 
`infraspecies_parent_name_code`, 
`infraspecies`, 
`infraspecies_marker`, 
`author`, 
`accepted_name_code`, 
`comment`, 
`scrutiny_date`, 
`sp2000_status_id`, 
`database_id`, 
`specialist_id`, 
`family_id`, 
`specialist_code`, 
`family_code`, 
`is_accepted_name`, 
`GSDTaxonGUID`, 
`GSDNameGUID`, 
`is_extinct`,
`has_preholocene`, 
`has_modern`
FROM `scientific_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`common_names` SELECT 
NULL AS `record_id`, 
`name_code`, 
`common_name`, 
`transliteration`, 
`language`, 
`country`, 
`area`, 
NULL AS `reference_id`, 
`database_id`, 
`is_infraspecies`, 
`reference_code`
FROM  `common_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`distribution` SELECT 
NULL AS `record_id`, 
`name_code`, 
`distribution`, 
`StandardInUse`, 
`DistributionStatus`,
`database_id`
FROM  `distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`lifezone` SELECT 
NULL AS `record_id`,
`name_code`, 	
`lifezone`,
`database_id`
FROM  `lifezone`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_name_references` SELECT 
NULL AS `record_id`,
`name_code`,	
`reference_type`, 	
NULL AS `reference_id`,	
`reference_code`,
`database_id`
FROM  `scientific_name_references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`references` SELECT 
NULL AS `record_id`, 
`author`, 
`year`, 
`title`, 
`source`, 
`database_id`, 
`reference_code`
FROM  `references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`specialists` SELECT 
NULL AS `record_id`,
`specialist_name`,
`specialist_code`,
`database_id`
FROM  `specialists`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------




!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!

!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!




Transformations Completed.
<pre>
</pre><hr><b>Chain completed</b>
</body></html>
