<html><body>
<br><b>Harvesting...</b>\n<pre>
</pre><hr><b>File format conversions...</b>\n<pre>
Unzipping
Archive:  WoRMS_Brachyura.zip
  inflating: AcceptedSpecies.txt     
  inflating: AcceptedInfraSpecificTaxa.txt  
  inflating: Synonyms.txt            
  inflating: CommonNames.txt         
  inflating: Distribution.txt        
  inflating: References.txt          
  inflating: NameReferencesLinks.txt  
  inflating: SourceDatabase.txt      
Skipping format conversion
</pre><hr><b>Creating buffer database, performing structural transformations...</b>\n<pre>
<pre>
Initiating buffer creation - this may take a while depending on size of the dataset...\n
Creating buffer database Buffer_Brachyura in schema as provided by Brachyura
--------------
DROP DATABASE IF EXISTS Buffer_Brachyura
--------------

--------------
CREATE DATABASE IF NOT EXISTS Buffer_Brachyura
--------------

--------------
CREATE TABLE `AcceptedInfraSpecificTaxa` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`ParentSpeciesID` varchar(50) default NULL,
`InfraSpeciesEpithet` varchar(50) default NULL,
`InfraSpecificAuthorString` varchar(50) default NULL,
`InfraSpecificMarker` varchar(10) default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`InfraSpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI`  varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `AcceptedSpecies` (
`AcceptedTaxonID` varchar(50) PRIMARY KEY,
`Kingdom` varchar(50) default NULL,
`Phylum` varchar(50) default NULL,
`Class` varchar(50) default NULL,
`Order` varchar(50) default NULL,
`Superfamily` varchar(50) default NULL,
`Family` varchar(50) default NULL,
`Genus` varchar(50) default NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) default NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`IsFossil` tinyint(1) default NULL,
`LifeZone` varchar(50) default NULL,
`AdditionalData` varchar(255) default NULL,
`LTSSpecialist` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`LTSDate` varchar(50) default NULL,
`SpeciesURL` varchar(255) default NULL,
`GSDTaxonGUI` varchar(255) default NULL,
`GSDNameGUI` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `CommonNames` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`CommonName` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Transliteration` varchar(255) default NULL,
`Language` varchar(50) CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Country`  varchar(255) default NULL,
`Area`  varchar(255) default NULL,
`ReferenceID` varchar(50) default NULL,
PRIMARY KEY (`record_id`)
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `Distribution` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Distribution` varchar(255) CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`StandardInUse` varchar(50) default NULL,
`DistributionStatus` varchar(50) default NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8 COLLATE = utf8_general_ci
--------------

--------------
CREATE TABLE `References` (
`ReferenceID` varchar(50) PRIMARY KEY,
`Authors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`Year` varchar(255) default NULL,
`Title` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Details` varchar(255) default NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `NameReferencesLinks` (
`ID` integer(10) PRIMARY KEY,
`ReferenceType` varchar(50) default NULL,
`ReferenceID` varchar(50) NOT NULL
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `SourceDatabase` (
`record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
`DatabaseFullName` varchar(255) NOT NULL,
`DatabaseShortName` varchar(50) NOT NULL,
`DatabaseVersion` varchar(50) NOT NULL,
`ReleaseDate` varchar(50) NOT NULL,
`AuthorsEditors` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`TaxonomicCoverage` varchar(255) NOT NULL,
`GroupNameInEnglish` varchar(255) NOT NULL,
`Abstract` text  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
`Organisation` varchar(255) NOT NULL,
`HomeURL` varchar(255) default NULL,
`Coverage` varchar(50) default NULL,
`Completeness` integer(3) default NULL,
`Confidence` integer(1) default NULL,
`LogoFileName`  varchar(255) default NULL,
`ContactPerson` varchar(255)  CHARACTER SET utf8 COLLATE utf8_general_ci NOT NULL,
PRIMARY KEY (`record_id`) 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
CREATE TABLE `Synonyms` (
`ID` integer(10) PRIMARY KEY,
`AcceptedTaxonID` varchar(50) NOT NULL,
`Genus` varchar(50) NOT NULL,
`SubGenusName` varchar(50) default NULL,
`Species` varchar(50) NOT NULL,
`AuthorString` varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`InfraSpecies` varchar(50) default NULL,
`InfraSpecificMarker` varchar(50) default NULL,
`InfraSpecificAuthorString`  varchar(50)  CHARACTER SET utf8 COLLATE utf8_general_ci default NULL,
`GSDNameStatus` varchar(50) default NULL,
`Sp2000NameStatus` varchar(50) default NULL,
`GSDNameGUI` varchar(255) default NULL 
) ENGINE=MyISAM DEFAULT CHARSET=utf8
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedInfraSpecificTaxa.txt' INTO TABLE `AcceptedInfraSpecificTaxa` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES 
(`AcceptedTaxonID`, `ParentSpeciesID`, `InfraSpeciesEpithet`, `InfraSpecificAuthorString`,  `InfraSpecificMarker`, `GSDNameStatus`,  `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `InfraSpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'AcceptedSpecies.txt' INTO TABLE `AcceptedSpecies` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Kingdom`, `Phylum`, `Class`, `Order`, `Superfamily`, `Family`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `IsFossil`, `LifeZone`, `AdditionalData`, `LTSSpecialist`, `LTSDate`, `SpeciesURL`, `GSDTaxonGUI`, `GSDNameGUI`)
--------------

--------------
LOAD DATA LOCAL INFILE 'CommonNames.txt' INTO TABLE `CommonNames` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `CommonName`, `Transliteration`, `Country`, `Area`, `Language`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Distribution.txt' INTO TABLE `Distribution` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n'  IGNORE 1 LINES
(`AcceptedTaxonID`, `Distribution`, `StandardInUse`, `DistributionStatus`)
--------------

--------------
LOAD DATA LOCAL INFILE 'NameReferencesLinks.txt' INTO TABLE NameReferencesLinks CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `ReferenceType`, `ReferenceID`)
--------------

--------------
LOAD DATA LOCAL INFILE 'References.txt' INTO TABLE `References` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ReferenceID`, `Authors`, `Year`, `Title`, `Details`)
--------------

--------------
LOAD DATA LOCAL INFILE 'SourceDatabase.txt' INTO TABLE `SourceDatabase` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`DatabaseFullName`, `DatabaseShortName`, `DatabaseVersion`, `ReleaseDate`, `AuthorsEditors`, `TaxonomicCoverage`, `GroupNameInEnglish`, `Abstract`, `Organisation`, `HomeURL`, `Coverage`, `Completeness`, `Confidence`, `LogoFileName`, `ContactPerson`)
--------------

--------------
LOAD DATA LOCAL INFILE 'Synonyms.txt' INTO TABLE `Synonyms` CHARACTER SET utf8 FIELDS TERMINATED BY '\t'  LINES TERMINATED BY '\r\n' IGNORE 1 LINES
(`ID`, `AcceptedTaxonID`, `Genus`, `SubGenusName`, `Species`, `AuthorString`, `InfraSpecies`, `InfraSpecificMarker`, `InfraSpecificAuthorString`, `GSDNameStatus`, `Sp2000NameStatus`, `GSDNameGUI`)
--------------

\n\n\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n\n
Initial database created. Creating database Assembly_Brachyura in assembly schema
--------------
DROP DATABASE IF EXISTS Assembly_Brachyura
--------------

--------------
CREATE DATABASE IF NOT EXISTS Assembly_Brachyura
--------------

--------------
DROP TABLE IF EXISTS `databases`
--------------

--------------
CREATE TABLE  `databases` (
  `database_name_displayed` varchar(125) DEFAULT NULL,
  `record_id` int(10) NOT NULL AUTO_INCREMENT,
  `database_name` varchar(150) DEFAULT NULL,
  `database_full_name` varchar(100) NOT NULL DEFAULT '',
  `web_site` longtext,
  `organization` longtext,
  `contact_person` varchar(255) DEFAULT NULL,
  `taxa` varchar(255) DEFAULT NULL,
  `taxonomic_coverage` longtext,
  `abstract` longtext,
  `version` varchar(255) DEFAULT NULL,
  `release_date` date DEFAULT '0000-00-00',
  `SpeciesCount` int(11) DEFAULT 0,
  `SpeciesEst` int(11) DEFAULT 0,
  `authors_editors` longtext,
  `accepted_species_names` int(10) DEFAULT 0,
  `accepted_infraspecies_names` int(10) DEFAULT 0,
  `species_synonyms` int(10) DEFAULT 0,
  `infraspecies_synonyms` int(10) DEFAULT 0,
  `common_names` int(10) DEFAULT 0,
  `total_names` int(10) DEFAULT 0,
  `is_new` tinyint(1) NOT NULL DEFAULT 0,
  `coverage` varchar(45) DEFAULT NULL,
  `completeness` int(3) unsigned DEFAULT 0,
  `confidence` 	tinyint(1) unsigned DEFAULT 0,
  PRIMARY KEY (`record_id`),
  KEY `database_name` (`database_name`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `families`
--------------

--------------
CREATE TABLE  `families` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `hierarchy_code` varchar(250) NOT NULL,
  `kingdom` varchar(50) NOT NULL DEFAULT 'Not Assigned',
  `phylum` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `class` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `order` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `family` varchar(50) NOT NULL DEFAULT ' Not Assigned ',
  `superfamily` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  `family_code` varchar(50) NOT NULL,
  `is_accepted_name` int(1) unsigned,
  PRIMARY KEY (`record_id`),
  KEY (`family_code`),
  KEY `kingdom` (`kingdom`),
  KEY `phylum` (`phylum`),
  KEY `class` (`class`),
  KEY `order` (`order`),
  KEY `family` (`family`),
  KEY `superfamily` (`superfamily`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `sp2000_statuses`
--------------

--------------
CREATE TABLE  `sp2000_statuses` (
  `record_id` int(1) NOT NULL AUTO_INCREMENT,
  `sp2000_status` varchar(50) NOT NULL DEFAULT '',
  PRIMARY KEY (`record_id`)
) ENGINE=MyISAM
--------------

--------------
DROP TABLE IF EXISTS `scientific_names`
--------------

--------------
CREATE TABLE  `scientific_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `web_site` longtext,
  `genus` varchar(50) DEFAULT NULL,
  `subgenus` varchar(50) DEFAULT NULL,
  `species` varchar(60) DEFAULT NULL,
  `infraspecies_parent_name_code` varchar(42) DEFAULT NULL,
  `infraspecies` varchar(50) DEFAULT NULL,
  `infraspecies_marker` varchar(50) DEFAULT NULL,
  `author` varchar(100) DEFAULT NULL,
  `accepted_name_code` varchar(42) DEFAULT NULL,
  `comment` longtext,
  `scrutiny_date` text,
  `sp2000_status_id` int(1) DEFAULT NULL,
  `database_id` int(10) DEFAULT NULL,
  `specialist_id` int(10) DEFAULT NULL,
  `family_id` int(10) DEFAULT NULL,
  `specialist_code` varchar(50) DEFAULT NULL,
  `family_code` varchar(50) DEFAULT NULL,
  `is_accepted_name` int(1) DEFAULT NULL,
  `GSDTaxonGUID` longtext,
  `GSDNameGUID` longtext,
  PRIMARY KEY (`record_id`,`name_code`),
  KEY `database_id` (`database_id`),
  KEY `family_id` (`family_id`),
  KEY `species` (`species`),
  KEY `infraspecies` (`infraspecies`),
  KEY `accepted_name_code` (`accepted_name_code`),
  KEY `infraspecies_parent_name_code` (`infraspecies_parent_name_code`),
  KEY `name_code1` (`name_code`,`family_id`),
  KEY `record_id` (`record_id`,`family_id`),
  KEY `genus` (`genus`,`species`,`infraspecies`),
  KEY `sp2000_status_id` (`sp2000_status_id`),
  KEY `sp2000_status_id_2` (`sp2000_status_id`,`database_id`,`infraspecies`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `common_names`
--------------

--------------
CREATE TABLE  `common_names` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `common_name` varchar(700) NOT NULL,
  `transliteration` varchar(700),
  `language` varchar(25) NOT NULL,
  `country` varchar(44) NOT NULL DEFAULT '',
  `area` varchar(50) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `database_id` int(10) NOT NULL,
  `is_infraspecies` int(1) NOT NULL DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`),
  KEY `common_name` (`common_name`),
  KEY `name_code` (`name_code`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `distribution`
--------------

--------------
CREATE TABLE  `distribution` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL,
  `distribution` longtext,
  `StandardInUse` varchar(255) DEFAULT NULL,
  
   `DistributionStatus` varchar(255),
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `lifezone`
--------------

--------------
CREATE TABLE  `lifezone` (
  `record_id` int(11) NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42),
  `lifezone` varchar(255),
  `database_id` int(10),
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`),
  KEY `database_id` (`database_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `scientific_name_references`
--------------

--------------
CREATE TABLE  `scientific_name_references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `name_code` varchar(42) NOT NULL DEFAULT '',
  `reference_type` varchar(10) DEFAULT NULL,
  `reference_id` int(10) DEFAULT '0',
  `reference_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`),
  KEY `name_code` (`name_code`,`reference_id`,`reference_type`),
  KEY `name_code_2` (`name_code`,`reference_type`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `references`
--------------

--------------
CREATE TABLE  `references` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `author` varchar(200) DEFAULT NULL,
  `year` varchar(50) DEFAULT NULL,
  `title` longtext,
  `source` longtext,
  `database_id` int(10) NOT NULL,
  `reference_code` varchar(50) DEFAULT NULL,
  PRIMARY KEY (`record_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
DROP TABLE IF EXISTS `specialists`
--------------

--------------
CREATE TABLE  `specialists` (
  `record_id` int(10) unsigned NOT NULL AUTO_INCREMENT,
  `specialist_name` varchar(255) NOT NULL DEFAULT '',
  `specialist_code` varchar(50) DEFAULT NULL,
  `database_id` int(10) NOT NULL,
  PRIMARY KEY (`record_id`)
) ENGINE=MyISAM DEFAULT CHARACTER SET = utf8 COLLATE = utf8_bin
--------------

--------------
INSERT INTO `sp2000_statuses` 
VALUES (1,'accepted name'),
(2,'ambiguous synonym'),
(3,'misapplied name'),
(4,'provisionally accepted name'),
(5,'synonym')
--------------

--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------

\n\n\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n\n
\nCreation of the assembly database completed.\n
Starting structural transformations (ACEF3 to ACI)
--------------
SET @dbid = 108
--------------

--------------
SET @dbabbr = 'W-Bch-'
--------------

--------------
SET @dbtouse = 'Buffer_Brachyura'
--------------

--------------
UPDATE `databases` SET `taxonomic_coverage`="Animalia - Arthropoda - Malacostraca - Decapoda - Infraorder Brachyura - Acidopsidae, Aethridae, Aphanodactylidae, Atelecyclidae, Belliidae, Bythograeidae, Calappidae, Camptandriidae, Cancridae, Carpiliidae, Chasmocarcinidae, Cheiragonidae, Conleyidae, Corystidae, Crossotonotidae, Cryptochiridae, Cyclodorippidae, Cymonomidae, Dacryopilumnidae, Dairidae, Dairoididae, Domeciidae, Dorippidae, Dotillidae, Dromiidae, Dynomenidae, Epialtidae, Eriphiidae, Ethusidae, Euryplacidae, Galenidae, Gecarcinidae, Gecarcinucidae, Geryonidae, Glyptograpsidae, Goneplacidae, Grapsidae, Heloeciidae, Hexapodidae, Homolidae, Homolodromiidae, Hymenosomatidae, Hypothalassiidae, Inachidae, Inachoididae, Iphiculidae, Latreilliidae, Leucosiidae, Litocheiridae, Macrophthalmidae, Majidae, Mathildellidae, Matutidae, Menippidae, Mictyridae, Ocypodidae, Oregoniidae, Orithyiidae, Oziidae, Palicidae, Panopeidae, Parthenopidae, Percnidae, Phyllotymolinidae, Pilumnidae, Pilumnoididae, Pinnotheridae, Pirimelidae, Plagusiidae, Planopilumnidae, Platyxanthidae, Polybiidae, Portunidae, Potamidae, Potamonautidae, Poupiniidae, Progeryonidae, Pseudorhombilidae, Pseudothelphusidae, Pseudoziidae, Raninidae, Retroplumidae, Scalopidiidae, Sesarmidae, Sotoplacidae, Tanaochelidae, Tetraliidae, Thiidae, Trapeziidae, Trichopeltariidae, Ucididae, Varunidae, Vultocinidae, Xanthidae, Xenograpsidae, Xenophthalmidae", `is_new` = 2, `taxa`="Crabs", `coverage`="Global", `completeness` = 100, `confidence` = 5
--------------

--------------
SET foreign_key_checks = 0
--------------

--------------
TRUNCATE TABLE `databases`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `databases` 
 SELECT
 CONCAT(`DatabaseShortName`, ': ', `DatabaseFullName`)  AS `database_name_displayed`,
 @dbid AS `record_id`,
 `DatabaseShortName` AS `database_name`,
 `DatabaseFullName` AS `database_full_name`,
  `HomeURL` AS `web_site`,
  `Organisation` AS `organization`,
  `ContactPerson` AS `contact_person`,
  `GroupNameInEnglish` AS `taxa`,
  `TaxonomicCoverage` AS `taxonomic_coverage`,
  `Abstract` AS `abstract`,
  `DatabaseVersion` AS `version`,
  `ReleaseDate` AS `release_date`,
  `Coverage` AS `SpeciesCount`,
  `Completeness` AS `SpeciesEst`,
  `AuthorsEditors` AS `authors_editors`,
  NULL AS `accepted_species_names`,
  NULL AS `accepted_infraspecies_names`,
  NULL AS `species_synonyms`,
  NULL AS `infraspecies_synonyms`,
  NULL AS `common_names`,
  NULL AS `total_names`,
  NULL AS `is_new`,
  NULL AS `coverage`,
  NULL AS `completeness`,
  NULL AS `confidence`
  FROM ",
@dbtouse,
".`SourceDatabase`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `distribution`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `distribution` 
 SELECT
 NULL AS `record_id`,
 CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
 `Distribution` AS `distribution`,
 `StandardInUse` AS `StandardInUse`, 
 `DistributionStatus` AS `DistributionStatus`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`Distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `families`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `families`
SELECT DISTINCT
NULL AS `record_id`,
NULL AS `hierarchy_code`,
`Kingdom` AS `kingdom`,
`Phylum` AS `phylum`,
`Class` AS `class`,
`Order` AS `order`,
`Family` AS `family`,
`Superfamily` AS `superfamily`,
@dbid AS `database_id`,
NULL AS `family_code`,
NULL AS `is_accepted_name`
FROM ",
@dbtouse,
".`AcceptedSpecies`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `families` SET `family_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `specialists`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `specialists`
SELECT DISTINCT 
NULL  AS `record_id`,
`LTSSpecialist` AS `specialist_name`,
NULL AS `specialist_code`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies` 
WHERE `LTSSpecialist` IS NOT NULL OR 
`LTSSpecialist` != ''")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
UPDATE `specialists` SET `specialist_code` = CONCAT(@dbabbr,record_id)
--------------

--------------
TRUNCATE TABLE `scientific_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT 
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`SpeciesURL` AS `web_site`,
`Genus` AS `genus`,
`SubGenusName` AS `subgenus`,
`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
NULL  AS `infraspecies`,
NULL  AS `infraspecies_marker`,
`AuthorString` AS `author`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `accepted_name_code`,
`AdditionalData` AS `comment`,
`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
`specialists`.`record_id` AS `specialist_id`,
`families`.`record_id` AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
`families`.`family_code` AS `family_code`,
1 AS `is_accepted_name`,
`GSDTaxonGUI` AS `GSDTaxonGUI`,
`GSDNameGUI` AS `GSDNameGUI`
FROM ",
@dbtouse,
".`AcceptedSpecies` AcceptedSpecies
LEFT OUTER JOIN `families` ON 
(`AcceptedSpecies`.`Kingdom` = `families`.`kingdom` AND
`AcceptedSpecies`.`Phylum` = `families`.`phylum` AND
`AcceptedSpecies`.`Class` = `families`.`class` AND
`AcceptedSpecies`.`Order` = `families`.`order` AND
`AcceptedSpecies`.`Superfamily` = `families`.`superfamily` AND
`AcceptedSpecies`.`Family` = `families`.`family`)
LEFT OUTER JOIN `specialists` ON
`AcceptedSpecies`.`LTSSpecialist` = `specialists`.`specialist_name`
LEFT OUTER JOIN `sp2000_statuses` ON
`AcceptedSpecies`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`
WHERE `AcceptedSpecies`.`IsFossil` = 0")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `lifezone`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `lifezone`
SELECT 
NULL AS `record_id`,
CONCAT(@dbabbr,`AcceptedTaxonID`) AS `name_code`,
`LifeZone` AS `lifezone`,
@dbid AS `database_id`
FROM ",
@dbtouse,
".`AcceptedSpecies`
WHERE `LifeZone` IN('marine','freshwater','Marine','Freshwater')")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT 
NULL AS `record_id`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `name_code`,
NULL AS `web_site`,
`sn`.`genus` AS `genus`,
NULL AS `subgenus`,
`sn`.`species` AS `species`,
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) AS `infraspecies_parent_name_code`,
`AIT`.`InfraSpeciesEpithet` AS `infraspecies`,
`AIT`.`InfraSpecificMarker` AS `infraspecies_marker`,
`AIT`.`InfraSpecificAuthorString` AS `author`,
CONCAT(@dbabbr,`AIT`.`AcceptedTaxonID`) AS `accepted_name_code`,
`AIT`.`AdditionalData` AS `comment`,
`AIT`.`LTSDate` AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
`specialists`.`specialist_code` AS `specialist_code`,
sn.family_code AS `family_code`,
1 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`AIT`.`GSDNameGUI` AS `GSDNameGUI` 
FROM ",
@dbtouse,
".`AcceptedInfraSpecificTaxa` AIT
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`AIT`.`ParentSpeciesID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`AIT`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`
LEFT OUTER JOIN `specialists` ON
`AIT`.`LTSSpecialist` = `specialists`.`specialist_name`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_names`
SELECT 
NULL AS `record_id`,
CONCAT(@dbabbr,`Synonyms`.`ID`) AS `name_code`,
NULL AS `web_site`,
`Synonyms`.`Genus` AS `genus`,
`Synonyms`.`SubGenusName` AS `subgenus`,
`Synonyms`.`Species` AS `species`,
NULL AS `infraspecies_parent_name_code`,
`Synonyms`.`InfraSpecies` AS `infraspecies`,
`Synonyms`.`InfraSpecificMarker` AS `infraspecies_marker`,
`Synonyms`.`AuthorString` AS `author`,
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) AS `accepted_name_code`,
NULL AS `comment`,
NULL AS `scrutiny_date`,
`sp2000_statuses`.`record_id` AS `sp2000_status_id`,
@dbid AS `database_id`,
NULL AS `specialist_id`,
NULL AS `family_id`,
sn.`specialist_code` AS `specialist_code`,
sn.`family_code` AS `family_code`,
0 AS `is_accepted_name`,
NULL AS `GSDTaxonGUI`,
`Synonyms`.`GSDNameGUI` AS `GSDNameGUI` 
FROM ",
@dbtouse,
".`Synonyms` Synonyms
LEFT OUTER JOIN scientific_names sn ON
CONCAT(@dbabbr,`Synonyms`.`AcceptedTaxonID`) = `sn`.`name_code`
LEFT OUTER JOIN `sp2000_statuses` ON
`Synonyms`.`Sp2000NameStatus` = `sp2000_statuses`.`sp2000_status`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `common_names`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `common_names` 
SELECT
NULL, 
CONCAT(@dbabbr, `AcceptedTaxonID`) AS `name_code`,
CONVERT(`CommonName` USING utf8) AS `common_name`,
`Transliteration` AS `transliteration`,
`Language` AS `language`,
`Country` AS `country`,
`Area` AS `area`,
 NULL AS `reference_ID`,
@dbid AS `database_ID`,
 NULL AS `is_infraspecies`,
 `ReferenceID` AS `reference_code`
 FROM ",
@dbtouse,
".`CommonNames`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `references` 
SELECT
NULL AS `record_id`, 
`Authors` AS `author`,
`Year` AS `year`,
NULL AS `title`,
`Title` AS `source`,
@dbid AS `database_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`
 FROM ",
@dbtouse,
".`References`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
TRUNCATE TABLE `scientific_name_references`
--------------

--------------
SET @query = CONCAT("
INSERT INTO `scientific_name_references` 
SELECT
NULL AS `record_id`,
CONCAT(@dbabbr, `ID`) AS `name_code`,	
`ReferenceType` AS `reference_type`,	
NULL AS `reference_id`,
CONCAT(@dbabbr, `ReferenceID`) AS `reference_code`,
@dbid AS `database_id`
 FROM ",
@dbtouse,
".`NameReferencesLinks`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET foreign_key_checks = 1
--------------

\n\n\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n\n
\nData Loaded.
</pre>
</pre><hr><b>Backing up...</b>\n<pre>
Creating directory  23_38_07_05Apr2015
Backing up files
</pre><hr><b>Executing local editorial checks</b>\n<pre>
<pre>
Integrity and editorial checks - this may take a while depending on size of the dataset...\n
Starting local editorial transformations
--------------
DELETE FROM `common_names` WHERE `common_name` IS NULL OR `common_name` = ""
--------------

--------------
DELETE FROM `distribution` WHERE `distribution` IS NULL OR `distribution` = ""
--------------

--------------
DELETE FROM `references` WHERE (`title` IS NULL OR `title` = "") AND (`author` IS NULL OR `author` = "")
--------------

--------------
DELETE FROM `specialists` WHERE `specialist_name` IS NULL OR `specialist_name` = ""
--------------

--------------
DELETE FROM `scientific_names` WHERE (`species` IS NULL OR `species` LIKE "%sp.%" OR `species` LIKE "%spp.%") AND `infraspecies` IS NULL
--------------

--------------
DELETE FROM `scientific_names` WHERE `genus` IS NULL OR `genus` = "" OR genus like "% %" OR `genus` LIKE '%sp.%' OR `genus` LIKE "%spp.%"
--------------

--------------
UPDATE `scientific_names` SET `family_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `specialist_id` = NULL
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "forma" WHERE `infraspecies_marker` LIKE "f.%"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "var." WHERE `infraspecies_marker` LIKE "Variety"
--------------

--------------
UPDATE `scientific_names` SET `infraspecies_marker` = "subsp." WHERE `infraspecies_marker` LIKE "Subspecies"
--------------

--------------
UPDATE `scientific_names` SET `sp2000_status_id` = 5 WHERE `sp2000_status_id` IS NULL AND `is_accepted_name` = 0
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE `family` LIKE "% %"
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE `order` LIKE "% %"
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE `class` LIKE "% %"
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE `phylum` LIKE "% %"
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE `kingdom` LIKE "% %"
--------------

--------------
UPDATE `families` SET `family` = "Not assigned" WHERE (`family` IS NULL OR `family` = '')
--------------

--------------
UPDATE `families` SET `order` = "Not assigned" WHERE (`order` IS NULL OR `order` = '')
--------------

--------------
UPDATE `families` SET `class` = "Not assigned" WHERE (`class` IS NULL OR `class` = '')
--------------

--------------
UPDATE `families` SET `phylum` = "Not assigned" WHERE (`phylum` IS NULL OR `phylum` = '')
--------------

--------------
UPDATE `families` SET `kingdom` = "Not assigned" WHERE (`kingdom` IS NULL OR `kingdom` = '')
--------------

--------------
UPDATE `families` SET `hierarchy_code` = CONCAT(`kingdom`,'-',`phylum`,'-',`class`,'-',`order`,'-',`family`)
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "subsequent type designation%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "Nom%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "taxonomy source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "additional source%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "NomRef" WHERE `reference_type` LIKE "original description%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "source of synonymy%"
--------------

--------------
UPDATE `scientific_name_references` SET `reference_type` = "TaxAccRef" WHERE `reference_type` LIKE "basis of record%"
--------------

--------------
UPDATE `databases` SET database_name_displayed = REPLACE(database_name_displayed,'_',' ')
--------------

--------------
UPDATE `databases` SET database_name = REPLACE(database_name,'_',' ')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ',', '')
--------------

--------------
UPDATE `databases` SET authors_editors = REPLACE(authors_editors, ';', ',')
--------------

--------------
SELECT "Duplicate accepted names:", sn.name_code, sn.sp2000_status_id, dups.genus, dups.species, dups.infraspecies_marker, dups.infraspecies, dups.author FROM (SELECT genus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt FROM scientific_names GROUP BY genus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) dups LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1
--------------

Duplicate accepted names:	name_code	sp2000_status_id	genus	species	infraspecies_marker	infraspecies	author
Duplicate accepted names:	W-Bch-442856	1	Charybdis	philippinensis	NULL	NULL	Ward, 1941
Duplicate accepted names:	W-Bch-442871	1	Charybdis	philippinensis	NULL	NULL	Ward, 1941
Duplicate accepted names:	W-Bch-241086	1	Elamena	gordonae	NULL	NULL	Monod, 1956
Duplicate accepted names:	W-Bch-441746	1	Elamena	gordonae	NULL	NULL	Monod, 1956
Duplicate accepted names:	W-Bch-456087	1	Hypolobocera	aequatorialis	Forma	delsolari f. isabella	
Duplicate accepted names:	W-Bch-459143	1	Hypolobocera	aequatorialis	Forma	delsolari f. isabella	
Duplicate accepted names:	W-Bch-459280	1	Macrophthalmus	hilgendorfi	NULL	NULL	Tesch, 1915
Duplicate accepted names:	W-Bch-209425	1	Macrophthalmus	hilgendorfi	NULL	NULL	Tesch, 1915
Duplicate accepted names:	W-Bch-456119	1	Potamon	atkinsonianum	NULL	NULL	
Duplicate accepted names:	W-Bch-456121	1	Potamon	atkinsonianum	NULL	NULL	
Duplicate accepted names:	W-Bch-456112	1	Potamon	atkinsonianum	NULL	NULL	
Duplicate accepted names:	W-Bch-241207	1	Sesarma	buettikoferi	NULL	NULL	de Man, 1883
Duplicate accepted names:	W-Bch-444494	1	Sesarma	buettikoferi	NULL	NULL	de Man, 1883
--------------
SELECT "Accepted name to be retained", MAX(name_code), genus, species, infraspecies_marker, infraspecies, author FROM
(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author FROM (SELECT genus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt FROM scientific_names GROUP BY genus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) dups LEFT JOIN scientific_names sn
ON sn.genus = dups.genus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2 GROUP BY genus, species, infraspecies_marker, infraspecies, author
--------------

Accepted name to be retained	MAX(name_code)	genus	species	infraspecies_marker	infraspecies	author
Accepted name to be retained	W-Bch-442871	Charybdis	philippinensis	NULL	NULL	Ward, 1941
Accepted name to be retained	W-Bch-441746	Elamena	gordonae	NULL	NULL	Monod, 1956
Accepted name to be retained	W-Bch-459143	Hypolobocera	aequatorialis	Forma	delsolari f. isabella	
Accepted name to be retained	W-Bch-459280	Macrophthalmus	hilgendorfi	NULL	NULL	Tesch, 1915
Accepted name to be retained	W-Bch-456121	Potamon	atkinsonianum	NULL	NULL	
Accepted name to be retained	W-Bch-444494	Sesarma	buettikoferi	NULL	NULL	de Man, 1883
--------------
SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author FROM (SELECT genus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt FROM scientific_names GROUP BY genus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) dups LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1
AND sn.name_code NOT IN (SELECT dups3.namecodes_to_keep FROM
(SELECT MAX(name_code) AS namecodes_to_keep, genus, species, infraspecies_marker, infraspecies, author FROM
(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author FROM (SELECT genus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
FROM scientific_names
GROUP BY genus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) dups
LEFT JOIN scientific_names sn
ON sn.genus = dups.genus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2 GROUP BY genus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

Accepted name to be deleted	name_code	sp2000_status_id	genus	species	infraspecies_marker	infraspecies	author
Accepted name to be deleted	W-Bch-442856	1	Charybdis	philippinensis	NULL	NULL	Ward, 1941
Accepted name to be deleted	W-Bch-241086	1	Elamena	gordonae	NULL	NULL	Monod, 1956
Accepted name to be deleted	W-Bch-456087	1	Hypolobocera	aequatorialis	Forma	delsolari f. isabella	
Accepted name to be deleted	W-Bch-209425	1	Macrophthalmus	hilgendorfi	NULL	NULL	Tesch, 1915
Accepted name to be deleted	W-Bch-456119	1	Potamon	atkinsonianum	NULL	NULL	
Accepted name to be deleted	W-Bch-456112	1	Potamon	atkinsonianum	NULL	NULL	
Accepted name to be deleted	W-Bch-241207	1	Sesarma	buettikoferi	NULL	NULL	de Man, 1883
--------------
SELECT 'Common name without parent accepted name', record_id, common_name, name_code FROM common_names
WHERE name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names)
--------------

--------------
CREATE TEMPORARY TABLE scientific_names_tmp AS SELECT * FROM scientific_names
--------------

--------------
SELECT 'Missing parent accepted name for synonym', record_id, name_code, genus, species, infraspecies, accepted_name_code FROM scientific_names
WHERE is_accepted_name != 1 AND family_code IS NULL
--------------

Missing parent accepted name for synonym	record_id	name_code	genus	species	infraspecies	accepted_name_code
Missing parent accepted name for synonym	10396	W-Bch-467755	Paralbunea	taipeiensis		W-Bch-467754
Missing parent accepted name for synonym	12057	W-Bch-453323	Hedrophthalmus	thalamithoides		W-Bch-447782
Missing parent accepted name for synonym	12060	W-Bch-451769	Neothalamita	triangularis		W-Bch-447782
--------------
SELECT 'Missing parent accepted name for infraspecies', record_id, name_code, genus, species, infraspecies, infraspecies_parent_name_code FROM scientific_names WHERE LENGTH(infraspecies)>1  AND family_code IS NULL
--------------

--------------
SELECT 'Lifezone without parent accepted name', record_id, name_code, lifezone FROM lifezone
WHERE name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names)
--------------

--------------
SELECT 'Distribution without parent accepted name', record_id, name_code, distribution FROM distribution
WHERE name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names)
--------------

Distribution without parent accepted name	record_id	name_code	distribution
Distribution without parent accepted name	3171	W-Bch-467754	Taiwan
--------------
SELECT 'Accepted name without parent family', record_id, name_code, genus, species, infraspecies, family_code FROM scientific_names
WHERE family_code NOT IN(SELECT DISTINCT family_code FROM families)
--------------

--------------
SELECT 'Reference link to non-existing accepted name', record_id, reference_code, name_code FROM scientific_name_references
WHERE name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names)
--------------

Reference link to non-existing accepted name	record_id	reference_code	name_code
Reference link to non-existing accepted name	69	W-Bch-685	W-Bch-181330
Reference link to non-existing accepted name	443	W-Bch-22039	W-Bch-739454
Reference link to non-existing accepted name	552	W-Bch-129876	W-Bch-392901
Reference link to non-existing accepted name	553	W-Bch-129876	W-Bch-392902
Reference link to non-existing accepted name	593	W-Bch-141675	W-Bch-467839
Reference link to non-existing accepted name	594	W-Bch-19343	W-Bch-478168
Reference link to non-existing accepted name	621	W-Bch-2811	W-Bch-175644
Reference link to non-existing accepted name	643	W-Bch-5890	W-Bch-209173
Reference link to non-existing accepted name	683	W-Bch-8	W-Bch-383175
Reference link to non-existing accepted name	700	W-Bch-154097	W-Bch-411986
Reference link to non-existing accepted name	701	W-Bch-154097	W-Bch-412022
Reference link to non-existing accepted name	738	W-Bch-153971	W-Bch-589762
Reference link to non-existing accepted name	739	W-Bch-153971	W-Bch-590005
Reference link to non-existing accepted name	818	W-Bch-8	W-Bch-383055
Reference link to non-existing accepted name	829	W-Bch-129876	W-Bch-392861
Reference link to non-existing accepted name	832	W-Bch-154097	W-Bch-412025
Reference link to non-existing accepted name	844	W-Bch-162581	W-Bch-440212
Reference link to non-existing accepted name	859	W-Bch-45702	W-Bch-452363
Reference link to non-existing accepted name	898	W-Bch-5954	W-Bch-208845
Reference link to non-existing accepted name	1018	W-Bch-1363	W-Bch-175622
Reference link to non-existing accepted name	1062	W-Bch-153971	W-Bch-377798
Reference link to non-existing accepted name	1111	W-Bch-153971	W-Bch-587688
Reference link to non-existing accepted name	1112	W-Bch-153971	W-Bch-587799
Reference link to non-existing accepted name	1113	W-Bch-153971	W-Bch-589403
Reference link to non-existing accepted name	1124	W-Bch-154097	W-Bch-148502
Reference link to non-existing accepted name	1185	W-Bch-154097	W-Bch-412007
Reference link to non-existing accepted name	1186	W-Bch-671	W-Bch-412031
Reference link to non-existing accepted name	1212	W-Bch-124982	W-Bch-459343
Reference link to non-existing accepted name	1213	W-Bch-144474	W-Bch-478192
Reference link to non-existing accepted name	1222	W-Bch-154753	W-Bch-587338
Reference link to non-existing accepted name	1223	W-Bch-40146	W-Bch-588703
Reference link to non-existing accepted name	1224	W-Bch-153971	W-Bch-588832
Reference link to non-existing accepted name	1225	W-Bch-153971	W-Bch-589232
Reference link to non-existing accepted name	1286	W-Bch-5992	W-Bch-210219
Reference link to non-existing accepted name	1368	W-Bch-153971	W-Bch-589342
Reference link to non-existing accepted name	1443	W-Bch-42308	W-Bch-241115
Reference link to non-existing accepted name	1489	W-Bch-671	W-Bch-467694
Reference link to non-existing accepted name	1490	W-Bch-19343	W-Bch-478213
Reference link to non-existing accepted name	1495	W-Bch-153971	W-Bch-589587
Reference link to non-existing accepted name	1603	W-Bch-8	W-Bch-587161
Reference link to non-existing accepted name	1686	W-Bch-154097	W-Bch-412027
Reference link to non-existing accepted name	1687	W-Bch-671	W-Bch-412028
Reference link to non-existing accepted name	1721	W-Bch-153971	W-Bch-587625
Reference link to non-existing accepted name	1722	W-Bch-153971	W-Bch-589565
Reference link to non-existing accepted name	1799	W-Bch-154097	W-Bch-412030
Reference link to non-existing accepted name	1828	W-Bch-8	W-Bch-467792
Reference link to non-existing accepted name	1829	W-Bch-8	W-Bch-467799
Reference link to non-existing accepted name	1836	W-Bch-153971	W-Bch-585667
Reference link to non-existing accepted name	1837	W-Bch-153971	W-Bch-587162
Reference link to non-existing accepted name	1838	W-Bch-153971	W-Bch-589404
Reference link to non-existing accepted name	1912	W-Bch-141675	W-Bch-412568
Reference link to non-existing accepted name	1949	W-Bch-153971	W-Bch-584949
Reference link to non-existing accepted name	1950	W-Bch-153971	W-Bch-585451
Reference link to non-existing accepted name	1951	W-Bch-153971	W-Bch-589761
Reference link to non-existing accepted name	2027	W-Bch-8	W-Bch-383071
Reference link to non-existing accepted name	2030	W-Bch-154097	W-Bch-412026
Reference link to non-existing accepted name	2061	W-Bch-671	W-Bch-467800
Reference link to non-existing accepted name	2062	W-Bch-40146	W-Bch-478169
Reference link to non-existing accepted name	2063	W-Bch-671	W-Bch-493202
Reference link to non-existing accepted name	2107	W-Bch-5960	W-Bch-209449
Reference link to non-existing accepted name	2145	W-Bch-154097	W-Bch-412019
Reference link to non-existing accepted name	2181	W-Bch-671	W-Bch-584979
Reference link to non-existing accepted name	2254	W-Bch-8	W-Bch-383102
Reference link to non-existing accepted name	2288	W-Bch-4199	W-Bch-456757
Reference link to non-existing accepted name	2289	W-Bch-124982	W-Bch-459341
Reference link to non-existing accepted name	2291	W-Bch-144473	W-Bch-478044
Reference link to non-existing accepted name	2302	W-Bch-153971	W-Bch-589078
Reference link to non-existing accepted name	2303	W-Bch-153971	W-Bch-589596
Reference link to non-existing accepted name	2320	W-Bch-5919	W-Bch-208829
Reference link to non-existing accepted name	2357	W-Bch-628	W-Bch-295552
Reference link to non-existing accepted name	2365	W-Bch-154097	W-Bch-412021
Reference link to non-existing accepted name	2397	W-Bch-124982	W-Bch-459342
Reference link to non-existing accepted name	2398	W-Bch-141655	W-Bch-467754
Reference link to non-existing accepted name	2404	W-Bch-153971	W-Bch-586044
Reference link to non-existing accepted name	2405	W-Bch-153971	W-Bch-587014
Reference link to non-existing accepted name	2406	W-Bch-153971	W-Bch-588725
Reference link to non-existing accepted name	2407	W-Bch-153971	W-Bch-589763
Reference link to non-existing accepted name	2408	W-Bch-153971	W-Bch-589861
--------------
SELECT 'Reference link to non-existing reference', record_id, reference_code, name_code FROM scientific_name_references
WHERE reference_code NOT IN(SELECT DISTINCT reference_code FROM `references`)
--------------

Reference link to non-existing reference	record_id	reference_code	name_code
Reference link to non-existing reference	1	W-Bch-147411	W-Bch-442960
Reference link to non-existing reference	2	W-Bch-2901	W-Bch-158053
Reference link to non-existing reference	6	W-Bch-147412	W-Bch-107387
Reference link to non-existing reference	7	W-Bch-147411	W-Bch-442955
Reference link to non-existing reference	8	W-Bch-2901	W-Bch-158443
Reference link to non-existing reference	9	W-Bch-2901	W-Bch-158445
Reference link to non-existing reference	10	W-Bch-147411	W-Bch-107264
Reference link to non-existing reference	13	W-Bch-147411	W-Bch-107380
Reference link to non-existing reference	28	W-Bch-147411	W-Bch-107442
Reference link to non-existing reference	31	W-Bch-147411	W-Bch-107358
Reference link to non-existing reference	46	W-Bch-147411	W-Bch-107348
Reference link to non-existing reference	47	W-Bch-147411	W-Bch-107315
Reference link to non-existing reference	48	W-Bch-163039	W-Bch-107458
Reference link to non-existing reference	49	W-Bch-147411	W-Bch-459383
Reference link to non-existing reference	50	W-Bch-2901	W-Bch-107284
Reference link to non-existing reference	51	W-Bch-2901	W-Bch-158461
Reference link to non-existing reference	53	W-Bch-147411	W-Bch-107392
Reference link to non-existing reference	54	W-Bch-147411	W-Bch-107345
Reference link to non-existing reference	55	W-Bch-147411	W-Bch-107350
Reference link to non-existing reference	70	W-Bch-147411	W-Bch-107441
Reference link to non-existing reference	84	W-Bch-2901	W-Bch-158051
Reference link to non-existing reference	85	W-Bch-2901	W-Bch-107379
Reference link to non-existing reference	86	W-Bch-163039	W-Bch-107303
Reference link to non-existing reference	89	W-Bch-147411	W-Bch-107323
Reference link to non-existing reference	99	W-Bch-147411	W-Bch-107455
Reference link to non-existing reference	101	W-Bch-147411	W-Bch-107302
Reference link to non-existing reference	118	W-Bch-2901	W-Bch-158055
Reference link to non-existing reference	145	W-Bch-147411	W-Bch-107268
Reference link to non-existing reference	146	W-Bch-147411	W-Bch-107386
Reference link to non-existing reference	147	W-Bch-2901	W-Bch-158458
Reference link to non-existing reference	148	W-Bch-2901	W-Bch-158462
Reference link to non-existing reference	149	W-Bch-147411	W-Bch-107393
Reference link to non-existing reference	179	W-Bch-42	W-Bch-395036
Reference link to non-existing reference	181	W-Bch-2901	W-Bch-158449
Reference link to non-existing reference	182	W-Bch-10085	W-Bch-107397
Reference link to non-existing reference	210	W-Bch-2901	W-Bch-158046
Reference link to non-existing reference	218	W-Bch-147411	W-Bch-107292
Reference link to non-existing reference	232	W-Bch-2901	W-Bch-158049
Reference link to non-existing reference	233	W-Bch-147411	W-Bch-107404
Reference link to non-existing reference	260	W-Bch-2901	W-Bch-158052
Reference link to non-existing reference	261	W-Bch-9810	W-Bch-234117
Reference link to non-existing reference	284	W-Bch-147411	W-Bch-107394
Reference link to non-existing reference	286	W-Bch-147411	W-Bch-107374
Reference link to non-existing reference	287	W-Bch-2901	W-Bch-158454
Reference link to non-existing reference	297	W-Bch-147411	W-Bch-444382
Reference link to non-existing reference	311	W-Bch-42	W-Bch-395016
Reference link to non-existing reference	312	W-Bch-147411	W-Bch-107373
Reference link to non-existing reference	313	W-Bch-2901	W-Bch-158455
Reference link to non-existing reference	316	W-Bch-147411	W-Bch-107464
Reference link to non-existing reference	338	W-Bch-2901	W-Bch-158407
Reference link to non-existing reference	339	W-Bch-2901	W-Bch-158420
Reference link to non-existing reference	360	W-Bch-147411	W-Bch-442950
Reference link to non-existing reference	361	W-Bch-147411	W-Bch-107402
Reference link to non-existing reference	363	W-Bch-2901	W-Bch-107360
Reference link to non-existing reference	384	W-Bch-2901	W-Bch-158044
Reference link to non-existing reference	386	W-Bch-2901	W-Bch-158425
Reference link to non-existing reference	409	W-Bch-147411	W-Bch-107349
Reference link to non-existing reference	410	W-Bch-2901	W-Bch-158431
Reference link to non-existing reference	411	W-Bch-2901	W-Bch-158453
Reference link to non-existing reference	412	W-Bch-147411	W-Bch-224583
Reference link to non-existing reference	434	W-Bch-2901	W-Bch-158435
Reference link to non-existing reference	524	W-Bch-42308	W-Bch-241046
Reference link to non-existing reference	525	W-Bch-42308	W-Bch-241060
Reference link to non-existing reference	526	W-Bch-42308	W-Bch-241063
Reference link to non-existing reference	527	W-Bch-42308	W-Bch-241077
Reference link to non-existing reference	529	W-Bch-42308	W-Bch-241127
Reference link to non-existing reference	530	W-Bch-42308	W-Bch-241145
Reference link to non-existing reference	531	W-Bch-42308	W-Bch-241178
Reference link to non-existing reference	532	W-Bch-42308	W-Bch-241195
Reference link to non-existing reference	665	W-Bch-42308	W-Bch-241026
Reference link to non-existing reference	666	W-Bch-42308	W-Bch-241033
Reference link to non-existing reference	667	W-Bch-42308	W-Bch-241076
Reference link to non-existing reference	668	W-Bch-42308	W-Bch-241083
Reference link to non-existing reference	669	W-Bch-42308	W-Bch-241090
Reference link to non-existing reference	670	W-Bch-42308	W-Bch-241133
Reference link to non-existing reference	671	W-Bch-42308	W-Bch-241176
Reference link to non-existing reference	672	W-Bch-42308	W-Bch-241183
Reference link to non-existing reference	673	W-Bch-42308	W-Bch-241190
Reference link to non-existing reference	756	W-Bch-42	W-Bch-158414
Reference link to non-existing reference	802	W-Bch-42308	W-Bch-241053
Reference link to non-existing reference	803	W-Bch-42308	W-Bch-241070
Reference link to non-existing reference	804	W-Bch-42308	W-Bch-241104
Reference link to non-existing reference	805	W-Bch-42308	W-Bch-241121
Reference link to non-existing reference	806	W-Bch-42308	W-Bch-241155
Reference link to non-existing reference	808	W-Bch-42308	W-Bch-241172
Reference link to non-existing reference	809	W-Bch-42308	W-Bch-241189
Reference link to non-existing reference	830	W-Bch-42	W-Bch-395028
Reference link to non-existing reference	939	W-Bch-8940	W-Bch-238404
Reference link to non-existing reference	941	W-Bch-42308	W-Bch-241047
Reference link to non-existing reference	942	W-Bch-42308	W-Bch-241062
Reference link to non-existing reference	943	W-Bch-42308	W-Bch-241112
Reference link to non-existing reference	945	W-Bch-42308	W-Bch-241161
Reference link to non-existing reference	946	W-Bch-42308	W-Bch-241197
Reference link to non-existing reference	947	W-Bch-42308	W-Bch-241211
Reference link to non-existing reference	1054	W-Bch-42308	W-Bch-241056
Reference link to non-existing reference	1055	W-Bch-42308	W-Bch-241067
Reference link to non-existing reference	1056	W-Bch-42308	W-Bch-241106
Reference link to non-existing reference	1057	W-Bch-42308	W-Bch-241124
Reference link to non-existing reference	1058	W-Bch-42308	W-Bch-241149
Reference link to non-existing reference	1059	W-Bch-42308	W-Bch-241174
Reference link to non-existing reference	1060	W-Bch-42308	W-Bch-241199
Reference link to non-existing reference	1161	W-Bch-42308	W-Bch-241054
Reference link to non-existing reference	1162	W-Bch-42308	W-Bch-241069
Reference link to non-existing reference	1164	W-Bch-42308	W-Bch-241105
Reference link to non-existing reference	1165	W-Bch-42308	W-Bch-241120
Reference link to non-existing reference	1166	W-Bch-42308	W-Bch-241139
Reference link to non-existing reference	1167	W-Bch-42308	W-Bch-241169
Reference link to non-existing reference	1169	W-Bch-42308	W-Bch-241203
Reference link to non-existing reference	1170	W-Bch-42308	W-Bch-241205
Reference link to non-existing reference	1293	W-Bch-42308	W-Bch-241027
Reference link to non-existing reference	1294	W-Bch-42308	W-Bch-241028
Reference link to non-existing reference	1295	W-Bch-42308	W-Bch-241045
Reference link to non-existing reference	1296	W-Bch-42308	W-Bch-241078
Reference link to non-existing reference	1297	W-Bch-42308	W-Bch-241095
Reference link to non-existing reference	1298	W-Bch-42308	W-Bch-241096
Reference link to non-existing reference	1299	W-Bch-42308	W-Bch-241146
Reference link to non-existing reference	1300	W-Bch-42308	W-Bch-241160
Reference link to non-existing reference	1301	W-Bch-42308	W-Bch-241163
Reference link to non-existing reference	1302	W-Bch-42308	W-Bch-241164
Reference link to non-existing reference	1303	W-Bch-42308	W-Bch-241177
Reference link to non-existing reference	1440	W-Bch-42308	W-Bch-241051
Reference link to non-existing reference	1441	W-Bch-42308	W-Bch-241058
Reference link to non-existing reference	1442	W-Bch-42308	W-Bch-241065
Reference link to non-existing reference	1443	W-Bch-42308	W-Bch-241115
Reference link to non-existing reference	1444	W-Bch-42308	W-Bch-241151
Reference link to non-existing reference	1445	W-Bch-42308	W-Bch-241158
Reference link to non-existing reference	1447	W-Bch-42308	W-Bch-241201
Reference link to non-existing reference	1448	W-Bch-42308	W-Bch-241208
Reference link to non-existing reference	1456	W-Bch-42	W-Bch-395017
Reference link to non-existing reference	1545	W-Bch-42308	W-Bch-241073
Reference link to non-existing reference	1546	W-Bch-42308	W-Bch-241107
Reference link to non-existing reference	1547	W-Bch-42308	W-Bch-241143
Reference link to non-existing reference	1548	W-Bch-42308	W-Bch-241150
Reference link to non-existing reference	1549	W-Bch-42308	W-Bch-241173
Reference link to non-existing reference	1550	W-Bch-42308	W-Bch-241207
Reference link to non-existing reference	1551	W-Bch-42308	W-Bch-241209
Reference link to non-existing reference	1659	W-Bch-42308	W-Bch-241021
Reference link to non-existing reference	1660	W-Bch-42308	W-Bch-241038
Reference link to non-existing reference	1661	W-Bch-42308	W-Bch-241072
Reference link to non-existing reference	1662	W-Bch-42308	W-Bch-241085
Reference link to non-existing reference	1663	W-Bch-42308	W-Bch-241102
Reference link to non-existing reference	1664	W-Bch-42308	W-Bch-241119
Reference link to non-existing reference	1665	W-Bch-42308	W-Bch-241136
Reference link to non-existing reference	1666	W-Bch-42308	W-Bch-241153
Reference link to non-existing reference	1667	W-Bch-42308	W-Bch-241187
Reference link to non-existing reference	1781	W-Bch-42308	W-Bch-241039
Reference link to non-existing reference	1782	W-Bch-42308	W-Bch-241041
Reference link to non-existing reference	1783	W-Bch-42308	W-Bch-241075
Reference link to non-existing reference	1785	W-Bch-42308	W-Bch-241082
Reference link to non-existing reference	1786	W-Bch-42308	W-Bch-241084
Reference link to non-existing reference	1787	W-Bch-42308	W-Bch-241118
Reference link to non-existing reference	1788	W-Bch-42308	W-Bch-241141
Reference link to non-existing reference	1789	W-Bch-42308	W-Bch-241148
Reference link to non-existing reference	1790	W-Bch-42308	W-Bch-241182
Reference link to non-existing reference	1791	W-Bch-42308	W-Bch-241184
Reference link to non-existing reference	1885	W-Bch-42308	W-Bch-241025
Reference link to non-existing reference	1886	W-Bch-42308	W-Bch-241034
Reference link to non-existing reference	1887	W-Bch-42308	W-Bch-241059
Reference link to non-existing reference	1888	W-Bch-42308	W-Bch-241064
Reference link to non-existing reference	1889	W-Bch-42308	W-Bch-241068
Reference link to non-existing reference	1890	W-Bch-42308	W-Bch-241089
Reference link to non-existing reference	1891	W-Bch-42308	W-Bch-241098
Reference link to non-existing reference	1892	W-Bch-42308	W-Bch-241123
Reference link to non-existing reference	1893	W-Bch-42308	W-Bch-241132
Reference link to non-existing reference	1894	W-Bch-42308	W-Bch-241157
Reference link to non-existing reference	1895	W-Bch-42308	W-Bch-241191
Reference link to non-existing reference	2011	W-Bch-42308	W-Bch-241037
Reference link to non-existing reference	2012	W-Bch-42308	W-Bch-241052
Reference link to non-existing reference	2013	W-Bch-42308	W-Bch-241071
Reference link to non-existing reference	2014	W-Bch-42308	W-Bch-241086
Reference link to non-existing reference	2015	W-Bch-42308	W-Bch-241122
Reference link to non-existing reference	2016	W-Bch-42308	W-Bch-241135
Reference link to non-existing reference	2017	W-Bch-42308	W-Bch-241152
Reference link to non-existing reference	2018	W-Bch-42308	W-Bch-241186
Reference link to non-existing reference	2019	W-Bch-42308	W-Bch-241188
Reference link to non-existing reference	2122	W-Bch-1169	W-Bch-225829
Reference link to non-existing reference	2126	W-Bch-42308	W-Bch-241029
Reference link to non-existing reference	2127	W-Bch-42308	W-Bch-241030
Reference link to non-existing reference	2128	W-Bch-42308	W-Bch-241044
Reference link to non-existing reference	2129	W-Bch-42308	W-Bch-241079
Reference link to non-existing reference	2130	W-Bch-42308	W-Bch-241080
Reference link to non-existing reference	2131	W-Bch-42308	W-Bch-241129
Reference link to non-existing reference	2132	W-Bch-42308	W-Bch-241179
Reference link to non-existing reference	2133	W-Bch-42308	W-Bch-241180
Reference link to non-existing reference	2134	W-Bch-42308	W-Bch-241194
Reference link to non-existing reference	2235	W-Bch-42308	W-Bch-241031
Reference link to non-existing reference	2236	W-Bch-42308	W-Bch-241049
Reference link to non-existing reference	2237	W-Bch-42308	W-Bch-241099
Reference link to non-existing reference	2238	W-Bch-42308	W-Bch-241117
Reference link to non-existing reference	2239	W-Bch-42308	W-Bch-241156
Reference link to non-existing reference	2241	W-Bch-42308	W-Bch-241167
Reference link to non-existing reference	2242	W-Bch-42308	W-Bch-241181
Reference link to non-existing reference	2243	W-Bch-42308	W-Bch-241206
Reference link to non-existing reference	2244	W-Bch-42308	W-Bch-241210
Reference link to non-existing reference	2347	W-Bch-42308	W-Bch-241023
Reference link to non-existing reference	2348	W-Bch-42308	W-Bch-241057
Reference link to non-existing reference	2349	W-Bch-42308	W-Bch-241066
Reference link to non-existing reference	2350	W-Bch-42308	W-Bch-241091
Reference link to non-existing reference	2351	W-Bch-42308	W-Bch-241100
Reference link to non-existing reference	2352	W-Bch-42308	W-Bch-241134
Reference link to non-existing reference	2353	W-Bch-42308	W-Bch-241168
Reference link to non-existing reference	2354	W-Bch-42308	W-Bch-241193
Reference link to non-existing reference	2355	W-Bch-42308	W-Bch-241198
Reference link to non-existing reference	2363	W-Bch-42	W-Bch-394939
Reference link to non-existing reference	2400	W-Bch-170679	W-Bch-557708
--------------
SELECT 'Specialist not present in scientific names table', record_id, specialist_name, specialist_code FROM specialists
WHERE specialist_code NOT IN(SELECT DISTINCT specialist_code FROM scientific_names)
--------------

--------------
SELECT 'Reference without parent accepted or common name', record_id, author, year, title, reference_code FROM `references`
WHERE reference_code NOT IN(SELECT DISTINCT reference_code FROM scientific_name_references 
UNION SELECT DISTINCT reference_code FROM common_names)
--------------

Reference without parent accepted or common name	record_id	author	year	title	reference_code
Reference without parent accepted or common name	5	Adema, J.P.H.M.	1991	NULL	W-Bch-52
Reference without parent accepted or common name	6	Cattrijsse, A.; Vincx, M.	2001	NULL	W-Bch-61
Reference without parent accepted or common name	8	Hayward, P.J.; Nelson-Smith, A.; Shields, C.	1996	NULL	W-Bch-614
Reference without parent accepted or common name	10	Howson, C.M.; Picton, B.E. (Ed.)	1997	NULL	W-Bch-663
Reference without parent accepted or common name	23	Brunel, P., Bosse, L. & Lamarche, G.	1998	NULL	W-Bch-2930
Reference without parent accepted or common name	24	Maine Department of Marine Resources.	2003	NULL	W-Bch-3005
Reference without parent accepted or common name	25	Meinkoth, N.A.	1981	NULL	W-Bch-3017
Reference without parent accepted or common name	26	Pohle, G.W.	1990	NULL	W-Bch-3038
Reference without parent accepted or common name	27	Pollock, L.W.	1998	NULL	W-Bch-3042
Reference without parent accepted or common name	28	Squires, W.A.	1976	NULL	W-Bch-3065
Reference without parent accepted or common name	29	Trott, T.J.	2004	NULL	W-Bch-3072
Reference without parent accepted or common name	30	Wigley, R. L.; Messersmith, J. L.	1976	NULL	W-Bch-3091
Reference without parent accepted or common name	31	Williams, A.B.	1984	NULL	W-Bch-3093
Reference without parent accepted or common name	33	Risso, A.	1816	NULL	W-Bch-5645
Reference without parent accepted or common name	71	Wolff, W.J.; Duiven, P.; Esselink, P.; Gueve, A.	1993	NULL	W-Bch-8619
Reference without parent accepted or common name	78	Species	2000	NULL	W-Bch-9779
Reference without parent accepted or common name	85	Forssk?l, P.; Niebuhr, C.	1775	NULL	W-Bch-21228
Reference without parent accepted or common name	97	Prez Farfante, I. & B. Kensley,	1997	NULL	W-Bch-47741
Reference without parent accepted or common name	100	GOULD, A.A.	1841	NULL	W-Bch-61264
Reference without parent accepted or common name	104	Leach, W.E.	1813, 1814	NULL	W-Bch-99148
Reference without parent accepted or common name	105	Leach, W.E.	1816	NULL	W-Bch-99150
Reference without parent accepted or common name	110	De Haan, W.,	1833	NULL	W-Bch-125841
Reference without parent accepted or common name	113	Ahyong & Brown.	2003	NULL	W-Bch-127954
Reference without parent accepted or common name	115	Ahyong, Chen & Ng.	2005	NULL	W-Bch-127960
Reference without parent accepted or common name	116	Asakura & Watanabe.	2005	NULL	W-Bch-128021
Reference without parent accepted or common name	122	Chen & Ng.	2003	NULL	W-Bch-128270
Reference without parent accepted or common name	124	Clark & Ng.	2006	NULL	W-Bch-128293
Reference without parent accepted or common name	125	Crosnier & Moosa.	2002	NULL	W-Bch-128334
Reference without parent accepted or common name	128	Davie.	2003	NULL	W-Bch-128348
Reference without parent accepted or common name	131	Galil.	2004	NULL	W-Bch-128470
Reference without parent accepted or common name	132	Galil.	2006	NULL	W-Bch-128472
Reference without parent accepted or common name	135	Komatsu & Takeda.	2005	NULL	W-Bch-128766
Reference without parent accepted or common name	138	Lai, Chan & Ng.	2006	NULL	W-Bch-128808
Reference without parent accepted or common name	139	Nagai, Watanabe & Naruse.	2006	NULL	W-Bch-129049
Reference without parent accepted or common name	143	Ng & Ho.	2003	NULL	W-Bch-129079
Reference without parent accepted or common name	144	Ng & Ho.	2003	NULL	W-Bch-129080
Reference without parent accepted or common name	147	Ng & Mclay.	2005	NULL	W-Bch-129084
Reference without parent accepted or common name	149	Ng.	2002	NULL	W-Bch-129086
Reference without parent accepted or common name	151	Ng.	2002	NULL	W-Bch-129089
Reference without parent accepted or common name	152	Osawa & Ng.	2006	NULL	W-Bch-129154
Reference without parent accepted or common name	155	Rahayu	1915	NULL	W-Bch-129248
Reference without parent accepted or common name	156	Rahayu & Ng.	2003	NULL	W-Bch-129249
Reference without parent accepted or common name	158	Sawada, T.; Sakai, K.; Hosogi, M.	2005	NULL	W-Bch-129368
Reference without parent accepted or common name	159	Schubart & Ng.	2002	NULL	W-Bch-129375
Reference without parent accepted or common name	160	Takeda & Galil.	2005	NULL	W-Bch-129494
Reference without parent accepted or common name	161	Takeda & Komatsu.	2005	NULL	W-Bch-129495
Reference without parent accepted or common name	162	Tavares.	2006	NULL	W-Bch-129499
Reference without parent accepted or common name	163	Webber, R.; Takeda, M.	2005	NULL	W-Bch-129616
Reference without parent accepted or common name	164	Yang & Tang.	2006	NULL	W-Bch-129653
Reference without parent accepted or common name	167	Crosnier Alain / Moosa Mohammad Kasim.	2002	NULL	W-Bch-129700
Reference without parent accepted or common name	169	Fabricius, J. C. O.; Genera, S.; Adjectis, S.; Locis, D.; Observationibus	1775	NULL	W-Bch-130132
Reference without parent accepted or common name	172	Crosnier.	2003	NULL	W-Bch-130659
Reference without parent accepted or common name	174	Guinot & Hurtado.	2003	NULL	W-Bch-130762
Reference without parent accepted or common name	176	Guinot,D; Hurtado,L.A. & Vrijenhoek,R.	2002	NULL	W-Bch-130764
Reference without parent accepted or common name	178	Huang, Hsueh & Nq.	2002	NULL	W-Bch-130815
Reference without parent accepted or common name	179	Kazmi & Manning.	2003	NULL	W-Bch-130896
Reference without parent accepted or common name	182	Mclay & Ng.	2005	NULL	W-Bch-131030
Reference without parent accepted or common name	184	Naruse, Shokita & Kawahara.	2005	NULL	W-Bch-131058
Reference without parent accepted or common name	185	Ng & Chen.	2004	NULL	W-Bch-131060
Reference without parent accepted or common name	187	Ng, P. K. L.; Liu, H.-C.	2003	NULL	W-Bch-131063
Reference without parent accepted or common name	191	Ng, P.K.L. and M. Takeda	2003	NULL	W-Bch-131067
Reference without parent accepted or common name	192	Ng.	2002	NULL	W-Bch-131068
Reference without parent accepted or common name	193	Ng.	2002	NULL	W-Bch-131069
Reference without parent accepted or common name	195	Ng.	2002	NULL	W-Bch-131073
Reference without parent accepted or common name	196	Ng.	2002	NULL	W-Bch-131074
Reference without parent accepted or common name	199	Takeda & Manuel.	2003	NULL	W-Bch-131223
Reference without parent accepted or common name	200	Takeda & Watabe.	2004	NULL	W-Bch-131225
Reference without parent accepted or common name	201	Takeda, M.	2003	NULL	W-Bch-131226
Reference without parent accepted or common name	204	Kerckhof, F.	1987	NULL	W-Bch-140199
Reference without parent accepted or common name	206	McLay, C. L.	2009	NULL	W-Bch-141297
Reference without parent accepted or common name	215	Ngoc-Ho, N.	2009	NULL	W-Bch-144567
Reference without parent accepted or common name	231	Herbst, J.	1794	NULL	W-Bch-163168
Reference without parent accepted or common name	232	Rathbun, M. J.	1986	NULL	W-Bch-163261
Reference without parent accepted or common name	233	Balss, H.	1922	NULL	W-Bch-163276
Reference without parent accepted or common name	234	Bull, M. H. N.	1964	NULL	W-Bch-163775
Reference without parent accepted or common name	235	Forest, J.	1978	NULL	W-Bch-163789
Reference without parent accepted or common name	306	Campos, E.; Wicksten, M. K.	1997	NULL	W-Bch-171523
Reference without parent accepted or common name	372	Verrill, AE.	1908	NULL	W-Bch-175547
Reference without parent accepted or common name	374	Gothland, M.	2013	NULL	W-Bch-175738
Reference without parent accepted or common name	375	Shaw, JK.; Hopkins, TS.	1977	NULL	W-Bch-176211
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
CREATE TEMPORARY TABLE duplicates_to_delete AS SELECT "Accepted name to be deleted", sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author FROM (SELECT genus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt FROM scientific_names GROUP BY genus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) dups LEFT JOIN scientific_names sn ON sn.genus = dups.genus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1
AND sn.name_code NOT IN (SELECT dups3.namecodes_to_keep FROM
(SELECT MAX(name_code) AS namecodes_to_keep, genus, species, infraspecies_marker, infraspecies, author FROM
(SELECT sn.name_code AS name_code, sn.sp2000_status_id AS sp2000_status_id, dups.genus AS genus, dups.species AS species, dups.infraspecies_marker AS infraspecies_marker, dups.infraspecies AS infraspecies, dups.author AS author FROM (SELECT genus, species, infraspecies_marker, infraspecies, author, sp2000_status_id, count(*) as cnt
FROM scientific_names
GROUP BY genus, species, infraspecies, infraspecies_marker, author, sp2000_status_id HAVING cnt > 1) dups
LEFT JOIN scientific_names sn
ON sn.genus = dups.genus AND sn.species = dups.species AND sn.author = dups.author WHERE sn.sp2000_status_id = 1) AS dups2 GROUP BY genus, species, infraspecies_marker, infraspecies, author) AS dups3)
--------------

--------------
DELETE QUICK FROM scientific_names USING scientific_names INNER JOIN duplicates_to_delete ON scientific_names.name_code = duplicates_to_delete.name_code
--------------

--------------
DELETE FROM common_names WHERE name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names)
--------------

--------------
DELETE QUICK FROM scientific_names WHERE is_accepted_name != 1 AND accepted_name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names_tmp)
--------------

--------------
DELETE QUICK FROM scientific_names WHERE infraspecies_parent_name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names_tmp)
--------------

--------------
DELETE QUICK FROM lifezone WHERE name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names)
--------------

--------------
OPTIMIZE TABLE lifezone
--------------

Table	Op	Msg_type	Msg_text
Assembly_Brachyura.lifezone	optimize	status	OK
--------------
DELETE QUICK FROM distribution WHERE name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names)
--------------

--------------
OPTIMIZE TABLE distribution
--------------

Table	Op	Msg_type	Msg_text
Assembly_Brachyura.distribution	optimize	status	OK
--------------
DELETE QUICK FROM scientific_names WHERE family_code NOT IN(SELECT DISTINCT family_code FROM families)
--------------

--------------
OPTIMIZE TABLE scientific_names
--------------

Table	Op	Msg_type	Msg_text
Assembly_Brachyura.scientific_names	optimize	status	OK
--------------
DELETE QUICK FROM scientific_name_references WHERE name_code NOT IN(SELECT DISTINCT name_code FROM scientific_names)
--------------

--------------
DELETE QUICK FROM scientific_name_references WHERE reference_code NOT IN(SELECT DISTINCT reference_code FROM `references`)
--------------

--------------
OPTIMIZE TABLE scientific_name_references
--------------

Table	Op	Msg_type	Msg_text
Assembly_Brachyura.scientific_name_references	optimize	status	OK
--------------
DELETE FROM specialists WHERE specialist_code NOT IN(SELECT DISTINCT specialist_code FROM scientific_names)
--------------

--------------
DELETE QUICK FROM `references` WHERE reference_code NOT IN(SELECT DISTINCT reference_code FROM scientific_name_references 
UNION SELECT DISTINCT reference_code FROM common_names)
--------------

--------------
OPTIMIZE TABLE `references`
--------------

Table	Op	Msg_type	Msg_text
Assembly_Brachyura.references	optimize	status	OK
--------------
DROP TRIGGER IF EXISTS delfamcascade
--------------

--------------
DROP TRIGGER IF EXISTS delspcascade
--------------

--------------
DROP TRIGGER IF EXISTS delrefscascade
--------------

--------------
CREATE TRIGGER delfamcascade AFTER DELETE ON `families`
FOR EACH ROW 
BEGIN

DELETE FROM `scientific_names` WHERE family_code = old.family_code;

END;

CREATE TRIGGER delspcascade AFTER DELETE ON `scientific_names`
FOR EACH ROW 
BEGIN

DELETE FROM `common_names` WHERE name_code = old.name_code;
DELETE FROM `distribution` WHERE name_code = old.name_code;
DELETE FROM `lifezone` WHERE name_code = old.name_code;
DELETE FROM `scientific_name_references` WHERE name_code = old.name_code;
DELETE FROM `common_names` WHERE name_code = old.name_code;

END;

CREATE TRIGGER delrefscascade AFTER DELETE ON `scientific_name_references`
FOR EACH ROW 
BEGIN

DELETE FROM `references` WHERE reference_code = old.reference_code;

END;
--------------

\n\n\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n
</pre>
<pre>
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n\n
\nEditorial and Integrity checks Completed.
</pre>
</pre><hr><b>Replacing sectors in Assembly Global database</b>\n<pre>
<pre>
Starting Sector Management
--------------
SET @dbid = 108
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
DELETE FROM ",
@dbtouse,
".`databases` WHERE `record_id` = @dbid")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @dbtouse = 'Assembly_Global'
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`families` SELECT 
NULL AS `record_id`,
`hierarchy_code`,	
`kingdom`,	
`phylum`,	
`class`,	
`order`,	
`family`,	
`superfamily`, 	
`database_id`, 	
`family_code`,
`is_accepted_name`
FROM  `families`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`databases` SELECT 
`database_name_displayed`, 
`record_id`, 
`database_name`, 
`database_full_name`, 
`web_site`, 
`organization`, 
`contact_person`, 
`taxa`, 
`taxonomic_coverage`, 
`abstract`, 
`version`, 
`release_date`, 
`SpeciesCount`, 
`SpeciesEst`, 
`authors_editors`, 
`accepted_species_names`, 
`accepted_infraspecies_names`, 
`species_synonyms`, 
`infraspecies_synonyms`, 
`common_names`, 
`total_names`, 
`is_new`,
`coverage`,
`completeness`,
`confidence`
FROM `databases`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_names` 
(`record_id`, `name_code`, `web_site`, `genus`, `subgenus`, `species`, `infraspecies_parent_name_code`, `infraspecies`, `infraspecies_marker`, `author`, `accepted_name_code`, `comment`, `scrutiny_date`, `sp2000_status_id`, `database_id`, `specialist_id`, `family_id`, `specialist_code`, `family_code`, `is_accepted_name`, `GSDTaxonGUID`, `GSDNameGUID`) SELECT 
NULL AS `record_id`, 
`name_code`, 
`web_site`, 
`genus`, 
`subgenus`, 
`species`, 
`infraspecies_parent_name_code`, 
`infraspecies`, 
`infraspecies_marker`, 
`author`, 
`accepted_name_code`, 
`comment`, 
`scrutiny_date`, 
`sp2000_status_id`, 
`database_id`, 
`specialist_id`, 
`family_id`, 
`specialist_code`, 
`family_code`, 
`is_accepted_name`, 
`GSDTaxonGUID`, 
`GSDNameGUID`
FROM `scientific_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`common_names` SELECT 
NULL AS `record_id`, 
`name_code`, 
`common_name`, 
`transliteration`, 
`language`, 
`country`, 
`area`, 
NULL AS `reference_id`, 
`database_id`, 
`is_infraspecies`, 
`reference_code`
FROM  `common_names`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`distribution` SELECT 
NULL AS `record_id`, 
`name_code`, 
`distribution`, 
`StandardInUse`, 
`DistributionStatus`,
`database_id`
FROM  `distribution`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`lifezone` SELECT 
NULL AS `record_id`,
`name_code`, 	
`lifezone`,
`database_id`
FROM  `lifezone`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`scientific_name_references` SELECT 
NULL AS `record_id`,
`name_code`,	
`reference_type`, 	
NULL AS `reference_id`,	
`reference_code`,
`database_id`
FROM  `scientific_name_references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`references` SELECT 
NULL AS `record_id`, 
`author`, 
`year`, 
`title`, 
`source`, 
`database_id`, 
`reference_code`
FROM  `references`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

--------------
SET @query = CONCAT("
INSERT INTO ", @dbtouse, ".`specialists` SELECT 
NULL AS `record_id`,
`specialist_name`,
`specialist_code`,
`database_id`
FROM  `specialists`")
--------------

--------------
PREPARE stmt FROM @query
--------------

--------------
EXECUTE stmt
--------------

--------------
DEALLOCATE PREPARE stmt
--------------

\n\n\n!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n
!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n\n\n
\nTransformations Completed.
<pre>
</pre><hr><b>Chain completed</b>
</body></html>
